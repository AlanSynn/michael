/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";let e={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function t(t){e=t}const n={exec:()=>null};function r(e,t=""){let n="string"==typeof e?e:e.source;const r={replace:(e,t)=>{let s="string"==typeof t?t:t.source;return s=s.replace(a.caret,"$1"),n=n.replace(e,s),r},getRegex:()=>new RegExp(n,t)};return r}const a={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},s=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,o=/(?:[*+-]|\d{1,9}[.)])/,i=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,l=r(i).replace(/bull/g,o).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),c=r(i).replace(/bull/g,o).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),u=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,d=/(?!\s*\])(?:\\.|[^\[\]\\])+/,p=r(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",d).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),h=r(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,o).getRegex(),m="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",g=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,f=r("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",g).replace("tag",m).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),y=r(u).replace("hr",s).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",m).getRegex(),k={blockquote:r(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",y).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:p,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:s,html:f,lheading:l,list:h,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:y,table:n,text:/^[^\n]+/},b=r("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",s).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",m).getRegex(),x={...k,lheading:c,table:b,paragraph:r(u).replace("hr",s).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",b).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",m).getRegex()},v={...k,html:r("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",g).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:n,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:r(u).replace("hr",s).replace("heading"," *#{1,6} *[^\n]").replace("lheading",l).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},w=/^( {2,}|\\)\n(?!\s*$)/,E=/[\p{P}\p{S}]/u,S=/[\s\p{P}\p{S}]/u,I=/[^\s\p{P}\p{S}]/u,B=r(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,S).getRegex(),T=/(?!~)[\p{P}\p{S}]/u,_=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,L=r(_,"u").replace(/punct/g,E).getRegex(),z=r(_,"u").replace(/punct/g,T).getRegex(),A="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",R=r(A,"gu").replace(/notPunctSpace/g,I).replace(/punctSpace/g,S).replace(/punct/g,E).getRegex(),O=r(A,"gu").replace(/notPunctSpace/g,/(?:[^\s\p{P}\p{S}]|~)/u).replace(/punctSpace/g,/(?!~)[\s\p{P}\p{S}]/u).replace(/punct/g,T).getRegex(),$=r("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,I).replace(/punctSpace/g,S).replace(/punct/g,E).getRegex(),C=r(/\\(punct)/,"gu").replace(/punct/g,E).getRegex(),P=r(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),N=r(g).replace("(?:--\x3e|$)","--\x3e").getRegex(),M=r("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",N).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),j=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,H=r(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",j).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),D=r(/^!?\[(label)\]\[(ref)\]/).replace("label",j).replace("ref",d).getRegex(),q=r(/^!?\[(ref)\](?:\[\])?/).replace("ref",d).getRegex(),Y={_backpedal:n,anyPunctuation:C,autolink:P,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:w,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:n,emStrongLDelim:L,emStrongRDelimAst:R,emStrongRDelimUnd:$,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:H,nolink:q,punctuation:B,reflink:D,reflinkSearch:r("reflink|nolink(?!\\()","g").replace("reflink",D).replace("nolink",q).getRegex(),tag:M,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:n},J={...Y,link:r(/^!?\[(label)\]\((.*?)\)/).replace("label",j).getRegex(),reflink:r(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",j).getRegex()},F={...Y,emStrongRDelimAst:O,emStrongLDelim:z,url:r(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},G={...F,br:r(w).replace("{2,}","*").getRegex(),text:r(F.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Z={normal:k,gfm:x,pedantic:v},K={normal:Y,gfm:F,breaks:G,pedantic:J},U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Q=e=>U[e];function X(e,t){if(t){if(a.escapeTest.test(e))return e.replace(a.escapeReplace,Q)}else if(a.escapeTestNoEncode.test(e))return e.replace(a.escapeReplaceNoEncode,Q);return e}function W(e){try{e=encodeURI(e).replace(a.percentDecode,"%")}catch{return null}return e}function V(e,t){const n=e.replace(a.findPipe,((e,t,n)=>{let r=!1,a=t;for(;--a>=0&&"\\"===n[a];)r=!r;return r?"|":" |"})).split(a.splitPipe);let r=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(a.slashPipe,"|");return n}function ee(e,t,n){const r=e.length;if(0===r)return"";let a=0;for(;a<r&&e.charAt(r-a-1)===t;)a++;return e.slice(0,r-a)}function te(e,t,n,r,a){const s=t.href,o=t.title||null,i=e[1].replace(a.other.outputLinkReplace,"$1");if("!"!==e[0].charAt(0)){r.state.inLink=!0;const e={type:"link",raw:n,href:s,title:o,text:i,tokens:r.inlineTokens(i)};return r.state.inLink=!1,e}return{type:"image",raw:n,href:s,title:o,text:i}}class ne{options;rules;lexer;constructor(t){this.options=t||e}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:ee(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],n=function(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(null===r)return t;const a=r[1];return t.split("\n").map((e=>{const t=e.match(n.other.beginningSpace);if(null===t)return e;const[r]=t;return r.length>=a.length?e.slice(a.length):e})).join("\n")}(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){const t=ee(e,"#");this.options.pedantic?e=t.trim():t&&!this.rules.other.endingSpaceChar.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:ee(t[0],"\n")}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let e=ee(t[0],"\n").split("\n"),n="",r="";const a=[];for(;e.length>0;){let t=!1;const s=[];let o;for(o=0;o<e.length;o++)if(this.rules.other.blockquoteStart.test(e[o]))s.push(e[o]),t=!0;else{if(t)break;s.push(e[o])}e=e.slice(o);const i=s.join("\n"),l=i.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}\n${i}`:i,r=r?`${r}\n${l}`:l;const c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(l,a,!0),this.lexer.state.top=c,0===e.length)break;const u=a.at(-1);if("code"===u?.type)break;if("blockquote"===u?.type){const t=u,s=t.raw+"\n"+e.join("\n"),o=this.blockquote(s);a[a.length-1]=o,n=n.substring(0,n.length-t.raw.length)+o.raw,r=r.substring(0,r.length-t.text.length)+o.text;break}if("list"!==u?.type);else{const t=u,s=t.raw+"\n"+e.join("\n"),o=this.list(s);a[a.length-1]=o,n=n.substring(0,n.length-u.raw.length)+o.raw,r=r.substring(0,r.length-t.raw.length)+o.raw,e=s.substring(a.at(-1).raw.length).split("\n")}}return{type:"blockquote",raw:n,tokens:a,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,a={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const s=this.rules.other.listItemRegex(n);let o=!1;for(;e;){let n=!1,r="",i="";if(!(t=s.exec(e)))break;if(this.rules.block.hr.test(e))break;r=t[0],e=e.substring(r.length);let l=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,(e=>" ".repeat(3*e.length))),c=e.split("\n",1)[0],u=!l.trim(),d=0;if(this.options.pedantic?(d=2,i=l.trimStart()):u?d=t[1].length+1:(d=t[2].search(this.rules.other.nonSpaceChar),d=d>4?1:d,i=l.slice(d),d+=t[1].length),u&&this.rules.other.blankLine.test(c)&&(r+=c+"\n",e=e.substring(c.length+1),n=!0),!n){const t=this.rules.other.nextBulletRegex(d),n=this.rules.other.hrRegex(d),a=this.rules.other.fencesBeginRegex(d),s=this.rules.other.headingBeginRegex(d),o=this.rules.other.htmlBeginRegex(d);for(;e;){const p=e.split("\n",1)[0];let h;if(c=p,this.options.pedantic?(c=c.replace(this.rules.other.listReplaceNesting,"  "),h=c):h=c.replace(this.rules.other.tabCharGlobal,"    "),a.test(c))break;if(s.test(c))break;if(o.test(c))break;if(t.test(c))break;if(n.test(c))break;if(h.search(this.rules.other.nonSpaceChar)>=d||!c.trim())i+="\n"+h.slice(d);else{if(u)break;if(l.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4)break;if(a.test(l))break;if(s.test(l))break;if(n.test(l))break;i+="\n"+c}u||c.trim()||(u=!0),r+=p+"\n",e=e.substring(p.length+1),l=h.slice(d)}}a.loose||(o?a.loose=!0:this.rules.other.doubleBlankLine.test(r)&&(o=!0));let p,h=null;this.options.gfm&&(h=this.rules.other.listIsTask.exec(i),h&&(p="[ ] "!==h[0],i=i.replace(this.rules.other.listReplaceTask,""))),a.items.push({type:"list_item",raw:r,task:!!h,checked:p,loose:!1,text:i,tokens:[]}),a.raw+=r}const i=a.items.at(-1);if(!i)return;i.raw=i.raw.trimEnd(),i.text=i.text.trimEnd(),a.raw=a.raw.trimEnd();for(let e=0;e<a.items.length;e++)if(this.lexer.state.top=!1,a.items[e].tokens=this.lexer.blockTokens(a.items[e].text,[]),!a.loose){const t=a.items[e].tokens.filter((e=>"space"===e.type)),n=t.length>0&&t.some((e=>this.rules.other.anyLine.test(e.raw)));a.loose=n}if(a.loose)for(let e=0;e<a.items.length;e++)a.items[e].loose=!0;return a}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(!t)return;if(!this.rules.other.tableDelimiter.test(t[2]))return;const n=V(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),a=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const e of r)this.rules.other.tableAlignRight.test(e)?s.align.push("right"):this.rules.other.tableAlignCenter.test(e)?s.align.push("center"):this.rules.other.tableAlignLeft.test(e)?s.align.push("left"):s.align.push(null);for(let e=0;e<n.length;e++)s.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:s.align[e]});for(const e of a)s.rows.push(V(e,s.header.length).map(((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:s.align[t]}))));return s}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;const t=ee(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let n=0;for(let r=0;r<e.length;r++)if("\\"===e[r])r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return-1}(t[2],"()");if(e>-1){const n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){const e=this.rules.other.pedanticHrefTitle.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(n=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?n.slice(1):n.slice(1,-1)),te(t,{href:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n,title:r?r.replace(this.rules.inline.anyPunctuation,"$1"):r},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const e=t[(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!e){const e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return te(n,e,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(r&&(!r[3]||!n.match(this.rules.other.unicodeAlphaNumeric))&&(!r[1]&&!r[2]||!n||this.rules.inline.punctuation.exec(n))){const n=[...r[0]].length-1;let a,s,o=n,i=0;const l="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+n);null!=(r=l.exec(t));){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(s=[...a].length,r[3]||r[4]){o+=s;continue}if((r[5]||r[6])&&n%3&&!((n+s)%3)){i+=s;continue}if(o-=s,o>0)continue;s=Math.min(s,s+o+i);const t=[...r[0]][0].length,l=e.slice(0,n+r.index+t+s);if(Math.min(n,s)%2){const e=l.slice(1,-1);return{type:"em",raw:l,text:e,tokens:this.lexer.inlineTokens(e)}}const c=l.slice(2,-2);return{type:"strong",raw:l,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," ");const n=this.rules.other.nonSpaceChar.test(e),r=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return n&&r&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let e,n;return"@"===t[2]?(e=t[1],n="mailto:"+e):(e=t[1],n=e),{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,n;if("@"===t[2])e=t[0],n="mailto:"+e;else{let r;do{r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(r!==t[0]);e=t[0],n="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}}class re{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||e,this.options.tokenizer=this.options.tokenizer||new ne,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:a,block:Z.normal,inline:K.normal};this.options.pedantic?(n.block=Z.pedantic,n.inline=K.pedantic):this.options.gfm&&(n.block=Z.gfm,this.options.breaks?n.inline=K.breaks:n.inline=K.gfm),this.tokenizer.rules=n}static get rules(){return{block:Z,inline:K}}static lex(e,t){return new re(t).lex(e)}static lexInline(e,t){return new re(t).inlineTokens(e)}lex(e){e=e.replace(a.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){for(this.options.pedantic&&(e=e.replace(a.tabCharGlobal,"    ").replace(a.spaceLine,""));e;){let r;if(this.options.extensions?.block?.some((n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))continue;if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length);const n=t.at(-1);1===r.raw.length&&void 0!==n?n.raw+="\n":t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length);const n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue.at(-1).src=n.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length);const n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.raw,this.inlineQueue.at(-1).src=n.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}let a=e;if(this.options.extensions?.startBlock){let t=1/0;const n=e.slice(1);let r;this.options.extensions.startBlock.forEach((e=>{r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(a=e.substring(0,t+1))}if(this.state.top&&(r=this.tokenizer.paragraph(a))){const s=t.at(-1);n&&"paragraph"===s?.type?(s.raw+="\n"+r.raw,s.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):t.push(r),n=a.length!==e.length,e=e.substring(r.raw.length)}else if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length);const n=t.at(-1);"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=n.text):t.push(r)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n=e,r=null;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(r=this.tokenizer.rules.inline.reflinkSearch.exec(n));)e.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(r=this.tokenizer.rules.inline.blockSkip.exec(n));)n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(r=this.tokenizer.rules.inline.anyPunctuation.exec(n));)n=n.slice(0,r.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let a=!1,s="";for(;e;){let r;if(a||(s=""),a=!1,this.options.extensions?.inline?.some((n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))continue;if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length);const n=t.at(-1);"text"===r.type&&"text"===n?.type?(n.raw+=r.raw,n.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,n,s)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}let o=e;if(this.options.extensions?.startInline){let t=1/0;const n=e.slice(1);let r;this.options.extensions.startInline.forEach((e=>{r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(o=e.substring(0,t+1))}if(r=this.tokenizer.inlineText(o)){e=e.substring(r.raw.length),"_"!==r.raw.slice(-1)&&(s=r.raw.slice(-1)),a=!0;const n=t.at(-1);"text"===n?.type?(n.raw+=r.raw,n.text+=r.text):t.push(r)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return t}}class ae{options;parser;constructor(t){this.options=t||e}space(e){return""}code({text:e,lang:t,escaped:n}){const r=(t||"").match(a.notSpaceStart)?.[0],s=e.replace(a.endingNewline,"")+"\n";return r?'<pre><code class="language-'+X(r)+'">'+(n?s:X(s,!0))+"</code></pre>\n":"<pre><code>"+(n?s:X(s,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){const t=e.ordered,n=e.start;let r="";for(let t=0;t<e.items.length;t++){const n=e.items[t];r+=this.listitem(n)}const a=t?"ol":"ul";return"<"+a+(t&&1!==n?' start="'+n+'"':"")+">\n"+r+"</"+a+">\n"}listitem(e){let t="";if(e.task){const n=this.checkbox({checked:!!e.checked});e.loose?"paragraph"===e.tokens[0]?.type?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=n+" "+X(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",n="";for(let t=0;t<e.header.length;t++)n+=this.tablecell(e.header[t]);t+=this.tablerow({text:n});let r="";for(let t=0;t<e.rows.length;t++){const a=e.rows[t];n="";for(let e=0;e<a.length;e++)n+=this.tablecell(a[e]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+r+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${X(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),a=W(e);if(null===a)return r;let s='<a href="'+(e=a)+'"';return t&&(s+=' title="'+X(t)+'"'),s+=">"+r+"</a>",s}image({href:e,title:t,text:n}){const r=W(e);if(null===r)return X(n);let a=`<img src="${e=r}" alt="${n}"`;return t&&(a+=` title="${X(t)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:X(e.text)}}class se{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class oe{options;renderer;textRenderer;constructor(t){this.options=t||e,this.options.renderer=this.options.renderer||new ae,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new se}static parse(e,t){return new oe(t).parse(e)}static parseInline(e,t){return new oe(t).parseInline(e)}parse(e,t=!0){let n="";for(let r=0;r<e.length;r++){const a=e[r];if(this.options.extensions?.renderers?.[a.type]){const e=a,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){n+=t||"";continue}}const s=a;switch(s.type){case"space":n+=this.renderer.space(s);continue;case"hr":n+=this.renderer.hr(s);continue;case"heading":n+=this.renderer.heading(s);continue;case"code":n+=this.renderer.code(s);continue;case"table":n+=this.renderer.table(s);continue;case"blockquote":n+=this.renderer.blockquote(s);continue;case"list":n+=this.renderer.list(s);continue;case"html":n+=this.renderer.html(s);continue;case"paragraph":n+=this.renderer.paragraph(s);continue;case"text":{let a=s,o=this.renderer.text(a);for(;r+1<e.length&&"text"===e[r+1].type;)a=e[++r],o+="\n"+this.renderer.text(a);n+=t?this.renderer.paragraph({type:"paragraph",raw:o,text:o,tokens:[{type:"text",raw:o,text:o,escaped:!0}]}):o;continue}default:{const e='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}parseInline(e,t=this.renderer){let n="";for(let r=0;r<e.length;r++){const a=e[r];if(this.options.extensions?.renderers?.[a.type]){const e=this.options.extensions.renderers[a.type].call({parser:this},a);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){n+=e||"";continue}}const s=a;switch(s.type){case"escape":case"text":n+=t.text(s);break;case"html":n+=t.html(s);break;case"link":n+=t.link(s);break;case"image":n+=t.image(s);break;case"strong":n+=t.strong(s);break;case"em":n+=t.em(s);break;case"codespan":n+=t.codespan(s);break;case"br":n+=t.br(s);break;case"del":n+=t.del(s);break;default:{const e='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}}class ie{options;block;constructor(t){this.options=t||e}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?re.lex:re.lexInline}provideParser(){return this.block?oe.parse:oe.parseInline}}const le=new class{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=oe;Renderer=ae;TextRenderer=se;Lexer=re;Tokenizer=ne;Hooks=ie;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(const r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{const e=r;for(const r of e.header)n=n.concat(this.walkTokens(r.tokens,t));for(const r of e.rows)for(const e of r)n=n.concat(this.walkTokens(e.tokens,t));break}case"list":{const e=r;n=n.concat(this.walkTokens(e.items,t));break}default:{const e=r;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach((r=>{const a=e[r].flat(1/0);n=n.concat(this.walkTokens(a,t))})):e.tokens&&(n=n.concat(this.walkTokens(e.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach((e=>{const n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){const n=t.renderers[e.name];t.renderers[e.name]=n?function(...t){let r=e.renderer.apply(this,t);return!1===r&&(r=n.apply(this,t)),r}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");const n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)})),n.extensions=t),e.renderer){const t=this.defaults.renderer||new ae(this.defaults);for(const n in e.renderer){if(!(n in t))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;const r=n,a=e.renderer[r],s=t[r];t[r]=(...e)=>{let n=a.apply(t,e);return!1===n&&(n=s.apply(t,e)),n||""}}n.renderer=t}if(e.tokenizer){const t=this.defaults.tokenizer||new ne(this.defaults);for(const n in e.tokenizer){if(!(n in t))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;const r=n,a=e.tokenizer[r],s=t[r];t[r]=(...e)=>{let n=a.apply(t,e);return!1===n&&(n=s.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){const t=this.defaults.hooks||new ie;for(const n in e.hooks){if(!(n in t))throw new Error(`hook '${n}' does not exist`);if(["options","block"].includes(n))continue;const r=n,a=e.hooks[r],s=t[r];ie.passThroughHooks.has(n)?t[r]=e=>{if(this.defaults.async)return Promise.resolve(a.call(t,e)).then((e=>s.call(t,e)));const n=a.call(t,e);return s.call(t,n)}:t[r]=(...e)=>{let n=a.apply(t,e);return!1===n&&(n=s.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){const t=this.defaults.walkTokens,r=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(r.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}})),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return re.lex(e,t??this.defaults)}parser(e,t){return oe.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{const r={...n},a={...this.defaults,...r},s=this.onError(!!a.silent,!!a.async);if(!0===this.defaults.async&&!1===r.async)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(null==t)return s(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));a.hooks&&(a.hooks.options=a,a.hooks.block=e);const o=a.hooks?a.hooks.provideLexer():e?re.lex:re.lexInline,i=a.hooks?a.hooks.provideParser():e?oe.parse:oe.parseInline;if(a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(t):t).then((e=>o(e,a))).then((e=>a.hooks?a.hooks.processAllTokens(e):e)).then((e=>a.walkTokens?Promise.all(this.walkTokens(e,a.walkTokens)).then((()=>e)):e)).then((e=>i(e,a))).then((e=>a.hooks?a.hooks.postprocess(e):e)).catch(s);try{a.hooks&&(t=a.hooks.preprocess(t));let e=o(t,a);a.hooks&&(e=a.hooks.processAllTokens(e)),a.walkTokens&&this.walkTokens(e,a.walkTokens);let n=i(e,a);return a.hooks&&(n=a.hooks.postprocess(n)),n}catch(e){return s(e)}}}onError(e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+X(n.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}};function ce(e,t){return le.parse(e,t)}function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function de(){de=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",i=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var s=t&&t.prototype instanceof y?t:y,o=Object.create(s.prototype),i=new z(r||[]);return a(o,"_invoke",{value:B(e,n,i)}),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var p="suspendedStart",h="suspendedYield",m="executing",g="completed",f={};function y(){}function k(){}function b(){}var x={};c(x,o,(function(){return this}));var v=Object.getPrototypeOf,w=v&&v(v(A([])));w&&w!==n&&r.call(w,o)&&(x=w);var E=b.prototype=y.prototype=Object.create(x);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(a,s,o,i){var l=d(e[a],e,s);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==ue(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,o,i)}),(function(e){n("throw",e,o,i)})):t.resolve(u).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,i)}))}i(l.arg)}var s;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return s=s?s.then(a,a):a()}})}function B(t,n,r){var a=p;return function(s,o){if(a===m)throw Error("Generator is already running");if(a===g){if("throw"===s)throw o;return{value:e,done:!0}}for(r.method=s,r.arg=o;;){var i=r.delegate;if(i){var l=T(i,r);if(l){if(l===f)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=m;var c=d(t,n,r);if("normal"===c.type){if(a=r.done?g:h,c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=g,r.method="throw",r.arg=c.arg)}}}function T(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var s=d(a,t.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,f;var o=s.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,f):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function z(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function A(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,s=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw new TypeError(ue(t)+" is not iterable")}return k.prototype=b,a(E,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:k,configurable:!0}),k.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},S(I.prototype),c(I.prototype,i,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,r,a,s){void 0===s&&(s=Promise);var o=new I(u(e,n,r,a),s);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(E),c(E,l,"Generator"),c(E,o,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=A,z.prototype={constructor:z,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return i.type="throw",i.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],i=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var s=a;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;L(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:A(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),f}},t}function pe(e,t,n,r,a,s,o){try{var i=e[s](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,a)}function he(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(e){pe(s,r,a,o,i,"next",e)}function i(e){pe(s,r,a,o,i,"throw",e)}o(void 0)}))}}ce.options=ce.setOptions=function(e){return le.setOptions(e),ce.defaults=le.defaults,t(ce.defaults),ce},ce.getDefaults=function(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},ce.defaults=e,ce.use=function(...e){return le.use(...e),ce.defaults=le.defaults,t(ce.defaults),ce},ce.walkTokens=function(e,t){return le.walkTokens(e,t)},ce.parseInline=le.parseInline,ce.Parser=oe,ce.parser=oe.parse,ce.Renderer=ae,ce.TextRenderer=se,ce.Lexer=re,ce.lexer=re.lex,ce.Tokenizer=ne,ce.Hooks=ie,ce.parse=ce,ce.options,ce.setOptions,ce.use,ce.walkTokens,ce.parseInline,oe.parse,re.lex;var me=[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_NONE"}],ge={summarize:'You are an expert researcher. Your task is to review the provided research document and complete the following tasks with academic depth and varied sentence structures:\n\n1. Summarize the Research Background:\n   - Provide a concise yet comprehensive summary of the study\'s background, including its context and motivation.\n\n2. Extract the Problem Statement:\n   - Clearly identify and articulate the central problem or challenge addressed by the research.\n\n3. Identify Strengths:\n   - List 3–5 key strengths of the study, focusing on aspects such as methodology, innovation, robustness of results, or any other notable positive attributes.\n\n4. Identify Weaknesses:\n   - Enumerate 4–5 significant weaknesses or limitations present in the research, considering issues like methodological gaps, limited scope, or areas lacking clarity.\n\n5. Propose Research Topics:\n   - Based on the weaknesses identified, suggest three potential research topics that could address these limitations or explore related areas further.\n\n6. Include a "tl;dr" Section:\n   - At the very top of your response, provide a succinct "tl;dr" summary without any syntax highlighting that encapsulates the main points and any necessary takeaways.\n\nDo not include any extraneous messages, introductions, or commentary. Your final output should strictly adhere to these instructions.\n\nSubject: {subject}\nContent:\n{content}',translate:"You are an expert translator and interpreter with extensive proficiency in various languages, specializing in translating texts into polished, academic Korean. Your task is to translate the provided text from the source language into Korean, ensuring that every nuance, stylistic detail, and analytical aspect is accurately and naturally conveyed. Please follow these guidelines:\n\nPreserve Nuance and Style:\n- Accurately reflect the original text's tone, emotional nuance, and stylistic characteristics in Korean.\n- Adapt idiomatic expressions, metaphors, and culturally specific references to ensure they resonate with Korean readers.\n\nMaintain Analytical Precision:\n- Carefully dissect complex sentences and ideas, ensuring that your translation maintains the original text's logical flow and depth of analysis.\n- Where necessary, integrate brief annotations or contextual clarifications to help convey any cultural or conceptual subtleties.\n\nEnsure Accuracy and Consistency:\n- Translate specialized vocabulary, technical terms, and academic language with precision and maintain consistency throughout the text.\n- Verify that the structure and argumentative progression of the source material are preserved in the Korean version.\n\nUphold Contextual Integrity:\n- Ensure that the overall message and intent of the original text are fully maintained in your translation.\n- Make sure that transitions between ideas and sections remain coherent and logically connected in Korean.\n\nReview and Refine:\n- Reassess your translation for any potential ambiguities or loss of nuance, refining as necessary to enhance clarity and precision.\n- Strive for a balanced outcome that honors the original text while ensuring the translation is engaging and accessible to a Korean audience.\n\nProvide tl;dr at the top:\nWrite a tl;dr section at the top of your response that summarizes the main points and todos if needed.\n\nDeliver your final translation in refined, academic Korean that faithfully embodies the original text's analytical and stylistic essence.\n\nSubject: {subject}\n\nContent:\n{content}",translateSummarize:"You are an expert translator and summarizer with extensive proficiency in various languages, specializing in translating texts into polished, academic Korean. Your task is to translate the provided text from the source language into Korean AND create a concise summary of the main points. Please follow these guidelines:\n\nTranslation Aspects:\n- Accurately reflect the original text's tone, emotional nuance, and stylistic characteristics in Korean.\n- Adapt idiomatic expressions, metaphors, and culturally specific references to ensure they resonate with Korean readers.\n- Maintain analytical precision and logical flow in the Korean translation.\n\nSummarization Requirements:\n- Create a concise and focused summary of the key points in Korean.\n- Prioritize clarity and brevity while maintaining the essential meaning.\n- Ensure the summary captures the main ideas, arguments, and conclusions.\n- Limit the summary to approximately 30-40% of the original length.\n\nFinal Delivery Format:\n1. First provide tl;dr at the top:\nWrite a tl;dr section at the top of your response that summarizes the main points and todos if needed.\n2. Then provide a concise summary section (제목: 요약)\n3. Then provide the full translation (제목: 전체 번역)\n\nSubject: {subject}\n\nContent:\n{content}",reply:"You are an expert assistant that can help me with my email. I will provide you with the email content and you will help me with the following tasks:\n\n  Write a reply to the email.\n\n  Subject: {subject}\n\n  Content:\n  {content}\n  in {language}",tldrPrompt:"Please provide a very concise summary in {language} of the following content. Focus on the main points and key takeaways. Do not include any extraneous messages, introductions, or commentary. Your final output should strictly adhere to these instructions.\n\n  Subject: {subject}\n\n  Content:\n  {content}"};function fe(){var e=document.getElementById("settings-dropdown");if(e){var t="block"===e.style.display;e.style.display=t?"none":"block"}}function ye(){var e=localStorage.getItem("theme")||"dark";if("light"===e)document.body.setAttribute("data-theme","light"),document.body.classList.remove("dark-theme");else if("dark"===e)document.body.setAttribute("data-theme","dark"),document.body.classList.add("dark-theme");else if(Office.context.officeTheme){var t=Office.context.officeTheme.bodyBackgroundColor;t&&!function(e){if(!e||"string"!=typeof e)return!1;try{e=e.replace("#","");var t=parseInt(e.substr(0,2),16),n=parseInt(e.substr(2,2),16),r=parseInt(e.substr(4,2),16);return!(isNaN(t)||isNaN(n)||isNaN(r))&&.299*t+.587*n+.114*r<128}catch(e){return console.error("Error calculating theme brightness:",e),!1}}(t)?(document.body.setAttribute("data-theme","light"),document.body.classList.remove("dark-theme")):(document.body.setAttribute("data-theme","dark"),document.body.classList.add("dark-theme"))}var n=document.getElementById("sideload-logo"),r=document.getElementById("landing-logo-main"),a=document.getElementById("brand-logo"),s=document.body.classList.contains("dark-theme");n&&(n.src=s?"assets/meet-michael-white.png":"assets/meet-michael-black.png"),r&&(r.src=s?"assets/meet-michael-white.png":"assets/meet-michael-black.png"),a&&(a.src=s?"assets/michael-white.png":"assets/michael-black.png")}function ke(e){"system"===(localStorage.getItem("theme")||"system")&&ye()}function be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("notification");n&&n.remove();var r=document.createElement("div");r.id="notification",r.className="notification ".concat(t),r.textContent=e,document.body.appendChild(r),r.offsetHeight,r.style.animation="slideInFromTop 0.3s ease-out",setTimeout((function(){r.style.animation="slideOutToTop 0.3s ease-out",setTimeout((function(){r.remove()}),300)}),3e3)}function xe(){var e={};try{var t=localStorage.getItem("my_sidekick_michael_settings");t&&(e=JSON.parse(t))}catch(e){console.error("Error parsing settings:",e)}var n=document.getElementById("dropdown-api-key").value,r=document.getElementById("dropdown-model").value,a=document.getElementById("dropdown-language").value,s=document.getElementById("dropdown-event-title-language").value,o=document.getElementById("dropdown-theme").value,i=document.getElementById("dropdown-font-size").value,l=document.getElementById("dropdown-tldr-mode").value,c=document.getElementById("dropdown-show-reply").value,u=document.getElementById("dropdown-reply-template").value,d=document.getElementById("dropdown-autorun").value,p=document.getElementById("dropdown-autorun-option").value,h=document.getElementById("dropdown-dev-mode").value,m=document.getElementById("dropdown-dev-server").value,g=document.getElementById("dropdown-summarize-template").value,f=document.getElementById("dropdown-translate-template").value,y=document.getElementById("dropdown-translate-summarize-template").value;e.apiKey=n,e.model=r,e.defaultLanguage=a,e.eventTitleLanguage=s,e.theme=o,e.fontSize=i,e.tldrMode=l,e.showReply=c,e.replyModel=u,e.autorun=d,e.autorunOption=p,e.devMode=h,e.devServer=m,e.templates||(e.templates={}),e.templates.summarize=g,e.templates.translate=f,e.templates.translateSummarize=y,e.templates.reply=u,localStorage.setItem("my_sidekick_michael_settings",JSON.stringify(e)),n?localStorage.setItem("my_sidekick_michael_api_key",n):localStorage.removeItem("my_sidekick_michael_api_key"),localStorage.setItem("theme",o),ye(),we(i),Je("true"===c),We("true"===h),be("All settings saved successfully"),fe()}function ve(){var e=localStorage.getItem("my_sidekick_michael_settings"),t=e?JSON.parse(e):{};t.templates=ge,localStorage.setItem("my_sidekick_michael_settings",JSON.stringify(t)),document.getElementById("dropdown-summarize-template").value=ge.summarize,document.getElementById("dropdown-translate-template").value=ge.translate,document.getElementById("dropdown-translate-summarize-template")&&(document.getElementById("dropdown-translate-summarize-template").value=ge.translateSummarize),document.getElementById("dropdown-reply-template")&&(document.getElementById("dropdown-reply-template").value=ge.reply),be("Templates reset to defaults")}function we(e){document.documentElement.setAttribute("data-font-size",e||"medium")}function Ee(){return Se.apply(this,arguments)}function Se(){return(Se=he(de().mark((function e(){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){Office.context.mailbox.item.body.getAsync("text",(function(n){n.status===Office.AsyncResultStatus.Succeeded?e(n.value):t(new Error("Failed to get email content"))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e,t){return Be.apply(this,arguments)}function Be(){return Be=he(de().mark((function e(t,n){var r,a,s,o,i,l,c,u,d,p,h=arguments;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=h.length>3&&void 0!==h[3]&&h[3],s="gemini-2.0-flash-light",r=h.length>2&&void 0!==h[2]?h[2]:null)s=r;else try{(o=localStorage.getItem("my_sidekick_michael_settings"))&&(i=JSON.parse(o)).model&&(s=i.model)}catch(e){console.error("Error getting model from settings:",e)}return l="https://generativelanguage.googleapis.com/v1beta/models/".concat(s,":generateContent?key=").concat(n),e.prev=5,e.next=8,fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:t}]}],generationConfig:{temperature:.4,topK:32,topP:.95,maxOutputTokens:a?800:8192},safetySettings:me})});case 8:return c=e.sent,e.next=11,c.json();case 11:if(u=e.sent,c.ok){e.next=14;break}throw new Error((null===(d=u.error)||void 0===d?void 0:d.message)||"Error generating content");case 14:if(u.candidates&&0!==u.candidates.length){e.next=16;break}throw new Error("No content generated");case 16:return p=u.candidates[0].content.parts[0].text,e.abrupt("return",p);case 20:throw e.prev=20,e.t0=e.catch(5),console.error("Error generating content:",e.t0),e.t0;case 24:return e.prev=24,a||(document.getElementById("loading").style.display="none"),e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[5,20,24,27]])}))),Be.apply(this,arguments)}function Te(e,t){return _e.apply(this,arguments)}function _e(){return _e=he(de().mark((function e(t,n){var r,a,s,o,i,l,c=arguments;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:"Korean",a=c.length>3&&void 0!==c[3]?c[3]:null,s=Office.context.mailbox.item.subject,e.next=5,Ee();case 5:return o=e.sent,i=ge.tldrPrompt.replace("{subject}",s).replace("{content}",o).replace("{language}",r),e.next=9,Ie(i,n,a,!0);case 9:return l=e.sent,e.abrupt("return",l);case 11:case"end":return e.stop()}}),e)}))),_e.apply(this,arguments)}function Le(e){switch(e){case"es":return"Spanish";case"fr":return"French";case"de":return"German";case"it":return"Italian";case"ja":return"Japanese";case"ko":return"Korean";case"zh_cn":return"Chinese";default:return"English"}}function ze(){return localStorage.getItem("my_sidekick_michael_api_key")}function Ae(){try{var e=localStorage.getItem("my_sidekick_michael_settings");if(e){var t=JSON.parse(e);if(t.defaultLanguage)return t.defaultLanguage}return"ko"}catch(e){return console.error("Error getting language:",e),"ko"}}function Re(){return Oe.apply(this,arguments)}function Oe(){return(Oe=he(de().mark((function e(){var t,n,r,a,s,o,i,l,c,u,d;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ze()){e.next=5;break}return be("Please add your Gemini API key in the settings","error"),fe(),e.abrupt("return");case 5:return He("Summarizing email..."),e.prev=6,e.next=9,Ee();case 9:n=e.sent,r=Office.context.mailbox.item.subject,a=ge.summarize;try{(s=localStorage.getItem("my_sidekick_michael_settings"))&&(o=JSON.parse(s)).templates&&o.templates.summarize&&(a=o.templates.summarize)}catch(e){console.error("Error getting template:",e)}i=a.replace("{subject}",r).replace("{content}",n),l=!0;try{(c=localStorage.getItem("my_sidekick_michael_settings"))&&(u=JSON.parse(c)).tldrMode&&(l="true"===u.tldrMode)}catch(e){console.error("Error getting TLDR mode setting:",e)}if(!l){e.next=29;break}return e.next=19,Te(i,t,"English");case 19:return d=e.sent,De(),qe(d,0),e.next=24,Ie(i,t);case 24:Ye(e.sent),Pe(!0),e.next=33;break;case 29:return e.next=31,Ie(i,t);case 31:qe(e.sent,0);case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(6),be("Error: ".concat(e.t0.message),"error");case 38:case"end":return e.stop()}}),e,null,[[6,35]])})))).apply(this,arguments)}function $e(){return Ce.apply(this,arguments)}function Ce(){return(Ce=he(de().mark((function e(){var t,n,r,a,s,o,i,l,c,u,d,p;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ze(),n=Ae(),t){e.next=6;break}return be("Please add your Gemini API key in the settings","error"),fe(),e.abrupt("return");case 6:return He("Translating to "+Le(n)+"..."),e.prev=7,e.next=10,Ee();case 10:r=e.sent,a=Office.context.mailbox.item.subject,s=ge.translate;try{(o=localStorage.getItem("my_sidekick_michael_settings"))&&(i=JSON.parse(o)).templates&&i.templates.translate&&(s=i.templates.translate)}catch(e){console.error("Error getting template:",e)}l=s.replace("{subject}",a).replace("{content}",r),c=!0;try{(u=localStorage.getItem("my_sidekick_michael_settings"))&&(d=JSON.parse(u)).tldrMode&&(c="true"===d.tldrMode)}catch(e){console.error("Error getting TLDR mode setting:",e)}if(!c){e.next=30;break}return e.next=20,Te(l,t,n);case 20:return p=e.sent,De(),qe(p,1),e.next=25,Ie(l,t);case 25:Ye(e.sent),Pe(!0),e.next=34;break;case 30:return e.next=32,Ie(l,t,n);case 32:qe(e.sent,1);case 34:e.next=39;break;case 36:e.prev=36,e.t0=e.catch(7),be("Error: ".concat(e.t0.message),"error");case 39:case"end":return e.stop()}}),e,null,[[7,36]])})))).apply(this,arguments)}function Pe(e){var t=document.getElementById("expand-content");t&&(t.disabled=!e,t.classList.toggle("ms-Button--disabled",!e),t.innerHTML=e?"Show Full Content":"Hide Full Content",t.classList.toggle("ms-Button--primary",e))}function Ne(){var e="",t=document.getElementById("tldr-content").innerText,n=document.getElementById("result-content").innerText;if(t.includes("Subject:")||n.includes("Subject:")){var r="",a="",s=/^(?:Subject:\s*)?(.+?)(?:\n|$)/i.exec(t);s&&(r=s[1].trim()),a="none"!==document.getElementById("full-content-container").style.display?n:s?t.split("\n").slice(1).join("\n").trim():t,e="Subject: ".concat(r,"\n\n").concat(a)}else e="none"!==document.getElementById("full-content-container").style.display?n:t;navigator.clipboard.writeText(e).then((function(){var e=document.getElementById("copy-status");e.textContent="Copied!",setTimeout((function(){e.textContent=""}),2e3)})).catch((function(e){console.error("Could not copy text: ",e),be("Failed to copy to clipboard","error")}))}function Me(){return je.apply(this,arguments)}function je(){return(je=he(de().mark((function e(){var t,n,r,a,s,o,i,l,c,u,d,p;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ze()){e.next=5;break}return be("Please add your Gemini API key in the settings","error"),fe(),e.abrupt("return");case 5:return He("Translating and summarizing..."),e.prev=6,e.next=9,Ee();case 9:n=e.sent,r=Office.context.mailbox.item.subject,a="English",s=ge.translateSummarize;try{(o=localStorage.getItem("my_sidekick_michael_settings"))&&((i=JSON.parse(o)).templates&&i.templates.translateSummarize&&(s=i.templates.translateSummarize),i.language&&(a=i.language))}catch(e){console.error("Error getting template:",e)}l=s.replace("{subject}",r).replace("{content}",n).replace("{language}",a),c=!0;try{(u=localStorage.getItem("my_sidekick_michael_settings"))&&(d=JSON.parse(u)).tldrMode&&(c="true"===d.tldrMode)}catch(e){console.error("Error getting TLDR mode setting:",e)}if(!c){e.next=30;break}return e.next=20,Te(l,t);case 20:return p=e.sent,De(),qe(p,2),e.next=25,Ie(l,t);case 25:Ye(e.sent),Pe(!0),e.next=34;break;case 30:return e.next=32,Ie(l,t);case 32:qe(e.sent,2);case 34:e.next=39;break;case 36:e.prev=36,e.t0=e.catch(6),be("Error: ".concat(e.t0.message),"error");case 39:case"end":return e.stop()}}),e,null,[[6,36]])})))).apply(this,arguments)}function He(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...";document.getElementById("loading").style.display="block",document.getElementById("loading-message").textContent=e,document.getElementById("landing-screen").style.display="none",document.getElementById("result-section").style.display="none"}function De(){var e=document.getElementById("loading");e&&(e.style.display="none")}function qe(e,t){document.getElementById("result-content").innerHTML="",document.getElementById("tldr-content").innerHTML="";var n=document.getElementById("expand-content");n&&(n.disabled=!0,n.classList.add("ms-Button--disabled"),n.innerHTML='<span class="ms-Button-label">Show Full Content</span>',n.classList.remove("ms-Button--primary")),document.getElementById("loading").style.display="none",document.getElementById("result-section").style.display="block",document.getElementById("landing-screen").style.display="none",document.getElementById("app-body").style.display="block";var r=!0;try{var a=localStorage.getItem("my_sidekick_michael_settings");if(a){var s=JSON.parse(a);s.tldrMode&&(r="true"===s.tldrMode)}}catch(e){console.error("Error getting TLDR mode setting:",e)}if(r){document.getElementById("tldr-content").innerHTML=ce.parse(e);var o=document.getElementById("expand-content");o&&(o.disabled=!0,o.classList.add("ms-Button--disabled"),o.innerHTML='<span class="ms-Button-label">Loading Full Content...</span>')}else{document.getElementById("tldr-content").innerHTML=ce.parse(e);var i=document.getElementById("result-content");i||((i=document.createElement("div")).id="result-content",document.getElementById("full-content-container").appendChild(i)),i.innerHTML=ce.parse(e),document.getElementById("full-content-container").style.display="block";var l=document.getElementById("expand-content");l&&(l.disabled=!1,l.classList.remove("ms-Button--disabled"),l.innerHTML='<span class="ms-Button-label">Show Full Content</span>',l.classList.add("ms-Button--primary"))}var c=document.getElementById("copy-reply");c&&(c.style.display=3===t?"inline-block":"none");var u=document.getElementById("copy-result");u&&(u.style.display=3===t?"none":"inline-block");var d=document.getElementById("generate-reply");if(d){var p=localStorage.getItem("my_sidekick_michael_settings")&&"true"===JSON.parse(localStorage.getItem("my_sidekick_michael_settings")).showReply;d.style.display=3===t?"none":p?"inline-block":"none"}try{var h=localStorage.getItem("my_sidekick_michael_settings");if(h){var m=JSON.parse(h);m.fontSize&&we(m.fontSize),m.showReply&&Je("true"===m.showReply)}}catch(e){console.error("Error applying font size:",e)}var g=document.getElementById("result-content"),f=document.getElementById("tldr-content");g&&(g.scrollTop=0),f&&(f.scrollTop=0)}function Ye(e){var t=document.getElementById("expand-content");t&&(t.disabled=!1,t.classList.remove("ms-Button--disabled"),t.innerHTML='<span class="ms-Button-label">Show Full Content</span>');var n=document.getElementById("loading-container");n&&n.remove();var r=document.getElementById("result-content");r&&(r.innerHTML=ce.parse(e))}function Je(e){var t=document.getElementById("generate-reply");t&&(t.style.display=e?"inline-block":"none")}function Fe(){var e=document.getElementById("expand-content");if(!e.disabled){var t=document.getElementById("full-content-container");"none"===t.style.display?(t.style.display="block",e.innerHTML='<span class="ms-Button-label">Hide Full Content</span>',e.classList.remove("ms-Button--primary")):(t.style.display="none",e.innerHTML='<span class="ms-Button-label">Show Full Content</span>',e.classList.add("ms-Button--primary"))}}function Ge(e){var t="",n="",r=e.match(/^(?:SUBJECT:|Subject:)\s*(.+?)(?:\n|$)/m);if(r)t=r[1].trim(),n=e.replace(/^(?:SUBJECT:|Subject:)\s*.+?\n+/m,"").trim();else{var a=e.trim().split("\n");a.length>0?(t=a[0].trim(),n=a.slice(1).join("\n").trim()):(t="Re: Your email",n=e.trim())}return{html:'\n    <div class="reply-container">\n      <div class="reply-subject">\n        <span class="reply-label">Subject:</span>'.concat(t,'\n      </div>\n      <div class="reply-body">').concat(n,"</div>\n    </div>\n  "),subject:t,body:n,raw:"Subject: ".concat(t,"\n\n").concat(n)}}function Ze(){return Ke.apply(this,arguments)}function Ke(){return(Ke=he(de().mark((function e(){var t,n,r,a,s,o,i,l,c,u,d,p,h;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ze()){e.next=5;break}return be("Please add your Gemini API key in the settings","error"),fe(),e.abrupt("return");case 5:return He("Generating reply..."),e.prev=6,e.next=9,Ee();case 9:n=e.sent,r=Office.context.mailbox.item.subject,a=ge.reply;try{(s=localStorage.getItem("my_sidekick_michael_settings"))&&(o=JSON.parse(s)).templates&&o.templates.reply&&(a=o.templates.reply)}catch(e){console.error("Error getting reply template:",e)}i=Ae(),l=a.replace("{subject}",r).replace("{content}",n).replace("{language}",Le(i)),c=null;try{(u=localStorage.getItem("my_sidekick_michael_settings"))&&(d=JSON.parse(u)).replyModel&&(c=d.replyModel)}catch(e){console.error("Error getting reply model:",e)}return e.next=19,Ie(l,t,c);case 19:p=e.sent,h=Ge(p),document.getElementById("tldr-content").innerHTML=h.html,document.getElementById("result-content").innerHTML=h.html,document.getElementById("result-section").style.display="block",document.getElementById("copy-reply").style.display="inline-block",document.getElementById("copy-result").style.display="none",e.next=31;break;case 28:e.prev=28,e.t0=e.catch(6),be("Error: ".concat(e.t0.message),"error");case 31:return e.prev=31,De(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[6,28,31,34]])})))).apply(this,arguments)}function Ue(){return(Ue=he(de().mark((function e(){var t,n,r,a;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=document.getElementById("settings-section"),n=document.getElementById("result-section"),r=document.getElementById("tldr-section"),t&&(t.style.display="none"),n&&(n.style.display="none"),r&&(r.style.display="none"),(a=Qe())&&(a.theme&&(s=a.theme,o=void 0,o=document.documentElement,"system"===s?window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?o.setAttribute("data-theme","dark"):o.setAttribute("data-theme","light"):o.setAttribute("data-theme",s)),a.fontSize&&(i=a.fontSize,document.documentElement.style.setProperty("--result-font-size",function(e){switch(e){case"small":return"0.875rem";case"medium":default:return"1rem";case"large":return"1.125rem"}}(i)))),ze()||be("Please add your Gemini API key in settings","warning");case 10:case"end":return e.stop()}var s,o,i}),e)})))).apply(this,arguments)}function Qe(){try{var e=localStorage.getItem("michael_settings");if(e){var t=JSON.parse(e);Object.keys(t).forEach((function(e){var n=document.getElementById(e);n&&"SELECT"===n.tagName&&(n.value=t[e])}))}}catch(e){console.error("Error loading settings:",e)}}function Xe(){document.getElementById("dropdown-model").value="gemini-1.5-flash",document.getElementById("dropdown-language").value="ko",document.getElementById("dropdown-event-title-language").value="en",document.getElementById("dropdown-theme").value="system",document.getElementById("dropdown-font-size").value="medium",document.getElementById("dropdown-tldr-mode").value="true",document.getElementById("dropdown-show-reply").value="true",document.getElementById("dropdown-reply-model").value="gemini-2.0-flash-lite",document.getElementById("dropdown-autorun").value="false",document.getElementById("dropdown-autorun-option").value="summarize",document.getElementById("dropdown-dev-mode").value="false",document.getElementById("dropdown-dev-server").value="",document.getElementById("dev-server-group").style.display="none",ve(),document.getElementById("dropdown-api-key").value="",localStorage.removeItem("michael_api_key"),localStorage.removeItem("michael_settings"),ye(),we("medium"),Je(!0),We(!1),be("All settings reset to defaults","success")}function We(e){var t=document.getElementById("dev-badge"),n=document.getElementById("footer-dev-badge");t&&(t.style.display=e?"block":"none"),n&&(n.style.display=e?"block":"none")}function Ve(){try{var e=localStorage.getItem("michael_settings");if(e){var t=JSON.parse(e);if(t.eventTitleLanguage)return t.eventTitleLanguage}return"en"}catch(e){return console.error("Error getting event title language:",e),"en"}}function et(e){return tt.apply(this,arguments)}function tt(){return(tt=he(de().mark((function e(t){var n,r,a,s,o,i,l,c,u,d,p;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=ze()){e.next=4;break}throw new Error("API key not found");case 4:return r=Ve(),"",a="en"===r?"Event title should be in English.\n      If the event has a type or category, include it in square brackets ([]) at the beginning, then if there's a presenter and topic, write the presenter's name first, followed by a hyphen (-) and then the topic.":"ko"===r?"이벤트 제목은 한국어로 작성해주세요.\n      이벤트 유형이나 카테고리가 있다면 대괄호([])로 먼저 표시하고, 발표자와 주제가 있다면 발표자 이름을 먼저 쓰고 하이픈(-) 후에 주제를 적어주세요.":"ja"===r?"イベントのタイトルは日本語で記載してください。\n      イベントのタイプやカテゴリがある場合は、角括弧（[]）で囲んで最初に表示し、発表者とトピックがある場合は、発表者の名前を最初に書き、ハイフン（-）の後にトピックを書いてください。":"zh_cn"===r?"事件标题应该用中文书写。\n      如果事件有类型或类别，请使用方括号（[]）将其括起来并放在开头，如果有演讲者和主题，请先写演讲者的名字，然后是连字符（-），再写主题。":"Event title should be in ".concat(Le(r),".\n      If the event has a type or category, include it in square brackets ([]) at the beginning, then if there's a presenter and topic, write the presenter's name first, followed by a hyphen (-) and then the topic."),s="Analyze the following email content and extract information needed to create a calendar event for Microsoft Graph API.\n    The response must be in valid JSON format and follow the format below exactly.\n    Do not use escape characters that would cause parsing issues.\n    Mark any information that cannot be found as null.\n\n    ".concat(a,'\n\n    Event title format examples:\n    - "[Event Type] Presenter - Topic"\n    - "[Conference Name] Presenter Name - Presentation Topic"\n    - "[Seminar Type] Speaker Name - Presentation Title"\n\n    Required JSON format:\n    {\n      "subject": "Meeting title",\n      "body": {\n        "contentType": "HTML",\n        "content": "Meeting description"\n      },\n      "start": {\n        "dateTime": "YYYY-MM-DDTHH:mm:ss",\n        "timeZone": "Asia/Seoul"\n      },\n      "end": {\n        "dateTime": "YYYY-MM-DDTHH:mm:ss",\n        "timeZone": "Asia/Seoul"\n      },\n      "location": {\n        "displayName": "Location name"\n      },\n      "attendees": [\n        {\n          "emailAddress": {\n            "address": "attendee@email.com",\n            "name": "Attendee Name"\n          },\n          "type": "required"\n        }\n      ],\n      "isOnlineMeeting": true,\n      "onlineMeetingProvider": "teamsForBusiness"\n    }\n\n    Important notes:\n    1. Convert dates and times to ISO 8601 format (YYYY-MM-DDTHH:mm:ss)\n    2. Email addresses must be in valid format\n    3. Use "Asia/Seoul" as the default timezone\n    4. Set isOnlineMeeting to true if there are Teams links or video conference details\n    5. Process special characters properly to ensure valid JSON\n    6. Return only JSON without any additional explanations or comments\n\n    Email content:\n    ').concat(t),console.log("Sending prompt to Gemini API"),e.next=11,Ie(s,n,null,!1);case 11:if(o=e.sent,console.log("Received response from Gemini API"),i=o,(l=o.match(/\{[\s\S]*\}/))&&(i=l[0]),console.log("Extracted JSON text:",i),e.prev=17,d=JSON.parse(i),console.log("Successfully parsed event details:",d),d.subject){e.next=22;break}throw new Error("Event title not found.");case 22:if(null!==(c=d.start)&&void 0!==c&&c.dateTime){e.next=24;break}throw new Error("Event start time not found.");case 24:if(null!==(u=d.end)&&void 0!==u&&u.dateTime){e.next=26;break}throw new Error("Event end time not found.");case 26:if((p=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}$/).test(d.start.dateTime)){e.next=29;break}throw new Error("Invalid start time format. (Should be YYYY-MM-DDTHH:mm:ss format)");case 29:if(p.test(d.end.dateTime)){e.next=31;break}throw new Error("Invalid end time format. (Should be YYYY-MM-DDTHH:mm:ss format)");case 31:return e.abrupt("return",d);case 34:throw e.prev=34,e.t0=e.catch(17),console.error("JSON parsing error:",e.t0),console.error("Original response:",o),new Error("Failed to extract event information: "+e.t0.message);case 39:e.next=45;break;case 41:throw e.prev=41,e.t1=e.catch(0),console.error("Error extracting event information:",e.t1),e.t1;case 45:case"end":return e.stop()}}),e,null,[[0,41],[17,34]])})))).apply(this,arguments)}function nt(e){return rt.apply(this,arguments)}function rt(){return(rt=he(de().mark((function e(t){var n,r,a,s,o,i,l,c,u,d,p;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.subject&&null!==(n=t.start)&&void 0!==n&&n.dateTime&&null!==(r=t.end)&&void 0!==r&&r.dateTime){e.next=3;break}throw new Error("Required event information is missing.");case 3:return l=new Date(t.start.dateTime),c=new Date(t.end.dateTime),u=[],d=[],t.attendees&&t.attendees.length>0&&t.attendees.forEach((function(e){e.emailAddress&&e.emailAddress.address&&("optional"===e.type?d.push(e.emailAddress.address):u.push(e.emailAddress.address))})),p={requiredAttendees:u,optionalAttendees:d,start:l,end:c,location:(null===(a=t.location)||void 0===a?void 0:a.displayName)||"",body:(null===(s=t.body)||void 0===s?void 0:s.content)||"",subject:t.subject},console.log("Creating appointment with data:",JSON.stringify(p)),Office.context.mailbox.displayNewAppointmentForm({requiredAttendees:u,optionalAttendees:d,start:l,end:c,location:(null===(o=t.location)||void 0===o?void 0:o.displayName)||"",body:(null===(i=t.body)||void 0===i?void 0:i.content)||"",subject:t.subject}),be("Event '".concat(t.subject,"' has been created."),"info"),e.abrupt("return",!0);case 15:throw e.prev=15,e.t0=e.catch(0),be("Failed to create event: ".concat(e.t0.message),"error"),console.error("Error creating calendar event:",e.t0),e.t0;case 20:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}function at(e){return st.apply(this,arguments)}function st(){return(st=he(de().mark((function e(t){var n,r,a;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=ze()){e.next=5;break}return console.error("API key not found"),e.abrupt("return",!1);case 5:return r="Check if the following email content is a calendar event (meeting, appointment, schedule, etc.).\n    Return true if the email content includes one or more of the following:\n    - Date and time information\n    - Meeting-related keywords (meeting, conference, appointment, schedule, calendar, etc.)\n    - Attendee information\n    - Location information\n    - Schedule-related actions (attendance confirmation, add to calendar, etc.)\n\n    Email content:\n    ".concat(t,'\n\n    Your response must only contain "true" or "false".'),e.next=8,Ie(r,n,null,!0);case 8:return a=e.sent,e.abrupt("return","true"===a.toLowerCase().trim());case 12:return e.prev=12,e.t0=e.catch(0),console.error("Error checking if calendar event:",e.t0),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function ot(){return it.apply(this,arguments)}function it(){return(it=he(de().mark((function e(){var t,n,r,a,s,o,i,l;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ze()){e.next=5;break}return be("Please add your API key in settings","error"),fe(),e.abrupt("return");case 5:return He("Creating calendar event..."),e.prev=6,e.next=9,Ee();case 9:return t=e.sent,document.getElementById("landing-screen").style.display="none",document.getElementById("result-section").style.display="block",document.getElementById("tldr-content").innerHTML='\n      <div class="email-content-header">\n        <h3>Email Content</h3>\n        <button id="copy-email-content" class="ms-Button ms-Button--primary">\n          <span class="ms-Button-label">Copy to Clipboard</span>\n        </button>\n      </div>\n      <div class="email-content-body">\n        <pre style="white-space: pre-wrap; word-break: break-word;">'.concat(t,"</pre>\n      </div>\n    "),document.getElementById("copy-email-content").addEventListener("click",(function(){navigator.clipboard.writeText(t).then((function(){be("Email content copied to clipboard","info")})).catch((function(e){console.error("Error copying to clipboard:",e),be("Failed to copy to clipboard","error")}))})),e.prev=14,e.next=17,et(t);case 17:return s=e.sent,document.getElementById("result-content").innerHTML='\n        <div class="event-details-header">\n          <h3>Extracted Event Details</h3>\n        </div>\n        <div class="event-details-body">\n          <p><strong>Subject:</strong> '.concat(s.subject||"Not found","</p>\n          <p><strong>Start:</strong> ").concat((null===(n=s.start)||void 0===n?void 0:n.dateTime)||"Not found","</p>\n          <p><strong>End:</strong> ").concat((null===(r=s.end)||void 0===r?void 0:r.dateTime)||"Not found","</p>\n          <p><strong>Location:</strong> ").concat((null===(a=s.location)||void 0===a?void 0:a.displayName)||"Not found","</p>\n        </div>\n      "),e.next=21,nt(s);case 21:e.next=30;break;case 23:e.prev=23,e.t0=e.catch(14),console.error("Event extraction error:",e.t0),o=e.t0.message,i=o.includes("Failed to extract event information:")?o.split("Failed to extract event information:")[1].trim():o,document.getElementById("result-content").innerHTML='\n        <div class="event-details-header">\n          <h3>Event Extraction Failed</h3>\n        </div>\n        <div class="event-details-body">\n          <p class="error-message">'.concat(i,"</p>\n        </div>\n      "),be("Event extraction failed: ".concat(i),"error");case 30:e.next=36;break;case 32:e.prev=32,e.t1=e.catch(6),console.error("Calendar event handling error:",e.t1),be("Error: ".concat(e.t1.message),"error");case 36:return e.prev=36,De(),lt(),(l=document.getElementById("expand-content"))&&(l.disabled=!1,l.classList.remove("ms-Button--disabled"),l.innerHTML='<span class="ms-Button-label">Show Full Content</span>',l.classList.add("ms-Button--primary"),document.getElementById("full-content-container").style.display="block"),e.finish(36);case 42:case"end":return e.stop()}}),e,null,[[6,32,36,42],[14,23]])})))).apply(this,arguments)}function lt(){return ct.apply(this,arguments)}function ct(){return(ct=he(de().mark((function e(){var t,n,r;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ee();case 3:return t=e.sent,e.next=6,at(t);case 6:n=e.sent,(r=document.getElementById("calendar-event"))&&(n?(r.disabled=!1,r.classList.remove("action-button--disabled"),r.classList.add("action-button--primary"),console.log("Calendar event detected, button enabled")):(r.disabled=!0,r.classList.add("action-button--disabled"),r.classList.remove("action-button--primary"),console.log("Not a calendar event, button disabled"))),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error updating calendar button state:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function ut(){try{var e=localStorage.getItem("michael_settings"),t=e?JSON.parse(e):{},n=(localStorage.getItem("michael_api_key"),new Date),r=n.toISOString().slice(0,10),a="";try{if(Office.context.mailbox&&Office.context.mailbox.userProfile){var s=Office.context.mailbox.userProfile;a="\n\n*Exported by: ".concat(s.displayName," (").concat(s.emailAddress,")*")}}catch(e){console.log("User profile not available")}var o="# Michael Prompt Templates\n\n";o+="*Exported on: ".concat(n.toLocaleString(),"*").concat(a,"\n\n"),o+="## General Settings\n\n",o+="- **Model**: ".concat(t.model||"gemini-1.5-flash","\n"),o+="- **Reply Model**: ".concat(t.replyModel||"gemini-2.0-flash-lite","\n"),o+="- **Default Language**: ".concat(t.defaultLanguage||"ko","\n"),o+="- **Event Title Language**: ".concat(t.eventTitleLanguage||"en","\n\n"),o+="## Prompt Templates\n\n",o+="### Summarize Template\n\n```\n".concat(t.templates&&t.templates.summarize?t.templates.summarize:ge.summarize,"\n```\n\n"),o+="### Translate Template\n\n```\n".concat(t.templates&&t.templates.translate?t.templates.translate:ge.translate,"\n```\n\n"),o+="### Translate & Summarize Template\n\n```\n".concat(t.templates&&t.templates.translateSummarize?t.templates.translateSummarize:ge.translateSummarize,"\n```\n\n"),o+="### Reply Template\n\n```\n".concat(t.templates&&t.templates.reply?t.templates.reply:ge.reply,"\n```\n\n");var i=new Blob([o],{type:"text/markdown"}),l=URL.createObjectURL(i),c=document.createElement("a");c.href=l,c.download="michael-templates-".concat(r,".md"),document.body.appendChild(c),c.click(),setTimeout((function(){document.body.removeChild(c),URL.revokeObjectURL(l)}),100),be("Templates exported successfully","success")}catch(e){console.error("Error exporting templates:",e),be("Failed to export templates","error")}}Office.onReady((function(e){if(e.host===Office.HostType.Outlook){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",function(){Ue.apply(this,arguments)}();var t=!1,n=null;try{var r=localStorage.getItem("my_sidekick_michael_settings");if(r){var a=JSON.parse(r);t="true"===a.autorun,n=a.autorunOption}}catch(e){console.error("Error getting autorun settings:",e)}if(t&&n)switch(n){case"summarize":Re();break;case"translate":$e();break;case"translateAndSummarize":Me();break;case"reply":Ze()}document.getElementById("summarize").addEventListener("click",Re),document.getElementById("translate").addEventListener("click",$e),document.getElementById("translate-summarize").addEventListener("click",Me),document.getElementById("calendar-event").addEventListener("click",ot),document.getElementById("settings-toggle").addEventListener("click",fe),document.getElementById("dropdown-close-settings").addEventListener("click",fe),document.getElementById("dropdown-save-settings").addEventListener("click",xe),document.getElementById("dropdown-reset-all").addEventListener("click",Xe),document.getElementById("dropdown-export-markdown").addEventListener("click",ut),document.getElementById("dropdown-api-key").addEventListener("keypress",(function(e){"Enter"===e.key&&xe()})),document.getElementById("dropdown-dev-mode").addEventListener("change",(function(){document.getElementById("dev-server-group").style.display="true"===this.value?"block":"none"})),document.querySelectorAll(".settings-dropdown-container select").forEach((function(e){e.addEventListener("change",xe)})),document.getElementById("expand-content").addEventListener("click",Fe),document.getElementById("copy-result").addEventListener("click",Ne),document.getElementById("generate-reply").addEventListener("click",Ze),function(){try{var e=localStorage.getItem("my_sidekick_michael_settings"),t=localStorage.getItem("my_sidekick_michael_api_key");if(e){var n=JSON.parse(e);n.apiKey&&(document.getElementById("dropdown-api-key").value=n.apiKey),n.model&&(document.getElementById("dropdown-model").value=n.model),n.defaultLanguage&&(document.getElementById("dropdown-language").value=n.defaultLanguage),n.eventTitleLanguage&&(document.getElementById("dropdown-event-title-language").value=n.eventTitleLanguage),n.theme&&(document.getElementById("dropdown-theme").value=n.theme),n.fontSize&&(document.getElementById("dropdown-font-size").value=n.fontSize),n.tldrMode&&(document.getElementById("dropdown-tldr-mode").value=n.tldrMode),n.showReply&&(document.getElementById("dropdown-show-reply").value=n.showReply),n.devServer&&(document.getElementById("dropdown-dev-server").value=n.devServer);var r=document.getElementById("dev-server-group");r&&(r.style.display="true"===n.devMode?"block":"none"),We("true"===n.devMode),n.fontSize&&we(n.fontSize),n.showReply&&Je("true"===n.showReply),n.templates?(document.getElementById("dropdown-summarize-template").value=n.templates.summarize||ge.summarize,document.getElementById("dropdown-translate-template").value=n.templates.translate||ge.translate,document.getElementById("dropdown-translate-summarize-template").value=n.templates.translateSummarize||ge.translateSummarize,document.getElementById("dropdown-reply-template").value=n.templates.reply||ge.reply):ve()}else ve();t&&(document.getElementById("dropdown-api-key").value=t)}catch(e){console.error("Error loading dropdown settings:",e),ve()}}(),ye(),Office.context.mailbox.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.SettingsChanged,ke),Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,(function(e){var t=!1,n=null;try{var r=localStorage.getItem("my_sidekick_michael_settings");if(r){var a=JSON.parse(r);t="true"===a.autorun,n=a.autorunOption}}catch(e){console.error("Error getting autorun settings:",e)}if(t&&n)switch(n){case"summarize":Re();break;case"translate":$e();break;case"translateAndSummarize":Me();break;case"reply":Ze()}}),(function(e){e.status===Office.AsyncResultStatus.Succeeded&&e.value.addHandlerAsync(Office.EventType.ItemChanged,(function(e){var t=!1,n=null;try{var r=localStorage.getItem("my_sidekick_michael_settings");if(r){var a=JSON.parse(r);t="true"===a.autorun,n=a.autorunOption}}catch(e){console.error("Error getting autorun settings:",e)}if(t&&n)switch(n){case"summarize":Re();break;case"translate":$e();break;case"translateAndSummarize":Me();break;case"reply":Ze()}}),(function(e){e.status===Office.AsyncResultStatus.Succeeded&&e.value.register()}))})),Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,(function(e){lt()}),(function(e){e.status===Office.AsyncResultStatus.Succeeded&&e.value.addHandlerAsync(Office.EventType.ItemChanged,(function(e){lt()}))})),lt()}})),window.toggleSettingsDropdown=fe}();
//# sourceMappingURL=taskpane.js.map