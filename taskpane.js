/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";let e={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function t(t){e=t}const n={exec:()=>null};function r(e,t=""){let n="string"==typeof e?e:e.source;const r={replace:(e,t)=>{let o="string"==typeof t?t:t.source;return o=o.replace(s.caret,"$1"),n=n.replace(e,o),r},getRegex:()=>new RegExp(n,t)};return r}const s={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},o=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,a=/(?:[*+-]|\d{1,9}[.)])/,i=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,l=r(i).replace(/bull/g,a).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),c=r(i).replace(/bull/g,a).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),u=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,p=/(?!\s*\])(?:\\.|[^\[\]\\])+/,d=r(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",p).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),h=r(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,a).getRegex(),g="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",m=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,f=r("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",m).replace("tag",g).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),y=r(u).replace("hr",o).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",g).getRegex(),k={blockquote:r(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",y).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:d,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:o,html:f,lheading:l,list:h,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:y,table:n,text:/^[^\n]+/},b=r("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",o).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",g).getRegex(),x={...k,lheading:c,table:b,paragraph:r(u).replace("hr",o).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",b).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",g).getRegex()},w={...k,html:r("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",m).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:n,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:r(u).replace("hr",o).replace("heading"," *#{1,6} *[^\n]").replace("lheading",l).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},v=/^( {2,}|\\)\n(?!\s*$)/,E=/[\p{P}\p{S}]/u,S=/[\s\p{P}\p{S}]/u,I=/[^\s\p{P}\p{S}]/u,B=r(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,S).getRegex(),z=/(?!~)[\p{P}\p{S}]/u,T=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,L=r(T,"u").replace(/punct/g,E).getRegex(),R=r(T,"u").replace(/punct/g,z).getRegex(),$="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",A=r($,"gu").replace(/notPunctSpace/g,I).replace(/punctSpace/g,S).replace(/punct/g,E).getRegex(),_=r($,"gu").replace(/notPunctSpace/g,/(?:[^\s\p{P}\p{S}]|~)/u).replace(/punctSpace/g,/(?!~)[\s\p{P}\p{S}]/u).replace(/punct/g,z).getRegex(),P=r("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,I).replace(/punctSpace/g,S).replace(/punct/g,E).getRegex(),O=r(/\\(punct)/,"gu").replace(/punct/g,E).getRegex(),C=r(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),j=r(m).replace("(?:--\x3e|$)","--\x3e").getRegex(),M=r("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",j).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),N=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,q=r(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",N).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),H=r(/^!?\[(label)\]\[(ref)\]/).replace("label",N).replace("ref",p).getRegex(),D=r(/^!?\[(ref)\](?:\[\])?/).replace("ref",p).getRegex(),F={_backpedal:n,anyPunctuation:O,autolink:C,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:v,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:n,emStrongLDelim:L,emStrongRDelimAst:A,emStrongRDelimUnd:P,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:q,nolink:D,punctuation:B,reflink:H,reflinkSearch:r("reflink|nolink(?!\\()","g").replace("reflink",H).replace("nolink",D).getRegex(),tag:M,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:n},G={...F,link:r(/^!?\[(label)\]\((.*?)\)/).replace("label",N).getRegex(),reflink:r(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",N).getRegex()},J={...F,emStrongRDelimAst:_,emStrongLDelim:R,url:r(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Z={...J,br:r(v).replace("{2,}","*").getRegex(),text:r(J.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},K={normal:k,gfm:x,pedantic:w},Y={normal:F,gfm:J,breaks:Z,pedantic:G},Q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U=e=>Q[e];function W(e,t){if(t){if(s.escapeTest.test(e))return e.replace(s.escapeReplace,U)}else if(s.escapeTestNoEncode.test(e))return e.replace(s.escapeReplaceNoEncode,U);return e}function X(e){try{e=encodeURI(e).replace(s.percentDecode,"%")}catch{return null}return e}function V(e,t){const n=e.replace(s.findPipe,((e,t,n)=>{let r=!1,s=t;for(;--s>=0&&"\\"===n[s];)r=!r;return r?"|":" |"})).split(s.splitPipe);let r=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(s.slashPipe,"|");return n}function ee(e,t,n){const r=e.length;if(0===r)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function te(e,t,n,r,s){const o=t.href,a=t.title||null,i=e[1].replace(s.other.outputLinkReplace,"$1");if("!"!==e[0].charAt(0)){r.state.inLink=!0;const e={type:"link",raw:n,href:o,title:a,text:i,tokens:r.inlineTokens(i)};return r.state.inLink=!1,e}return{type:"image",raw:n,href:o,title:a,text:i}}class ne{options;rules;lexer;constructor(t){this.options=t||e}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:ee(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],n=function(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(null===r)return t;const s=r[1];return t.split("\n").map((e=>{const t=e.match(n.other.beginningSpace);if(null===t)return e;const[r]=t;return r.length>=s.length?e.slice(s.length):e})).join("\n")}(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){const t=ee(e,"#");this.options.pedantic?e=t.trim():t&&!this.rules.other.endingSpaceChar.test(t)||(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:ee(t[0],"\n")}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let e=ee(t[0],"\n").split("\n"),n="",r="";const s=[];for(;e.length>0;){let t=!1;const o=[];let a;for(a=0;a<e.length;a++)if(this.rules.other.blockquoteStart.test(e[a]))o.push(e[a]),t=!0;else{if(t)break;o.push(e[a])}e=e.slice(a);const i=o.join("\n"),l=i.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}\n${i}`:i,r=r?`${r}\n${l}`:l;const c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(l,s,!0),this.lexer.state.top=c,0===e.length)break;const u=s.at(-1);if("code"===u?.type)break;if("blockquote"===u?.type){const t=u,o=t.raw+"\n"+e.join("\n"),a=this.blockquote(o);s[s.length-1]=a,n=n.substring(0,n.length-t.raw.length)+a.raw,r=r.substring(0,r.length-t.text.length)+a.text;break}if("list"!==u?.type);else{const t=u,o=t.raw+"\n"+e.join("\n"),a=this.list(o);s[s.length-1]=a,n=n.substring(0,n.length-u.raw.length)+a.raw,r=r.substring(0,r.length-t.raw.length)+a.raw,e=o.substring(s.at(-1).raw.length).split("\n")}}return{type:"blockquote",raw:n,tokens:s,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const o=this.rules.other.listItemRegex(n);let a=!1;for(;e;){let n=!1,r="",i="";if(!(t=o.exec(e)))break;if(this.rules.block.hr.test(e))break;r=t[0],e=e.substring(r.length);let l=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,(e=>" ".repeat(3*e.length))),c=e.split("\n",1)[0],u=!l.trim(),p=0;if(this.options.pedantic?(p=2,i=l.trimStart()):u?p=t[1].length+1:(p=t[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,i=l.slice(p),p+=t[1].length),u&&this.rules.other.blankLine.test(c)&&(r+=c+"\n",e=e.substring(c.length+1),n=!0),!n){const t=this.rules.other.nextBulletRegex(p),n=this.rules.other.hrRegex(p),s=this.rules.other.fencesBeginRegex(p),o=this.rules.other.headingBeginRegex(p),a=this.rules.other.htmlBeginRegex(p);for(;e;){const d=e.split("\n",1)[0];let h;if(c=d,this.options.pedantic?(c=c.replace(this.rules.other.listReplaceNesting,"  "),h=c):h=c.replace(this.rules.other.tabCharGlobal,"    "),s.test(c))break;if(o.test(c))break;if(a.test(c))break;if(t.test(c))break;if(n.test(c))break;if(h.search(this.rules.other.nonSpaceChar)>=p||!c.trim())i+="\n"+h.slice(p);else{if(u)break;if(l.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4)break;if(s.test(l))break;if(o.test(l))break;if(n.test(l))break;i+="\n"+c}u||c.trim()||(u=!0),r+=d+"\n",e=e.substring(d.length+1),l=h.slice(p)}}s.loose||(a?s.loose=!0:this.rules.other.doubleBlankLine.test(r)&&(a=!0));let d,h=null;this.options.gfm&&(h=this.rules.other.listIsTask.exec(i),h&&(d="[ ] "!==h[0],i=i.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:r,task:!!h,checked:d,loose:!1,text:i,tokens:[]}),s.raw+=r}const i=s.items.at(-1);if(!i)return;i.raw=i.raw.trimEnd(),i.text=i.text.trimEnd(),s.raw=s.raw.trimEnd();for(let e=0;e<s.items.length;e++)if(this.lexer.state.top=!1,s.items[e].tokens=this.lexer.blockTokens(s.items[e].text,[]),!s.loose){const t=s.items[e].tokens.filter((e=>"space"===e.type)),n=t.length>0&&t.some((e=>this.rules.other.anyLine.test(e.raw)));s.loose=n}if(s.loose)for(let e=0;e<s.items.length;e++)s.items[e].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:r}}}table(e){const t=this.rules.block.table.exec(e);if(!t)return;if(!this.rules.other.tableDelimiter.test(t[2]))return;const n=V(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const e of r)this.rules.other.tableAlignRight.test(e)?o.align.push("right"):this.rules.other.tableAlignCenter.test(e)?o.align.push("center"):this.rules.other.tableAlignLeft.test(e)?o.align.push("left"):o.align.push(null);for(let e=0;e<n.length;e++)o.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:o.align[e]});for(const e of s)o.rows.push(V(e,o.header.length).map(((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:o.align[t]}))));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;const t=ee(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let n=0;for(let r=0;r<e.length;r++)if("\\"===e[r])r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return-1}(t[2],"()");if(e>-1){const n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){const e=this.rules.other.pedanticHrefTitle.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(n=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?n.slice(1):n.slice(1,-1)),te(t,{href:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n,title:r?r.replace(this.rules.inline.anyPunctuation,"$1"):r},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const e=t[(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!e){const e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return te(n,e,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(r&&(!r[3]||!n.match(this.rules.other.unicodeAlphaNumeric))&&(!r[1]&&!r[2]||!n||this.rules.inline.punctuation.exec(n))){const n=[...r[0]].length-1;let s,o,a=n,i=0;const l="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+n);null!=(r=l.exec(t));){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(o=[...s].length,r[3]||r[4]){a+=o;continue}if((r[5]||r[6])&&n%3&&!((n+o)%3)){i+=o;continue}if(a-=o,a>0)continue;o=Math.min(o,o+a+i);const t=[...r[0]][0].length,l=e.slice(0,n+r.index+t+o);if(Math.min(n,o)%2){const e=l.slice(1,-1);return{type:"em",raw:l,text:e,tokens:this.lexer.inlineTokens(e)}}const c=l.slice(2,-2);return{type:"strong",raw:l,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," ");const n=this.rules.other.nonSpaceChar.test(e),r=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return n&&r&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let e,n;return"@"===t[2]?(e=t[1],n="mailto:"+e):(e=t[1],n=e),{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,n;if("@"===t[2])e=t[0],n="mailto:"+e;else{let r;do{r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(r!==t[0]);e=t[0],n="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}}class re{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||e,this.options.tokenizer=this.options.tokenizer||new ne,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:s,block:K.normal,inline:Y.normal};this.options.pedantic?(n.block=K.pedantic,n.inline=Y.pedantic):this.options.gfm&&(n.block=K.gfm,this.options.breaks?n.inline=Y.breaks:n.inline=Y.gfm),this.tokenizer.rules=n}static get rules(){return{block:K,inline:Y}}static lex(e,t){return new re(t).lex(e)}static lexInline(e,t){return new re(t).inlineTokens(e)}lex(e){e=e.replace(s.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){for(this.options.pedantic&&(e=e.replace(s.tabCharGlobal,"    ").replace(s.spaceLine,""));e;){let r;if(this.options.extensions?.block?.some((n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))continue;if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length);const n=t.at(-1);1===r.raw.length&&void 0!==n?n.raw+="\n":t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length);const n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue.at(-1).src=n.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length);const n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.raw,this.inlineQueue.at(-1).src=n.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}let s=e;if(this.options.extensions?.startBlock){let t=1/0;const n=e.slice(1);let r;this.options.extensions.startBlock.forEach((e=>{r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(s=e.substring(0,t+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){const o=t.at(-1);n&&"paragraph"===o?.type?(o.raw+="\n"+r.raw,o.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):t.push(r),n=s.length!==e.length,e=e.substring(r.raw.length)}else if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length);const n=t.at(-1);"text"===n?.type?(n.raw+="\n"+r.raw,n.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=n.text):t.push(r)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n=e,r=null;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(r=this.tokenizer.rules.inline.reflinkSearch.exec(n));)e.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(r=this.tokenizer.rules.inline.blockSkip.exec(n));)n=n.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(r=this.tokenizer.rules.inline.anyPunctuation.exec(n));)n=n.slice(0,r.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let s=!1,o="";for(;e;){let r;if(s||(o=""),s=!1,this.options.extensions?.inline?.some((n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0))))continue;if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length);const n=t.at(-1);"text"===r.type&&"text"===n?.type?(n.raw+=r.raw,n.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,n,o)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}let a=e;if(this.options.extensions?.startInline){let t=1/0;const n=e.slice(1);let r;this.options.extensions.startInline.forEach((e=>{r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(a=e.substring(0,t+1))}if(r=this.tokenizer.inlineText(a)){e=e.substring(r.raw.length),"_"!==r.raw.slice(-1)&&(o=r.raw.slice(-1)),s=!0;const n=t.at(-1);"text"===n?.type?(n.raw+=r.raw,n.text+=r.text):t.push(r)}else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return t}}class se{options;parser;constructor(t){this.options=t||e}space(e){return""}code({text:e,lang:t,escaped:n}){const r=(t||"").match(s.notSpaceStart)?.[0],o=e.replace(s.endingNewline,"")+"\n";return r?'<pre><code class="language-'+W(r)+'">'+(n?o:W(o,!0))+"</code></pre>\n":"<pre><code>"+(n?o:W(o,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){const t=e.ordered,n=e.start;let r="";for(let t=0;t<e.items.length;t++){const n=e.items[t];r+=this.listitem(n)}const s=t?"ol":"ul";return"<"+s+(t&&1!==n?' start="'+n+'"':"")+">\n"+r+"</"+s+">\n"}listitem(e){let t="";if(e.task){const n=this.checkbox({checked:!!e.checked});e.loose?"paragraph"===e.tokens[0]?.type?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=n+" "+W(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):t+=n+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",n="";for(let t=0;t<e.header.length;t++)n+=this.tablecell(e.header[t]);t+=this.tablerow({text:n});let r="";for(let t=0;t<e.rows.length;t++){const s=e.rows[t];n="";for(let e=0;e<s.length;e++)n+=this.tablecell(s[e]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+r+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${W(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),s=X(e);if(null===s)return r;let o='<a href="'+(e=s)+'"';return t&&(o+=' title="'+W(t)+'"'),o+=">"+r+"</a>",o}image({href:e,title:t,text:n}){const r=X(e);if(null===r)return W(n);let s=`<img src="${e=r}" alt="${n}"`;return t&&(s+=` title="${W(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:W(e.text)}}class oe{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class ae{options;renderer;textRenderer;constructor(t){this.options=t||e,this.options.renderer=this.options.renderer||new se,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new oe}static parse(e,t){return new ae(t).parse(e)}static parseInline(e,t){return new ae(t).parseInline(e)}parse(e,t=!0){let n="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions?.renderers?.[s.type]){const e=s,t=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==t||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(e.type)){n+=t||"";continue}}const o=s;switch(o.type){case"space":n+=this.renderer.space(o);continue;case"hr":n+=this.renderer.hr(o);continue;case"heading":n+=this.renderer.heading(o);continue;case"code":n+=this.renderer.code(o);continue;case"table":n+=this.renderer.table(o);continue;case"blockquote":n+=this.renderer.blockquote(o);continue;case"list":n+=this.renderer.list(o);continue;case"html":n+=this.renderer.html(o);continue;case"paragraph":n+=this.renderer.paragraph(o);continue;case"text":{let s=o,a=this.renderer.text(s);for(;r+1<e.length&&"text"===e[r+1].type;)s=e[++r],a+="\n"+this.renderer.text(s);n+=t?this.renderer.paragraph({type:"paragraph",raw:a,text:a,tokens:[{type:"text",raw:a,text:a,escaped:!0}]}):a;continue}default:{const e='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}parseInline(e,t=this.renderer){let n="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions?.renderers?.[s.type]){const e=this.options.extensions.renderers[s.type].call({parser:this},s);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=e||"";continue}}const o=s;switch(o.type){case"escape":case"text":n+=t.text(o);break;case"html":n+=t.html(o);break;case"link":n+=t.link(o);break;case"image":n+=t.image(o);break;case"strong":n+=t.strong(o);break;case"em":n+=t.em(o);break;case"codespan":n+=t.codespan(o);break;case"br":n+=t.br(o);break;case"del":n+=t.del(o);break;default:{const e='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}}class ie{options;block;constructor(t){this.options=t||e}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?re.lex:re.lexInline}provideParser(){return this.block?ae.parse:ae.parseInline}}const le=new class{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=ae;Renderer=se;TextRenderer=oe;Lexer=re;Tokenizer=ne;Hooks=ie;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(const r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{const e=r;for(const r of e.header)n=n.concat(this.walkTokens(r.tokens,t));for(const r of e.rows)for(const e of r)n=n.concat(this.walkTokens(e.tokens,t));break}case"list":{const e=r;n=n.concat(this.walkTokens(e.items,t));break}default:{const e=r;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach((r=>{const s=e[r].flat(1/0);n=n.concat(this.walkTokens(s,t))})):e.tokens&&(n=n.concat(this.walkTokens(e.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach((e=>{const n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){const n=t.renderers[e.name];t.renderers[e.name]=n?function(...t){let r=e.renderer.apply(this,t);return!1===r&&(r=n.apply(this,t)),r}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");const n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)})),n.extensions=t),e.renderer){const t=this.defaults.renderer||new se(this.defaults);for(const n in e.renderer){if(!(n in t))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;const r=n,s=e.renderer[r],o=t[r];t[r]=(...e)=>{let n=s.apply(t,e);return!1===n&&(n=o.apply(t,e)),n||""}}n.renderer=t}if(e.tokenizer){const t=this.defaults.tokenizer||new ne(this.defaults);for(const n in e.tokenizer){if(!(n in t))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;const r=n,s=e.tokenizer[r],o=t[r];t[r]=(...e)=>{let n=s.apply(t,e);return!1===n&&(n=o.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){const t=this.defaults.hooks||new ie;for(const n in e.hooks){if(!(n in t))throw new Error(`hook '${n}' does not exist`);if(["options","block"].includes(n))continue;const r=n,s=e.hooks[r],o=t[r];ie.passThroughHooks.has(n)?t[r]=e=>{if(this.defaults.async)return Promise.resolve(s.call(t,e)).then((e=>o.call(t,e)));const n=s.call(t,e);return o.call(t,n)}:t[r]=(...e)=>{let n=s.apply(t,e);return!1===n&&(n=o.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){const t=this.defaults.walkTokens,r=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(r.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}})),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return re.lex(e,t??this.defaults)}parser(e,t){return ae.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{const r={...n},s={...this.defaults,...r},o=this.onError(!!s.silent,!!s.async);if(!0===this.defaults.async&&!1===r.async)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(null==t)return o(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=e);const a=s.hooks?s.hooks.provideLexer():e?re.lex:re.lexInline,i=s.hooks?s.hooks.provideParser():e?ae.parse:ae.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(t):t).then((e=>a(e,s))).then((e=>s.hooks?s.hooks.processAllTokens(e):e)).then((e=>s.walkTokens?Promise.all(this.walkTokens(e,s.walkTokens)).then((()=>e)):e)).then((e=>i(e,s))).then((e=>s.hooks?s.hooks.postprocess(e):e)).catch(o);try{s.hooks&&(t=s.hooks.preprocess(t));let e=a(t,s);s.hooks&&(e=s.hooks.processAllTokens(e)),s.walkTokens&&this.walkTokens(e,s.walkTokens);let n=i(e,s);return s.hooks&&(n=s.hooks.postprocess(n)),n}catch(e){return o(e)}}}onError(e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const e="<p>An error occurred:</p><pre>"+W(n.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}};function ce(e,t){return le.parse(e,t)}function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function pe(){pe=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,s=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof y?t:y,a=Object.create(o.prototype),i=new R(r||[]);return s(a,"_invoke",{value:B(e,n,i)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",h="suspendedYield",g="executing",m="completed",f={};function y(){}function k(){}function b(){}var x={};c(x,a,(function(){return this}));var w=Object.getPrototypeOf,v=w&&w(w($([])));v&&v!==n&&r.call(v,a)&&(x=v);var E=b.prototype=y.prototype=Object.create(x);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(s,o,a,i){var l=p(e[s],e,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==ue(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,i)}))}i(l.arg)}var o;s(this,"_invoke",{value:function(e,r){function s(){return new t((function(t,s){n(e,r,t,s)}))}return o=o?o.then(s,s):s()}})}function B(t,n,r){var s=d;return function(o,a){if(s===g)throw Error("Generator is already running");if(s===m){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var l=z(i,r);if(l){if(l===f)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(s===d)throw s=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);s=g;var c=p(t,n,r);if("normal"===c.type){if(s=r.done?m:h,c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(s=m,r.method="throw",r.arg=c.arg)}}}function z(t,n){var r=n.method,s=t.iterator[r];if(s===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,z(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=p(s,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,f;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function $(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var s=-1,o=function n(){for(;++s<t.length;)if(r.call(t,s))return n.value=t[s],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(ue(t)+" is not iterable")}return k.prototype=b,s(E,"constructor",{value:b,configurable:!0}),s(b,"constructor",{value:k,configurable:!0}),k.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},S(I.prototype),c(I.prototype,i,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,r,s,o){void 0===o&&(o=Promise);var a=new I(u(e,n,r,s),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(E),c(E,l,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=$,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function s(r,s){return i.type="throw",i.arg=t,n.next=r,s&&(n.method="next",n.arg=e),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return s("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return s(a.catchLoc,!0);if(this.prev<a.finallyLoc)return s(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return s(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return s(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&r.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var s=r.arg;L(n)}return s}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:$(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),f}},t}function de(e,t,n,r,s,o,a){try{var i=e[o](a),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,s)}function he(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var o=e.apply(t,n);function a(e){de(o,r,s,a,i,"next",e)}function i(e){de(o,r,s,a,i,"throw",e)}a(void 0)}))}}ce.options=ce.setOptions=function(e){return le.setOptions(e),ce.defaults=le.defaults,t(ce.defaults),ce},ce.getDefaults=function(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},ce.defaults=e,ce.use=function(...e){return le.use(...e),ce.defaults=le.defaults,t(ce.defaults),ce},ce.walkTokens=function(e,t){return le.walkTokens(e,t)},ce.parseInline=le.parseInline,ce.Parser=ae,ce.parser=ae.parse,ce.Renderer=se,ce.TextRenderer=oe,ce.Lexer=re,ce.lexer=re.lex,ce.Tokenizer=ne,ce.Hooks=ie,ce.parse=ce,ce.options,ce.setOptions,ce.use,ce.walkTokens,ce.parseInline,ae.parse,re.lex;var ge={summarize:'You are an expert researcher. Your task is to review the provided research document and complete the following tasks with academic depth and varied sentence structures:\n\n1. Summarize the Research Background:\n   - Provide a concise yet comprehensive summary of the study\'s background, including its context and motivation.\n\n2. Extract the Problem Statement:\n   - Clearly identify and articulate the central problem or challenge addressed by the research.\n\n3. Identify Strengths:\n   - List 3–5 key strengths of the study, focusing on aspects such as methodology, innovation, robustness of results, or any other notable positive attributes.\n\n4. Identify Weaknesses:\n   - Enumerate 4–5 significant weaknesses or limitations present in the research, considering issues like methodological gaps, limited scope, or areas lacking clarity.\n\n5. Propose Research Topics:\n   - Based on the weaknesses identified, suggest three potential research topics that could address these limitations or explore related areas further.\n\n6. Include a "tl;dr" Section:\n   - At the very top of your response, provide a succinct "tl;dr" summary without any syntax highlighting that encapsulates the main points and any necessary takeaways.\n\nDo not include any extraneous messages, introductions, or commentary. Your final output should strictly adhere to these instructions.\n\nSubject: {subject}\nContent:\n{content}',translate:"You are an expert translator and interpreter with extensive proficiency in various languages, specializing in translating texts into polished, academic Korean. Your task is to translate the provided text from the source language into Korean, ensuring that every nuance, stylistic detail, and analytical aspect is accurately and naturally conveyed. Please follow these guidelines:\n\nPreserve Nuance and Style:\n- Accurately reflect the original text's tone, emotional nuance, and stylistic characteristics in Korean.\n- Adapt idiomatic expressions, metaphors, and culturally specific references to ensure they resonate with Korean readers.\n\nMaintain Analytical Precision:\n- Carefully dissect complex sentences and ideas, ensuring that your translation maintains the original text's logical flow and depth of analysis.\n- Where necessary, integrate brief annotations or contextual clarifications to help convey any cultural or conceptual subtleties.\n\nEnsure Accuracy and Consistency:\n- Translate specialized vocabulary, technical terms, and academic language with precision and maintain consistency throughout the text.\n- Verify that the structure and argumentative progression of the source material are preserved in the Korean version.\n\nUphold Contextual Integrity:\n- Ensure that the overall message and intent of the original text are fully maintained in your translation.\n- Make sure that transitions between ideas and sections remain coherent and logically connected in Korean.\n\nReview and Refine:\n- Reassess your translation for any potential ambiguities or loss of nuance, refining as necessary to enhance clarity and precision.\n- Strive for a balanced outcome that honors the original text while ensuring the translation is engaging and accessible to a Korean audience.\n\nProvide tl;dr at the top:\nWrite a tl;dr section at the top of your response that summarizes the main points and todos if needed.\n\nDeliver your final translation in refined, academic Korean that faithfully embodies the original text's analytical and stylistic essence.\n\nSubject: {subject}\n\nContent:\n{content}",translateSummarize:"You are an expert translator and summarizer with extensive proficiency in various languages, specializing in translating texts into polished, academic Korean. Your task is to translate the provided text from the source language into Korean AND create a concise summary of the main points. Please follow these guidelines:\n\nTranslation Aspects:\n- Accurately reflect the original text's tone, emotional nuance, and stylistic characteristics in Korean.\n- Adapt idiomatic expressions, metaphors, and culturally specific references to ensure they resonate with Korean readers.\n- Maintain analytical precision and logical flow in the Korean translation.\n\nSummarization Requirements:\n- Create a concise and focused summary of the key points in Korean.\n- Prioritize clarity and brevity while maintaining the essential meaning.\n- Ensure the summary captures the main ideas, arguments, and conclusions.\n- Limit the summary to approximately 30-40% of the original length.\n\nFinal Delivery Format:\n1. First provide tl;dr at the top:\nWrite a tl;dr section at the top of your response that summarizes the main points and todos if needed.\n2. Then provide a concise summary section (제목: 요약)\n3. Then provide the full translation (제목: 전체 번역)\n\nSubject: {subject}\n\nContent:\n{content}",reply:"You are an expert assistant that can help me with my email. I will provide you with the email content and you will help me with the following tasks:\n\n  Write a reply to the email.\n\n  Subject: {subject}\n\n  Content:\n  {content}\n  in {language}",tldrPrompt:"Please provide a very concise summary in {language} of the following content. Focus on the main points and key takeaways. Do not include any extraneous messages, introductions, or commentary. Your final output should strictly adhere to these instructions.\n\n  Subject: {subject}\n\n  Content:\n  {content}"};function me(){var e=document.getElementById("settings-dropdown");if(e){var t="block"===e.style.display;e.style.display=t?"none":"block"}}function fe(){var e=localStorage.getItem("theme")||"dark";if("light"===e)document.body.setAttribute("data-theme","light"),document.body.classList.remove("dark-theme");else if("dark"===e)document.body.setAttribute("data-theme","dark"),document.body.classList.add("dark-theme");else if(Office.context.officeTheme){var t=Office.context.officeTheme.bodyBackgroundColor;t&&!function(e){if(!e||"string"!=typeof e)return!1;try{e=e.replace("#","");var t=parseInt(e.substr(0,2),16),n=parseInt(e.substr(2,2),16),r=parseInt(e.substr(4,2),16);return!(isNaN(t)||isNaN(n)||isNaN(r))&&.299*t+.587*n+.114*r<128}catch(e){return console.error("Error calculating theme brightness:",e),!1}}(t)?(document.body.setAttribute("data-theme","light"),document.body.classList.remove("dark-theme")):(document.body.setAttribute("data-theme","dark"),document.body.classList.add("dark-theme"))}}function ye(e){"system"===(localStorage.getItem("theme")||"system")&&fe()}function ke(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.getElementById("notification");n&&n.remove();var r=document.createElement("div");r.id="notification",r.className="notification ".concat(t),r.textContent=e,document.body.appendChild(r),r.offsetHeight,r.style.animation="slideInFromTop 0.3s ease-out",setTimeout((function(){r.style.animation="slideOutToTop 0.3s ease-out",setTimeout((function(){r.remove()}),300)}),3e3)}function be(){var e={};try{var t=localStorage.getItem("michael_settings");t&&(e=JSON.parse(t))}catch(e){console.error("Error parsing settings:",e)}var n=document.getElementById("dropdown-api-key").value,r=document.getElementById("dropdown-model").value,s=document.getElementById("dropdown-language").value,o=document.getElementById("dropdown-theme").value,a=document.getElementById("dropdown-font-size").value,i=document.getElementById("dropdown-tldr-mode").value,l=document.getElementById("dropdown-show-reply").value,c=document.getElementById("dropdown-reply-model").value,u=document.getElementById("dropdown-autorun").value,p=document.getElementById("dropdown-autorun-option").value,d=document.getElementById("dropdown-dev-mode").value,h=document.getElementById("dropdown-dev-server").value,g=document.getElementById("dropdown-summarize-template").value,m=document.getElementById("dropdown-translate-template").value,f=document.getElementById("dropdown-translate-summarize-template").value;e.apiKey=n,e.model=r,e.defaultLanguage=s,e.theme=o,e.fontSize=a,e.tldrMode=i,e.showReply=l,e.replyModel=c,e.autorun=u,e.autorunOption=p,e.devMode=d,e.devServer=h,e.templates||(e.templates={}),e.templates.summarize=g,e.templates.translate=m,e.templates.translateSummarize=f,localStorage.setItem("michael_settings",JSON.stringify(e)),localStorage.setItem("theme",o),fe(),we(a),Fe("true"===l),We("true"===d),ke("All settings saved successfully"),me()}function xe(){document.getElementById("dropdown-summarize-template").value=ge.summarize,document.getElementById("dropdown-translate-template").value=ge.translate,document.getElementById("dropdown-translate-summarize-template")&&(document.getElementById("dropdown-translate-summarize-template").value=ge.translateSummarize),ke("Templates reset to defaults")}function we(e){document.documentElement.setAttribute("data-font-size",e||"medium")}function ve(){return Ee.apply(this,arguments)}function Ee(){return(Ee=he(pe().mark((function e(){return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){Office.context.mailbox.item.body.getAsync("text",(function(n){n.status===Office.AsyncResultStatus.Succeeded?e(n.value):t(new Error("Failed to get email content"))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(e,t){return Ie.apply(this,arguments)}function Ie(){return Ie=he(pe().mark((function e(t,n){var r,s,o,a,i,l,c,u,p,d,h=arguments;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=h.length>3&&void 0!==h[3]&&h[3],o="gemini-2.0-flash-light",r=h.length>2&&void 0!==h[2]?h[2]:null)o=r;else try{(a=localStorage.getItem("michael_settings"))&&(i=JSON.parse(a)).model&&(o=i.model)}catch(e){console.error("Error getting model from settings:",e)}return l="https://generativelanguage.googleapis.com/v1beta/models/".concat(o,":generateContent?key=").concat(n),e.prev=5,e.next=8,fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:t}]}],generationConfig:{temperature:.4,topK:32,topP:.95,maxOutputTokens:s?800:8192}})});case 8:return c=e.sent,e.next=11,c.json();case 11:if(u=e.sent,c.ok){e.next=14;break}throw new Error((null===(p=u.error)||void 0===p?void 0:p.message)||"Error generating content");case 14:if(u.candidates&&0!==u.candidates.length){e.next=16;break}throw new Error("No content generated");case 16:return d=u.candidates[0].content.parts[0].text,e.abrupt("return",d);case 20:throw e.prev=20,e.t0=e.catch(5),console.error("Error generating content:",e.t0),e.t0;case 24:return e.prev=24,s||(document.getElementById("loading").style.display="none"),e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[5,20,24,27]])}))),Ie.apply(this,arguments)}function Be(e,t){return ze.apply(this,arguments)}function ze(){return ze=he(pe().mark((function e(t,n){var r,s,o,a,i,l,c=arguments;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:"Korean",s=c.length>3&&void 0!==c[3]?c[3]:null,o=Office.context.mailbox.item.subject,e.next=5,ve();case 5:return a=e.sent,i=ge.tldrPrompt.replace("{subject}",o).replace("{content}",a).replace("{language}",r),e.next=9,Se(i,n,s,!0);case 9:return l=e.sent,e.abrupt("return",l);case 11:case"end":return e.stop()}}),e)}))),ze.apply(this,arguments)}function Te(e){switch(e){case"es":return"Spanish";case"fr":return"French";case"de":return"German";case"it":return"Italian";case"ja":return"Japanese";case"ko":return"Korean";case"zh_cn":return"Chinese";default:return"English"}}function Le(){var e=localStorage.getItem("michael_settings");return e?JSON.parse(e).apiKey:null}function Re(){try{var e=localStorage.getItem("michael_settings");if(e){var t=JSON.parse(e);if(t.defaultLanguage)return t.defaultLanguage}return"ko"}catch(e){return console.error("Error getting language:",e),"ko"}}function $e(){return Ae.apply(this,arguments)}function Ae(){return(Ae=he(pe().mark((function e(){var t,n,r,s,o,a,i,l,c,u,p;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Le()){e.next=5;break}return ke("Please add your Gemini API key in the settings","error"),me(),e.abrupt("return");case 5:return Ne("Summarizing email..."),e.prev=6,e.next=9,ve();case 9:n=e.sent,r=Office.context.mailbox.item.subject,s=ge.summarize;try{(o=localStorage.getItem("michael_settings"))&&(a=JSON.parse(o)).templates&&a.templates.summarize&&(s=a.templates.summarize)}catch(e){console.error("Error getting template:",e)}i=s.replace("{subject}",r).replace("{content}",n),l=!0;try{(c=localStorage.getItem("michael_settings"))&&(u=JSON.parse(c)).tldrMode&&(l="true"===u.tldrMode)}catch(e){console.error("Error getting TLDR mode setting:",e)}if(!l){e.next=29;break}return e.next=19,Be(i,t,"English");case 19:return p=e.sent,qe(),He(p,0),e.next=24,Se(i,t);case 24:De(e.sent),Oe(!0),e.next=33;break;case 29:return e.next=31,Se(i,t);case 31:He(e.sent,0);case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(6),ke("Error: ".concat(e.t0.message),"error");case 38:case"end":return e.stop()}}),e,null,[[6,35]])})))).apply(this,arguments)}function _e(){return Pe.apply(this,arguments)}function Pe(){return(Pe=he(pe().mark((function e(){var t,n,r,s,o,a,i,l,c,u,p,d;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Le(),n=Re(),t){e.next=6;break}return ke("Please add your Gemini API key in the settings","error"),me(),e.abrupt("return");case 6:return Ne("Translating to "+Te(n)+"..."),e.prev=7,e.next=10,ve();case 10:r=e.sent,s=Office.context.mailbox.item.subject,o=ge.translate;try{(a=localStorage.getItem("michael_settings"))&&(i=JSON.parse(a)).templates&&i.templates.translate&&(o=i.templates.translate)}catch(e){console.error("Error getting template:",e)}l=o.replace("{subject}",s).replace("{content}",r),c=!0;try{(u=localStorage.getItem("michael_settings"))&&(p=JSON.parse(u)).tldrMode&&(c="true"===p.tldrMode)}catch(e){console.error("Error getting TLDR mode setting:",e)}if(!c){e.next=30;break}return e.next=20,Be(l,t,n);case 20:return d=e.sent,qe(),He(d,1),e.next=25,Se(l,t);case 25:De(e.sent),Oe(!0),e.next=34;break;case 30:return e.next=32,Se(l,t,n);case 32:He(e.sent,1);case 34:e.next=39;break;case 36:e.prev=36,e.t0=e.catch(7),ke("Error: ".concat(e.t0.message),"error");case 39:case"end":return e.stop()}}),e,null,[[7,36]])})))).apply(this,arguments)}function Oe(e){var t=document.getElementById("expand-content");t&&(t.disabled=!e,t.classList.toggle("ms-Button--disabled",!e),t.innerHTML=e?"Show Full Content":"Hide Full Content",t.classList.toggle("ms-Button--primary",e))}function Ce(){var e="",t=document.getElementById("tldr-content").innerText,n=document.getElementById("result-content").innerText;if(t.includes("Subject:")||n.includes("Subject:")){var r="",s="",o=/^(?:Subject:\s*)?(.+?)(?:\n|$)/i.exec(t);o&&(r=o[1].trim()),s="none"!==document.getElementById("full-content-container").style.display?n:o?t.split("\n").slice(1).join("\n").trim():t,e="Subject: ".concat(r,"\n\n").concat(s)}else e="none"!==document.getElementById("full-content-container").style.display?n:t;navigator.clipboard.writeText(e).then((function(){var e=document.getElementById("copy-status");e.textContent="Copied!",setTimeout((function(){e.textContent=""}),2e3)})).catch((function(e){console.error("Could not copy text: ",e),ke("Failed to copy to clipboard","error")}))}function je(){return Me.apply(this,arguments)}function Me(){return(Me=he(pe().mark((function e(){var t,n,r,s,o,a,i,l,c,u,p,d;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Le()){e.next=5;break}return ke("Please add your Gemini API key in the settings","error"),me(),e.abrupt("return");case 5:return Ne("Translating and summarizing..."),e.prev=6,e.next=9,ve();case 9:n=e.sent,r=Office.context.mailbox.item.subject,s="English",o=ge.translateSummarize;try{(a=localStorage.getItem("michael_settings"))&&((i=JSON.parse(a)).templates&&i.templates.translateSummarize&&(o=i.templates.translateSummarize),i.language&&(s=i.language))}catch(e){console.error("Error getting template:",e)}l=o.replace("{subject}",r).replace("{content}",n).replace("{language}",s),c=!0;try{(u=localStorage.getItem("michael_settings"))&&(p=JSON.parse(u)).tldrMode&&(c="true"===p.tldrMode)}catch(e){console.error("Error getting TLDR mode setting:",e)}if(!c){e.next=30;break}return e.next=20,Be(l,t);case 20:return d=e.sent,qe(),He(d,2),e.next=25,Se(l,t);case 25:De(e.sent),Oe(!0),e.next=34;break;case 30:return e.next=32,Se(l,t);case 32:He(e.sent,2);case 34:e.next=39;break;case 36:e.prev=36,e.t0=e.catch(6),ke("Error: ".concat(e.t0.message),"error");case 39:case"end":return e.stop()}}),e,null,[[6,36]])})))).apply(this,arguments)}function Ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...";document.getElementById("loading").style.display="block",document.getElementById("loading-message").textContent=e,document.getElementById("landing-screen").style.display="none",document.getElementById("result-section").style.display="none"}function qe(){var e=document.getElementById("loading");e&&(e.style.display="none")}function He(e,t){document.getElementById("result-content").innerHTML="",document.getElementById("tldr-content").innerHTML="";var n=document.getElementById("expand-content");n&&(n.disabled=!0,n.classList.add("ms-Button--disabled"),n.innerHTML='<span class="ms-Button-label">Show Full Content</span>',n.classList.remove("ms-Button--primary")),document.getElementById("loading").style.display="none",document.getElementById("result-section").style.display="block",document.getElementById("landing-screen").style.display="none",document.getElementById("app-body").style.display="block";var r=!0;try{var s=localStorage.getItem("michael_settings");if(s){var o=JSON.parse(s);o.tldrMode&&(r="true"===o.tldrMode)}}catch(e){console.error("Error getting TLDR mode setting:",e)}if(r){document.getElementById("tldr-content").innerHTML=ce.parse(e);var a=document.getElementById("expand-content");a&&(a.disabled=!0,a.classList.add("ms-Button--disabled"),a.innerHTML='<span class="ms-Button-label">Loading Full Content...</span>')}else{document.getElementById("tldr-content").innerHTML=ce.parse(e);var i=document.getElementById("result-content");i||((i=document.createElement("div")).id="result-content",document.getElementById("full-content-container").appendChild(i)),i.innerHTML=ce.parse(e),document.getElementById("full-content-container").style.display="block";var l=document.getElementById("expand-content");l&&(l.disabled=!1,l.classList.remove("ms-Button--disabled"),l.innerHTML='<span class="ms-Button-label">Show Full Content</span>',l.classList.add("ms-Button--primary"))}var c=document.getElementById("copy-reply");c&&(c.style.display=3===t?"inline-block":"none");var u=document.getElementById("copy-result");u&&(u.style.display=3===t?"none":"inline-block");var p=document.getElementById("generate-reply");if(p){var d=localStorage.getItem("michael_settings")&&"true"===JSON.parse(localStorage.getItem("michael_settings")).showReply;p.style.display=3===t?"none":d?"inline-block":"none"}try{var h=localStorage.getItem("michael_settings");if(h){var g=JSON.parse(h);g.fontSize&&we(g.fontSize),g.showReply&&Fe("true"===g.showReply)}}catch(e){console.error("Error applying font size:",e)}var m=document.getElementById("result-content"),f=document.getElementById("tldr-content");m&&(m.scrollTop=0),f&&(f.scrollTop=0)}function De(e){var t=document.getElementById("expand-content");t&&(t.disabled=!1,t.classList.remove("ms-Button--disabled"),t.innerHTML='<span class="ms-Button-label">Show Full Content</span>');var n=document.getElementById("loading-container");n&&n.remove();var r=document.getElementById("result-content");r&&(r.innerHTML=ce.parse(e))}function Fe(e){var t=document.getElementById("generate-reply");t&&(t.style.display=e?"inline-block":"none")}function Ge(){var e=document.getElementById("expand-content");if(!e.disabled){var t=document.getElementById("full-content-container");"none"===t.style.display?(t.style.display="block",e.innerHTML='<span class="ms-Button-label">Hide Full Content</span>',e.classList.remove("ms-Button--primary")):(t.style.display="none",e.innerHTML='<span class="ms-Button-label">Show Full Content</span>',e.classList.add("ms-Button--primary"))}}function Je(e){var t="",n="",r=e.match(/^(?:SUBJECT:|Subject:)\s*(.+?)(?:\n|$)/m);if(r)t=r[1].trim(),n=e.replace(/^(?:SUBJECT:|Subject:)\s*.+?\n+/m,"").trim();else{var s=e.trim().split("\n");s.length>0?(t=s[0].trim(),n=s.slice(1).join("\n").trim()):(t="Re: Your email",n=e.trim())}return{html:'\n    <div class="reply-container">\n      <div class="reply-subject">\n        <span class="reply-label">Subject:</span>'.concat(t,'\n      </div>\n      <div class="reply-body">').concat(n,"</div>\n    </div>\n  "),subject:t,body:n,raw:"Subject: ".concat(t,"\n\n").concat(n)}}function Ze(){return Ke.apply(this,arguments)}function Ke(){return(Ke=he(pe().mark((function e(){var t,n,r,s,o,a;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Le()){e.next=5;break}return ke("Please add your Gemini API key in the settings","error"),me(),e.abrupt("return");case 5:return Ne("Generating reply..."),e.prev=6,e.next=9,ve();case 9:return n=e.sent,r=Office.context.mailbox.item.subject,s='You are a professional email composer. Based on the following email content,\n    draft a concise, professional reply. The reply MUST include:\n\n    1. Start with "SUBJECT: " followed by an appropriate subject line, then a blank line\n    2. A professional, concise email body\n\n    Make the response clear, helpful, and to the point. Use a professional tone.\n\n    Email content to reply to:\n    Subject: '.concat(r,"\n\n    ").concat(n),e.next=14,Se(s,t);case 14:o=e.sent,a=Je(o),document.getElementById("tldr-content").innerHTML=a.html,document.getElementById("result-content").innerHTML=a.html,document.getElementById("result-section").style.display="block",document.getElementById("copy-reply").style.display="inline-block",document.getElementById("copy-result").style.display="none",e.next=26;break;case 23:e.prev=23,e.t0=e.catch(6),ke("Error: ".concat(e.t0.message),"error");case 26:return e.prev=26,qe(),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[6,23,26,29]])})))).apply(this,arguments)}function Ye(){return(Ye=he(pe().mark((function e(){var t,n,r,s;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=document.getElementById("settings-section"),n=document.getElementById("result-section"),r=document.getElementById("tldr-section"),t&&(t.style.display="none"),n&&(n.style.display="none"),r&&(r.style.display="none"),(s=Qe())&&(s.theme&&(o=s.theme,a=void 0,a=document.documentElement,"system"===o?window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?a.setAttribute("data-theme","dark"):a.setAttribute("data-theme","light"):a.setAttribute("data-theme",o)),s.fontSize&&(i=s.fontSize,document.documentElement.style.setProperty("--result-font-size",function(e){switch(e){case"small":return"0.875rem";case"medium":default:return"1rem";case"large":return"1.125rem"}}(i)))),Le()||ke("Please add your Gemini API key in settings","warning");case 10:case"end":return e.stop()}var o,a,i}),e)})))).apply(this,arguments)}function Qe(){try{var e=localStorage.getItem("michael_settings");if(e){var t=JSON.parse(e);Object.keys(t).forEach((function(e){var n=document.getElementById(e);n&&"SELECT"===n.tagName&&(n.value=t[e])}))}}catch(e){console.error("Error loading settings:",e)}}function Ue(){document.getElementById("dropdown-model").value="gemini-1.5-flash",document.getElementById("dropdown-language").value="ko",document.getElementById("dropdown-theme").value="system",document.getElementById("dropdown-font-size").value="medium",document.getElementById("dropdown-tldr-mode").value="true",document.getElementById("dropdown-show-reply").value="true",document.getElementById("dropdown-reply-model").value="gemini-2.0-flash-lite",document.getElementById("dropdown-autorun").value="false",document.getElementById("dropdown-autorun-option").value="summarize",document.getElementById("dropdown-dev-mode").value="false",document.getElementById("dropdown-dev-server").value="",document.getElementById("dev-server-group").style.display="none",xe(),document.getElementById("dropdown-api-key").value="",localStorage.removeItem("michael_settings"),fe(),we("medium"),Fe(!0),We(!1),ke("All settings reset to defaults","success")}function We(e){var t=document.getElementById("dev-badge"),n=document.getElementById("footer-dev-badge");t&&(t.style.display=e?"block":"none"),n&&(n.style.display=e?"block":"none")}Office.onReady((function(e){if(e.host===Office.HostType.Outlook){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",function(){Ye.apply(this,arguments)}();var t=!1,n=null;try{var r=localStorage.getItem("michael_settings");if(r){var s=JSON.parse(r);t="true"===s.autorun,n=s.autorunOption}}catch(e){console.error("Error getting autorun settings:",e)}if(t&&n)switch(n){case"summarize":$e();break;case"translate":_e();break;case"translateAndSummarize":je();break;case"reply":Ze()}document.getElementById("summarize").addEventListener("click",$e),document.getElementById("translate").addEventListener("click",_e),document.getElementById("translate-summarize").addEventListener("click",je),document.getElementById("settings-toggle").addEventListener("click",me),document.getElementById("dropdown-close-settings").addEventListener("click",me),document.getElementById("dropdown-save-settings").addEventListener("click",be),document.getElementById("dropdown-reset-all").addEventListener("click",Ue),document.getElementById("dropdown-api-key").addEventListener("keypress",(function(e){"Enter"===e.key&&be()})),document.getElementById("dropdown-dev-mode").addEventListener("change",(function(){document.getElementById("dev-server-group").style.display="true"===this.value?"block":"none"})),document.querySelectorAll(".settings-dropdown-container select").forEach((function(e){e.addEventListener("change",be)})),document.getElementById("expand-content").addEventListener("click",Ge),document.getElementById("copy-result").addEventListener("click",Ce),document.getElementById("generate-reply").addEventListener("click",Ze),function(){try{var e=localStorage.getItem("michael_settings");if(e){var t=JSON.parse(e);t.apiKey&&(document.getElementById("dropdown-api-key").value=t.apiKey),t.model&&(document.getElementById("dropdown-model").value=t.model),t.defaultLanguage&&(document.getElementById("dropdown-language").value=t.defaultLanguage),t.theme&&(document.getElementById("dropdown-theme").value=t.theme),t.fontSize&&(document.getElementById("dropdown-font-size").value=t.fontSize),t.tldrMode&&(document.getElementById("dropdown-tldr-mode").value=t.tldrMode),t.showReply&&(document.getElementById("dropdown-show-reply").value=t.showReply),t.replyModel&&(document.getElementById("dropdown-reply-model").value=t.replyModel),t.autorun&&(document.getElementById("dropdown-autorun").value=t.autorun),t.autorunOption&&(document.getElementById("dropdown-autorun-option").value=t.autorunOption),t.devMode&&(document.getElementById("dropdown-dev-mode").value=t.devMode),t.devServer&&(document.getElementById("dropdown-dev-server").value=t.devServer);var n=document.getElementById("dev-server-group");n&&(n.style.display="true"===t.devMode?"block":"none"),We("true"===t.devMode),t.fontSize&&we(t.fontSize),t.showReply&&Fe("true"===t.showReply),t.templates&&(t.templates.summarize&&(document.getElementById("dropdown-summarize-template").value=t.templates.summarize),t.templates.translate&&(document.getElementById("dropdown-translate-template").value=t.templates.translate),t.templates.translateSummarize&&(document.getElementById("dropdown-translate-summarize-template").value=t.templates.translateSummarize))}else xe()}catch(e){console.error("Error loading dropdown settings:",e),xe()}}(),fe(),Office.context.mailbox.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.SettingsChanged,ye),Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,(function(e){var t=!1,n=null;try{var r=localStorage.getItem("michael_settings");if(r){var s=JSON.parse(r);t="true"===s.autorun,n=s.autorunOption}}catch(e){console.error("Error getting autorun settings:",e)}if(t&&n)switch(n){case"summarize":$e();break;case"translate":_e();break;case"translateAndSummarize":je();break;case"reply":Ze()}}),(function(e){e.status===Office.AsyncResultStatus.Succeeded&&e.value.addHandlerAsync(Office.EventType.ItemChanged,(function(e){var t=!1,n=null;try{var r=localStorage.getItem("michael_settings");if(r){var s=JSON.parse(r);t="true"===s.autorun,n=s.autorunOption}}catch(e){console.error("Error getting autorun settings:",e)}if(t&&n)switch(n){case"summarize":$e();break;case"translate":_e();break;case"translateAndSummarize":je();break;case"reply":Ze()}}),(function(e){e.status===Office.AsyncResultStatus.Succeeded&&e.value.register()}))}))}})),window.toggleSettingsDropdown=me}();
//# sourceMappingURL=taskpane.js.map