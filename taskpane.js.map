{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack:///webpack/bootstrap?","webpack:///webpack/runtime/global?","webpack:///webpack/runtime/publicPath?","webpack:///./node_modules/marked/lib/marked.esm.js?","webpack:///./src/taskpane/taskpane.js?"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","/**\n * marked v15.0.7 - a markdown parser\n * Copyright (c) 2011-2025, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * DO NOT EDIT THIS FILE\n * The code in this file is generated from files in ./src/\n */\n\n/**\n * Gets the original marked default options.\n */\nfunction _getDefaults() {\n    return {\n        async: false,\n        breaks: false,\n        extensions: null,\n        gfm: true,\n        hooks: null,\n        pedantic: false,\n        renderer: null,\n        silent: false,\n        tokenizer: null,\n        walkTokens: null,\n    };\n}\nlet _defaults = _getDefaults();\nfunction changeDefaults(newDefaults) {\n    _defaults = newDefaults;\n}\n\nconst noopTest = { exec: () => null };\nfunction edit(regex, opt = '') {\n    let source = typeof regex === 'string' ? regex : regex.source;\n    const obj = {\n        replace: (name, val) => {\n            let valSource = typeof val === 'string' ? val : val.source;\n            valSource = valSource.replace(other.caret, '$1');\n            source = source.replace(name, valSource);\n            return obj;\n        },\n        getRegex: () => {\n            return new RegExp(source, opt);\n        },\n    };\n    return obj;\n}\nconst other = {\n    codeRemoveIndent: /^(?: {1,4}| {0,3}\\t)/gm,\n    outputLinkReplace: /\\\\([\\[\\]])/g,\n    indentCodeCompensation: /^(\\s+)(?:```)/,\n    beginningSpace: /^\\s+/,\n    endingHash: /#$/,\n    startingSpaceChar: /^ /,\n    endingSpaceChar: / $/,\n    nonSpaceChar: /[^ ]/,\n    newLineCharGlobal: /\\n/g,\n    tabCharGlobal: /\\t/g,\n    multipleSpaceGlobal: /\\s+/g,\n    blankLine: /^[ \\t]*$/,\n    doubleBlankLine: /\\n[ \\t]*\\n[ \\t]*$/,\n    blockquoteStart: /^ {0,3}>/,\n    blockquoteSetextReplace: /\\n {0,3}((?:=+|-+) *)(?=\\n|$)/g,\n    blockquoteSetextReplace2: /^ {0,3}>[ \\t]?/gm,\n    listReplaceTabs: /^\\t+/,\n    listReplaceNesting: /^ {1,4}(?=( {4})*[^ ])/g,\n    listIsTask: /^\\[[ xX]\\] /,\n    listReplaceTask: /^\\[[ xX]\\] +/,\n    anyLine: /\\n.*\\n/,\n    hrefBrackets: /^<(.*)>$/,\n    tableDelimiter: /[:|]/,\n    tableAlignChars: /^\\||\\| *$/g,\n    tableRowBlankLine: /\\n[ \\t]*$/,\n    tableAlignRight: /^ *-+: *$/,\n    tableAlignCenter: /^ *:-+: *$/,\n    tableAlignLeft: /^ *:-+ *$/,\n    startATag: /^<a /i,\n    endATag: /^<\\/a>/i,\n    startPreScriptTag: /^<(pre|code|kbd|script)(\\s|>)/i,\n    endPreScriptTag: /^<\\/(pre|code|kbd|script)(\\s|>)/i,\n    startAngleBracket: /^</,\n    endAngleBracket: />$/,\n    pedanticHrefTitle: /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/,\n    unicodeAlphaNumeric: /[\\p{L}\\p{N}]/u,\n    escapeTest: /[&<>\"']/,\n    escapeReplace: /[&<>\"']/g,\n    escapeTestNoEncode: /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/,\n    escapeReplaceNoEncode: /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/g,\n    unescapeTest: /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig,\n    caret: /(^|[^\\[])\\^/g,\n    percentDecode: /%25/g,\n    findPipe: /\\|/g,\n    splitPipe: / \\|/,\n    slashPipe: /\\\\\\|/g,\n    carriageReturn: /\\r\\n|\\r/g,\n    spaceLine: /^ +$/gm,\n    notSpaceStart: /^\\S*/,\n    endingNewline: /\\n$/,\n    listItemRegex: (bull) => new RegExp(`^( {0,3}${bull})((?:[\\t ][^\\\\n]*)?(?:\\\\n|$))`),\n    nextBulletRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\\\d{1,9}[.)])((?:[ \\t][^\\\\n]*)?(?:\\\\n|$))`),\n    hrRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)`),\n    fencesBeginRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\\`\\`\\`|~~~)`),\n    headingBeginRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`),\n    htmlBeginRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}<(?:[a-z].*>|!--)`, 'i'),\n};\n/**\n * Block-Level Grammar\n */\nconst newline = /^(?:[ \\t]*(?:\\n|$))+/;\nconst blockCode = /^((?: {4}| {0,3}\\t)[^\\n]+(?:\\n(?:[ \\t]*(?:\\n|$))*)?)+/;\nconst fences = /^ {0,3}(`{3,}(?=[^`\\n]*(?:\\n|$))|~{3,})([^\\n]*)(?:\\n|$)(?:|([\\s\\S]*?)(?:\\n|$))(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/;\nconst hr = /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/;\nconst heading = /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/;\nconst bullet = /(?:[*+-]|\\d{1,9}[.)])/;\nconst lheadingCore = /^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\\n(?!\\s*?\\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/;\nconst lheading = edit(lheadingCore)\n    .replace(/bull/g, bullet) // lists can interrupt\n    .replace(/blockCode/g, /(?: {4}| {0,3}\\t)/) // indented code blocks can interrupt\n    .replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/) // fenced code blocks can interrupt\n    .replace(/blockquote/g, / {0,3}>/) // blockquote can interrupt\n    .replace(/heading/g, / {0,3}#{1,6}/) // ATX heading can interrupt\n    .replace(/html/g, / {0,3}<[^\\n>]+>\\n/) // block html can interrupt\n    .replace(/\\|table/g, '') // table not in commonmark\n    .getRegex();\nconst lheadingGfm = edit(lheadingCore)\n    .replace(/bull/g, bullet) // lists can interrupt\n    .replace(/blockCode/g, /(?: {4}| {0,3}\\t)/) // indented code blocks can interrupt\n    .replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/) // fenced code blocks can interrupt\n    .replace(/blockquote/g, / {0,3}>/) // blockquote can interrupt\n    .replace(/heading/g, / {0,3}#{1,6}/) // ATX heading can interrupt\n    .replace(/html/g, / {0,3}<[^\\n>]+>\\n/) // block html can interrupt\n    .replace(/table/g, / {0,3}\\|?(?:[:\\- ]*\\|)+[\\:\\- ]*\\n/) // table can interrupt\n    .getRegex();\nconst _paragraph = /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/;\nconst blockText = /^[^\\n]+/;\nconst _blockLabel = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\nconst def = edit(/^ {0,3}\\[(label)\\]: *(?:\\n[ \\t]*)?([^<\\s][^\\s]*|<.*?>)(?:(?: +(?:\\n[ \\t]*)?| *\\n[ \\t]*)(title))? *(?:\\n+|$)/)\n    .replace('label', _blockLabel)\n    .replace('title', /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/)\n    .getRegex();\nconst list = edit(/^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/)\n    .replace(/bull/g, bullet)\n    .getRegex();\nconst _tag = 'address|article|aside|base|basefont|blockquote|body|caption'\n    + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'\n    + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'\n    + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'\n    + '|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title'\n    + '|tr|track|ul';\nconst _comment = /<!--(?:-?>|[\\s\\S]*?(?:-->|$))/;\nconst html = edit('^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n[ \\t]*)+\\\\n|$)' // (6)\n    + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n[ \\t]*)+\\\\n|$)' // (7) open tag\n    + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n[ \\t]*)+\\\\n|$)' // (7) closing tag\n    + ')', 'i')\n    .replace('comment', _comment)\n    .replace('tag', _tag)\n    .replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/)\n    .getRegex();\nconst paragraph = edit(_paragraph)\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n    .replace('|table', '')\n    .replace('blockquote', ' {0,3}>')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n    .getRegex();\nconst blockquote = edit(/^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/)\n    .replace('paragraph', paragraph)\n    .getRegex();\n/**\n * Normal Block Grammar\n */\nconst blockNormal = {\n    blockquote,\n    code: blockCode,\n    def,\n    fences,\n    heading,\n    hr,\n    html,\n    lheading,\n    list,\n    newline,\n    paragraph,\n    table: noopTest,\n    text: blockText,\n};\n/**\n * GFM Block Grammar\n */\nconst gfmTable = edit('^ *([^\\\\n ].*)\\\\n' // Header\n    + ' {0,3}((?:\\\\| *)?:?-+:? *(?:\\\\| *:?-+:? *)*(?:\\\\| *)?)' // Align\n    + '(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)') // Cells\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('blockquote', ' {0,3}>')\n    .replace('code', '(?: {4}| {0,3}\\t)[^\\\\n]')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // tables can be interrupted by type (6) html blocks\n    .getRegex();\nconst blockGfm = {\n    ...blockNormal,\n    lheading: lheadingGfm,\n    table: gfmTable,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n        .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n        .replace('table', gfmTable) // interrupt paragraphs with table\n        .replace('blockquote', ' {0,3}>')\n        .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n        .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n        .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n        .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n        .getRegex(),\n};\n/**\n * Pedantic grammar (original John Gruber's loose markdown specification)\n */\nconst blockPedantic = {\n    ...blockNormal,\n    html: edit('^ *(?:comment *(?:\\\\n|\\\\s*$)'\n        + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n        + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))')\n        .replace('comment', _comment)\n        .replace(/tag/g, '(?!(?:'\n        + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'\n        + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'\n        + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b')\n        .getRegex(),\n    def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n    heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n    fences: noopTest, // fences not supported\n    lheading: /^(.+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' *#{1,6} *[^\\n]')\n        .replace('lheading', lheading)\n        .replace('|table', '')\n        .replace('blockquote', ' {0,3}>')\n        .replace('|fences', '')\n        .replace('|list', '')\n        .replace('|html', '')\n        .replace('|tag', '')\n        .getRegex(),\n};\n/**\n * Inline-Level Grammar\n */\nconst escape$1 = /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/;\nconst inlineCode = /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/;\nconst br = /^( {2,}|\\\\)\\n(?!\\s*$)/;\nconst inlineText = /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/;\n// list of unicode punctuation marks, plus any missing characters from CommonMark spec\nconst _punctuation = /[\\p{P}\\p{S}]/u;\nconst _punctuationOrSpace = /[\\s\\p{P}\\p{S}]/u;\nconst _notPunctuationOrSpace = /[^\\s\\p{P}\\p{S}]/u;\nconst punctuation = edit(/^((?![*_])punctSpace)/, 'u')\n    .replace(/punctSpace/g, _punctuationOrSpace).getRegex();\n// GFM allows ~ inside strong and em for strikethrough\nconst _punctuationGfmStrongEm = /(?!~)[\\p{P}\\p{S}]/u;\nconst _punctuationOrSpaceGfmStrongEm = /(?!~)[\\s\\p{P}\\p{S}]/u;\nconst _notPunctuationOrSpaceGfmStrongEm = /(?:[^\\s\\p{P}\\p{S}]|~)/u;\n// sequences em should skip over [title](link), `code`, <html>\nconst blockSkip = /\\[[^[\\]]*?\\]\\((?:\\\\.|[^\\\\\\(\\)]|\\((?:\\\\.|[^\\\\\\(\\)])*\\))*\\)|`[^`]*?`|<[^<>]*?>/g;\nconst emStrongLDelimCore = /^(?:\\*+(?:((?!\\*)punct)|[^\\s*]))|^_+(?:((?!_)punct)|([^\\s_]))/;\nconst emStrongLDelim = edit(emStrongLDelimCore, 'u')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst emStrongLDelimGfm = edit(emStrongLDelimCore, 'u')\n    .replace(/punct/g, _punctuationGfmStrongEm)\n    .getRegex();\nconst emStrongRDelimAstCore = '^[^_*]*?__[^_*]*?\\\\*[^_*]*?(?=__)' // Skip orphan inside strong\n    + '|[^*]+(?=[^*])' // Consume to delim\n    + '|(?!\\\\*)punct(\\\\*+)(?=[\\\\s]|$)' // (1) #*** can only be a Right Delimiter\n    + '|notPunctSpace(\\\\*+)(?!\\\\*)(?=punctSpace|$)' // (2) a***#, a*** can only be a Right Delimiter\n    + '|(?!\\\\*)punctSpace(\\\\*+)(?=notPunctSpace)' // (3) #***a, ***a can only be Left Delimiter\n    + '|[\\\\s](\\\\*+)(?!\\\\*)(?=punct)' // (4) ***# can only be Left Delimiter\n    + '|(?!\\\\*)punct(\\\\*+)(?!\\\\*)(?=punct)' // (5) #***# can be either Left or Right Delimiter\n    + '|notPunctSpace(\\\\*+)(?=notPunctSpace)'; // (6) a***a can be either Left or Right Delimiter\nconst emStrongRDelimAst = edit(emStrongRDelimAstCore, 'gu')\n    .replace(/notPunctSpace/g, _notPunctuationOrSpace)\n    .replace(/punctSpace/g, _punctuationOrSpace)\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst emStrongRDelimAstGfm = edit(emStrongRDelimAstCore, 'gu')\n    .replace(/notPunctSpace/g, _notPunctuationOrSpaceGfmStrongEm)\n    .replace(/punctSpace/g, _punctuationOrSpaceGfmStrongEm)\n    .replace(/punct/g, _punctuationGfmStrongEm)\n    .getRegex();\n// (6) Not allowed for _\nconst emStrongRDelimUnd = edit('^[^_*]*?\\\\*\\\\*[^_*]*?_[^_*]*?(?=\\\\*\\\\*)' // Skip orphan inside strong\n    + '|[^_]+(?=[^_])' // Consume to delim\n    + '|(?!_)punct(_+)(?=[\\\\s]|$)' // (1) #___ can only be a Right Delimiter\n    + '|notPunctSpace(_+)(?!_)(?=punctSpace|$)' // (2) a___#, a___ can only be a Right Delimiter\n    + '|(?!_)punctSpace(_+)(?=notPunctSpace)' // (3) #___a, ___a can only be Left Delimiter\n    + '|[\\\\s](_+)(?!_)(?=punct)' // (4) ___# can only be Left Delimiter\n    + '|(?!_)punct(_+)(?!_)(?=punct)', 'gu') // (5) #___# can be either Left or Right Delimiter\n    .replace(/notPunctSpace/g, _notPunctuationOrSpace)\n    .replace(/punctSpace/g, _punctuationOrSpace)\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst anyPunctuation = edit(/\\\\(punct)/, 'gu')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst autolink = edit(/^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/)\n    .replace('scheme', /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/)\n    .replace('email', /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/)\n    .getRegex();\nconst _inlineComment = edit(_comment).replace('(?:-->|$)', '-->').getRegex();\nconst tag = edit('^comment'\n    + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>') // CDATA section\n    .replace('comment', _inlineComment)\n    .replace('attribute', /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/)\n    .getRegex();\nconst _inlineLabel = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\nconst link = edit(/^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/)\n    .replace('label', _inlineLabel)\n    .replace('href', /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/)\n    .replace('title', /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/)\n    .getRegex();\nconst reflink = edit(/^!?\\[(label)\\]\\[(ref)\\]/)\n    .replace('label', _inlineLabel)\n    .replace('ref', _blockLabel)\n    .getRegex();\nconst nolink = edit(/^!?\\[(ref)\\](?:\\[\\])?/)\n    .replace('ref', _blockLabel)\n    .getRegex();\nconst reflinkSearch = edit('reflink|nolink(?!\\\\()', 'g')\n    .replace('reflink', reflink)\n    .replace('nolink', nolink)\n    .getRegex();\n/**\n * Normal Inline Grammar\n */\nconst inlineNormal = {\n    _backpedal: noopTest, // only used for GFM url\n    anyPunctuation,\n    autolink,\n    blockSkip,\n    br,\n    code: inlineCode,\n    del: noopTest,\n    emStrongLDelim,\n    emStrongRDelimAst,\n    emStrongRDelimUnd,\n    escape: escape$1,\n    link,\n    nolink,\n    punctuation,\n    reflink,\n    reflinkSearch,\n    tag,\n    text: inlineText,\n    url: noopTest,\n};\n/**\n * Pedantic Inline Grammar\n */\nconst inlinePedantic = {\n    ...inlineNormal,\n    link: edit(/^!?\\[(label)\\]\\((.*?)\\)/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n    reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n};\n/**\n * GFM Inline Grammar\n */\nconst inlineGfm = {\n    ...inlineNormal,\n    emStrongRDelimAst: emStrongRDelimAstGfm,\n    emStrongLDelim: emStrongLDelimGfm,\n    url: edit(/^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/, 'i')\n        .replace('email', /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/)\n        .getRegex(),\n    _backpedal: /(?:[^?!.,:;*_'\"~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'\"~)]+(?!$))+/,\n    del: /^(~~?)(?=[^\\s~])((?:\\\\.|[^\\\\])*?(?:\\\\.|[^\\s~\\\\]))\\1(?=[^~]|$)/,\n    text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/,\n};\n/**\n * GFM + Line Breaks Inline Grammar\n */\nconst inlineBreaks = {\n    ...inlineGfm,\n    br: edit(br).replace('{2,}', '*').getRegex(),\n    text: edit(inlineGfm.text)\n        .replace('\\\\b_', '\\\\b_| {2,}\\\\n')\n        .replace(/\\{2,\\}/g, '*')\n        .getRegex(),\n};\n/**\n * exports\n */\nconst block = {\n    normal: blockNormal,\n    gfm: blockGfm,\n    pedantic: blockPedantic,\n};\nconst inline = {\n    normal: inlineNormal,\n    gfm: inlineGfm,\n    breaks: inlineBreaks,\n    pedantic: inlinePedantic,\n};\n\n/**\n * Helpers\n */\nconst escapeReplacements = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n};\nconst getEscapeReplacement = (ch) => escapeReplacements[ch];\nfunction escape(html, encode) {\n    if (encode) {\n        if (other.escapeTest.test(html)) {\n            return html.replace(other.escapeReplace, getEscapeReplacement);\n        }\n    }\n    else {\n        if (other.escapeTestNoEncode.test(html)) {\n            return html.replace(other.escapeReplaceNoEncode, getEscapeReplacement);\n        }\n    }\n    return html;\n}\nfunction cleanUrl(href) {\n    try {\n        href = encodeURI(href).replace(other.percentDecode, '%');\n    }\n    catch {\n        return null;\n    }\n    return href;\n}\nfunction splitCells(tableRow, count) {\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    const row = tableRow.replace(other.findPipe, (match, offset, str) => {\n        let escaped = false;\n        let curr = offset;\n        while (--curr >= 0 && str[curr] === '\\\\')\n            escaped = !escaped;\n        if (escaped) {\n            // odd number of slashes means | is escaped\n            // so we leave it alone\n            return '|';\n        }\n        else {\n            // add space before unescaped |\n            return ' |';\n        }\n    }), cells = row.split(other.splitPipe);\n    let i = 0;\n    // First/last cell in a row cannot be empty if it has no leading/trailing pipe\n    if (!cells[0].trim()) {\n        cells.shift();\n    }\n    if (cells.length > 0 && !cells.at(-1)?.trim()) {\n        cells.pop();\n    }\n    if (count) {\n        if (cells.length > count) {\n            cells.splice(count);\n        }\n        else {\n            while (cells.length < count)\n                cells.push('');\n        }\n    }\n    for (; i < cells.length; i++) {\n        // leading or trailing whitespace is ignored per the gfm spec\n        cells[i] = cells[i].trim().replace(other.slashPipe, '|');\n    }\n    return cells;\n}\n/**\n * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n * /c*$/ is vulnerable to REDOS.\n *\n * @param str\n * @param c\n * @param invert Remove suffix of non-c chars instead. Default falsey.\n */\nfunction rtrim(str, c, invert) {\n    const l = str.length;\n    if (l === 0) {\n        return '';\n    }\n    // Length of suffix matching the invert condition.\n    let suffLen = 0;\n    // Step left until we fail to match the invert condition.\n    while (suffLen < l) {\n        const currChar = str.charAt(l - suffLen - 1);\n        if (currChar === c && true) {\n            suffLen++;\n        }\n        else {\n            break;\n        }\n    }\n    return str.slice(0, l - suffLen);\n}\nfunction findClosingBracket(str, b) {\n    if (str.indexOf(b[1]) === -1) {\n        return -1;\n    }\n    let level = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str[i] === '\\\\') {\n            i++;\n        }\n        else if (str[i] === b[0]) {\n            level++;\n        }\n        else if (str[i] === b[1]) {\n            level--;\n            if (level < 0) {\n                return i;\n            }\n        }\n    }\n    return -1;\n}\n\nfunction outputLink(cap, link, raw, lexer, rules) {\n    const href = link.href;\n    const title = link.title || null;\n    const text = cap[1].replace(rules.other.outputLinkReplace, '$1');\n    if (cap[0].charAt(0) !== '!') {\n        lexer.state.inLink = true;\n        const token = {\n            type: 'link',\n            raw,\n            href,\n            title,\n            text,\n            tokens: lexer.inlineTokens(text),\n        };\n        lexer.state.inLink = false;\n        return token;\n    }\n    return {\n        type: 'image',\n        raw,\n        href,\n        title,\n        text,\n    };\n}\nfunction indentCodeCompensation(raw, text, rules) {\n    const matchIndentToCode = raw.match(rules.other.indentCodeCompensation);\n    if (matchIndentToCode === null) {\n        return text;\n    }\n    const indentToCode = matchIndentToCode[1];\n    return text\n        .split('\\n')\n        .map(node => {\n        const matchIndentInNode = node.match(rules.other.beginningSpace);\n        if (matchIndentInNode === null) {\n            return node;\n        }\n        const [indentInNode] = matchIndentInNode;\n        if (indentInNode.length >= indentToCode.length) {\n            return node.slice(indentToCode.length);\n        }\n        return node;\n    })\n        .join('\\n');\n}\n/**\n * Tokenizer\n */\nclass _Tokenizer {\n    options;\n    rules; // set by the lexer\n    lexer; // set by the lexer\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    space(src) {\n        const cap = this.rules.block.newline.exec(src);\n        if (cap && cap[0].length > 0) {\n            return {\n                type: 'space',\n                raw: cap[0],\n            };\n        }\n    }\n    code(src) {\n        const cap = this.rules.block.code.exec(src);\n        if (cap) {\n            const text = cap[0].replace(this.rules.other.codeRemoveIndent, '');\n            return {\n                type: 'code',\n                raw: cap[0],\n                codeBlockStyle: 'indented',\n                text: !this.options.pedantic\n                    ? rtrim(text, '\\n')\n                    : text,\n            };\n        }\n    }\n    fences(src) {\n        const cap = this.rules.block.fences.exec(src);\n        if (cap) {\n            const raw = cap[0];\n            const text = indentCodeCompensation(raw, cap[3] || '', this.rules);\n            return {\n                type: 'code',\n                raw,\n                lang: cap[2] ? cap[2].trim().replace(this.rules.inline.anyPunctuation, '$1') : cap[2],\n                text,\n            };\n        }\n    }\n    heading(src) {\n        const cap = this.rules.block.heading.exec(src);\n        if (cap) {\n            let text = cap[2].trim();\n            // remove trailing #s\n            if (this.rules.other.endingHash.test(text)) {\n                const trimmed = rtrim(text, '#');\n                if (this.options.pedantic) {\n                    text = trimmed.trim();\n                }\n                else if (!trimmed || this.rules.other.endingSpaceChar.test(trimmed)) {\n                    // CommonMark requires space before trailing #s\n                    text = trimmed.trim();\n                }\n            }\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[1].length,\n                text,\n                tokens: this.lexer.inline(text),\n            };\n        }\n    }\n    hr(src) {\n        const cap = this.rules.block.hr.exec(src);\n        if (cap) {\n            return {\n                type: 'hr',\n                raw: rtrim(cap[0], '\\n'),\n            };\n        }\n    }\n    blockquote(src) {\n        const cap = this.rules.block.blockquote.exec(src);\n        if (cap) {\n            let lines = rtrim(cap[0], '\\n').split('\\n');\n            let raw = '';\n            let text = '';\n            const tokens = [];\n            while (lines.length > 0) {\n                let inBlockquote = false;\n                const currentLines = [];\n                let i;\n                for (i = 0; i < lines.length; i++) {\n                    // get lines up to a continuation\n                    if (this.rules.other.blockquoteStart.test(lines[i])) {\n                        currentLines.push(lines[i]);\n                        inBlockquote = true;\n                    }\n                    else if (!inBlockquote) {\n                        currentLines.push(lines[i]);\n                    }\n                    else {\n                        break;\n                    }\n                }\n                lines = lines.slice(i);\n                const currentRaw = currentLines.join('\\n');\n                const currentText = currentRaw\n                    // precede setext continuation with 4 spaces so it isn't a setext\n                    .replace(this.rules.other.blockquoteSetextReplace, '\\n    $1')\n                    .replace(this.rules.other.blockquoteSetextReplace2, '');\n                raw = raw ? `${raw}\\n${currentRaw}` : currentRaw;\n                text = text ? `${text}\\n${currentText}` : currentText;\n                // parse blockquote lines as top level tokens\n                // merge paragraphs if this is a continuation\n                const top = this.lexer.state.top;\n                this.lexer.state.top = true;\n                this.lexer.blockTokens(currentText, tokens, true);\n                this.lexer.state.top = top;\n                // if there is no continuation then we are done\n                if (lines.length === 0) {\n                    break;\n                }\n                const lastToken = tokens.at(-1);\n                if (lastToken?.type === 'code') {\n                    // blockquote continuation cannot be preceded by a code block\n                    break;\n                }\n                else if (lastToken?.type === 'blockquote') {\n                    // include continuation in nested blockquote\n                    const oldToken = lastToken;\n                    const newText = oldToken.raw + '\\n' + lines.join('\\n');\n                    const newToken = this.blockquote(newText);\n                    tokens[tokens.length - 1] = newToken;\n                    raw = raw.substring(0, raw.length - oldToken.raw.length) + newToken.raw;\n                    text = text.substring(0, text.length - oldToken.text.length) + newToken.text;\n                    break;\n                }\n                else if (lastToken?.type === 'list') {\n                    // include continuation in nested list\n                    const oldToken = lastToken;\n                    const newText = oldToken.raw + '\\n' + lines.join('\\n');\n                    const newToken = this.list(newText);\n                    tokens[tokens.length - 1] = newToken;\n                    raw = raw.substring(0, raw.length - lastToken.raw.length) + newToken.raw;\n                    text = text.substring(0, text.length - oldToken.raw.length) + newToken.raw;\n                    lines = newText.substring(tokens.at(-1).raw.length).split('\\n');\n                    continue;\n                }\n            }\n            return {\n                type: 'blockquote',\n                raw,\n                tokens,\n                text,\n            };\n        }\n    }\n    list(src) {\n        let cap = this.rules.block.list.exec(src);\n        if (cap) {\n            let bull = cap[1].trim();\n            const isordered = bull.length > 1;\n            const list = {\n                type: 'list',\n                raw: '',\n                ordered: isordered,\n                start: isordered ? +bull.slice(0, -1) : '',\n                loose: false,\n                items: [],\n            };\n            bull = isordered ? `\\\\d{1,9}\\\\${bull.slice(-1)}` : `\\\\${bull}`;\n            if (this.options.pedantic) {\n                bull = isordered ? bull : '[*+-]';\n            }\n            // Get next list item\n            const itemRegex = this.rules.other.listItemRegex(bull);\n            let endsWithBlankLine = false;\n            // Check if current bullet point can start a new List Item\n            while (src) {\n                let endEarly = false;\n                let raw = '';\n                let itemContents = '';\n                if (!(cap = itemRegex.exec(src))) {\n                    break;\n                }\n                if (this.rules.block.hr.test(src)) { // End list if bullet was actually HR (possibly move into itemRegex?)\n                    break;\n                }\n                raw = cap[0];\n                src = src.substring(raw.length);\n                let line = cap[2].split('\\n', 1)[0].replace(this.rules.other.listReplaceTabs, (t) => ' '.repeat(3 * t.length));\n                let nextLine = src.split('\\n', 1)[0];\n                let blankLine = !line.trim();\n                let indent = 0;\n                if (this.options.pedantic) {\n                    indent = 2;\n                    itemContents = line.trimStart();\n                }\n                else if (blankLine) {\n                    indent = cap[1].length + 1;\n                }\n                else {\n                    indent = cap[2].search(this.rules.other.nonSpaceChar); // Find first non-space char\n                    indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent\n                    itemContents = line.slice(indent);\n                    indent += cap[1].length;\n                }\n                if (blankLine && this.rules.other.blankLine.test(nextLine)) { // Items begin with at most one blank line\n                    raw += nextLine + '\\n';\n                    src = src.substring(nextLine.length + 1);\n                    endEarly = true;\n                }\n                if (!endEarly) {\n                    const nextBulletRegex = this.rules.other.nextBulletRegex(indent);\n                    const hrRegex = this.rules.other.hrRegex(indent);\n                    const fencesBeginRegex = this.rules.other.fencesBeginRegex(indent);\n                    const headingBeginRegex = this.rules.other.headingBeginRegex(indent);\n                    const htmlBeginRegex = this.rules.other.htmlBeginRegex(indent);\n                    // Check if following lines should be included in List Item\n                    while (src) {\n                        const rawLine = src.split('\\n', 1)[0];\n                        let nextLineWithoutTabs;\n                        nextLine = rawLine;\n                        // Re-align to follow commonmark nesting rules\n                        if (this.options.pedantic) {\n                            nextLine = nextLine.replace(this.rules.other.listReplaceNesting, '  ');\n                            nextLineWithoutTabs = nextLine;\n                        }\n                        else {\n                            nextLineWithoutTabs = nextLine.replace(this.rules.other.tabCharGlobal, '    ');\n                        }\n                        // End list item if found code fences\n                        if (fencesBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of new heading\n                        if (headingBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of html block\n                        if (htmlBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of new bullet\n                        if (nextBulletRegex.test(nextLine)) {\n                            break;\n                        }\n                        // Horizontal rule found\n                        if (hrRegex.test(nextLine)) {\n                            break;\n                        }\n                        if (nextLineWithoutTabs.search(this.rules.other.nonSpaceChar) >= indent || !nextLine.trim()) { // Dedent if possible\n                            itemContents += '\\n' + nextLineWithoutTabs.slice(indent);\n                        }\n                        else {\n                            // not enough indentation\n                            if (blankLine) {\n                                break;\n                            }\n                            // paragraph continuation unless last line was a different block level element\n                            if (line.replace(this.rules.other.tabCharGlobal, '    ').search(this.rules.other.nonSpaceChar) >= 4) { // indented code block\n                                break;\n                            }\n                            if (fencesBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (headingBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (hrRegex.test(line)) {\n                                break;\n                            }\n                            itemContents += '\\n' + nextLine;\n                        }\n                        if (!blankLine && !nextLine.trim()) { // Check if current line is blank\n                            blankLine = true;\n                        }\n                        raw += rawLine + '\\n';\n                        src = src.substring(rawLine.length + 1);\n                        line = nextLineWithoutTabs.slice(indent);\n                    }\n                }\n                if (!list.loose) {\n                    // If the previous item ended with a blank line, the list is loose\n                    if (endsWithBlankLine) {\n                        list.loose = true;\n                    }\n                    else if (this.rules.other.doubleBlankLine.test(raw)) {\n                        endsWithBlankLine = true;\n                    }\n                }\n                let istask = null;\n                let ischecked;\n                // Check for task list items\n                if (this.options.gfm) {\n                    istask = this.rules.other.listIsTask.exec(itemContents);\n                    if (istask) {\n                        ischecked = istask[0] !== '[ ] ';\n                        itemContents = itemContents.replace(this.rules.other.listReplaceTask, '');\n                    }\n                }\n                list.items.push({\n                    type: 'list_item',\n                    raw,\n                    task: !!istask,\n                    checked: ischecked,\n                    loose: false,\n                    text: itemContents,\n                    tokens: [],\n                });\n                list.raw += raw;\n            }\n            // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic\n            const lastItem = list.items.at(-1);\n            if (lastItem) {\n                lastItem.raw = lastItem.raw.trimEnd();\n                lastItem.text = lastItem.text.trimEnd();\n            }\n            else {\n                // not a list since there were no items\n                return;\n            }\n            list.raw = list.raw.trimEnd();\n            // Item child tokens handled here at end because we needed to have the final item to trim it first\n            for (let i = 0; i < list.items.length; i++) {\n                this.lexer.state.top = false;\n                list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);\n                if (!list.loose) {\n                    // Check if list should be loose\n                    const spacers = list.items[i].tokens.filter(t => t.type === 'space');\n                    const hasMultipleLineBreaks = spacers.length > 0 && spacers.some(t => this.rules.other.anyLine.test(t.raw));\n                    list.loose = hasMultipleLineBreaks;\n                }\n            }\n            // Set all items to loose if list is loose\n            if (list.loose) {\n                for (let i = 0; i < list.items.length; i++) {\n                    list.items[i].loose = true;\n                }\n            }\n            return list;\n        }\n    }\n    html(src) {\n        const cap = this.rules.block.html.exec(src);\n        if (cap) {\n            const token = {\n                type: 'html',\n                block: true,\n                raw: cap[0],\n                pre: cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style',\n                text: cap[0],\n            };\n            return token;\n        }\n    }\n    def(src) {\n        const cap = this.rules.block.def.exec(src);\n        if (cap) {\n            const tag = cap[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal, ' ');\n            const href = cap[2] ? cap[2].replace(this.rules.other.hrefBrackets, '$1').replace(this.rules.inline.anyPunctuation, '$1') : '';\n            const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline.anyPunctuation, '$1') : cap[3];\n            return {\n                type: 'def',\n                tag,\n                raw: cap[0],\n                href,\n                title,\n            };\n        }\n    }\n    table(src) {\n        const cap = this.rules.block.table.exec(src);\n        if (!cap) {\n            return;\n        }\n        if (!this.rules.other.tableDelimiter.test(cap[2])) {\n            // delimiter row must have a pipe (|) or colon (:) otherwise it is a setext heading\n            return;\n        }\n        const headers = splitCells(cap[1]);\n        const aligns = cap[2].replace(this.rules.other.tableAlignChars, '').split('|');\n        const rows = cap[3]?.trim() ? cap[3].replace(this.rules.other.tableRowBlankLine, '').split('\\n') : [];\n        const item = {\n            type: 'table',\n            raw: cap[0],\n            header: [],\n            align: [],\n            rows: [],\n        };\n        if (headers.length !== aligns.length) {\n            // header and align columns must be equal, rows can be different.\n            return;\n        }\n        for (const align of aligns) {\n            if (this.rules.other.tableAlignRight.test(align)) {\n                item.align.push('right');\n            }\n            else if (this.rules.other.tableAlignCenter.test(align)) {\n                item.align.push('center');\n            }\n            else if (this.rules.other.tableAlignLeft.test(align)) {\n                item.align.push('left');\n            }\n            else {\n                item.align.push(null);\n            }\n        }\n        for (let i = 0; i < headers.length; i++) {\n            item.header.push({\n                text: headers[i],\n                tokens: this.lexer.inline(headers[i]),\n                header: true,\n                align: item.align[i],\n            });\n        }\n        for (const row of rows) {\n            item.rows.push(splitCells(row, item.header.length).map((cell, i) => {\n                return {\n                    text: cell,\n                    tokens: this.lexer.inline(cell),\n                    header: false,\n                    align: item.align[i],\n                };\n            }));\n        }\n        return item;\n    }\n    lheading(src) {\n        const cap = this.rules.block.lheading.exec(src);\n        if (cap) {\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[2].charAt(0) === '=' ? 1 : 2,\n                text: cap[1],\n                tokens: this.lexer.inline(cap[1]),\n            };\n        }\n    }\n    paragraph(src) {\n        const cap = this.rules.block.paragraph.exec(src);\n        if (cap) {\n            const text = cap[1].charAt(cap[1].length - 1) === '\\n'\n                ? cap[1].slice(0, -1)\n                : cap[1];\n            return {\n                type: 'paragraph',\n                raw: cap[0],\n                text,\n                tokens: this.lexer.inline(text),\n            };\n        }\n    }\n    text(src) {\n        const cap = this.rules.block.text.exec(src);\n        if (cap) {\n            return {\n                type: 'text',\n                raw: cap[0],\n                text: cap[0],\n                tokens: this.lexer.inline(cap[0]),\n            };\n        }\n    }\n    escape(src) {\n        const cap = this.rules.inline.escape.exec(src);\n        if (cap) {\n            return {\n                type: 'escape',\n                raw: cap[0],\n                text: cap[1],\n            };\n        }\n    }\n    tag(src) {\n        const cap = this.rules.inline.tag.exec(src);\n        if (cap) {\n            if (!this.lexer.state.inLink && this.rules.other.startATag.test(cap[0])) {\n                this.lexer.state.inLink = true;\n            }\n            else if (this.lexer.state.inLink && this.rules.other.endATag.test(cap[0])) {\n                this.lexer.state.inLink = false;\n            }\n            if (!this.lexer.state.inRawBlock && this.rules.other.startPreScriptTag.test(cap[0])) {\n                this.lexer.state.inRawBlock = true;\n            }\n            else if (this.lexer.state.inRawBlock && this.rules.other.endPreScriptTag.test(cap[0])) {\n                this.lexer.state.inRawBlock = false;\n            }\n            return {\n                type: 'html',\n                raw: cap[0],\n                inLink: this.lexer.state.inLink,\n                inRawBlock: this.lexer.state.inRawBlock,\n                block: false,\n                text: cap[0],\n            };\n        }\n    }\n    link(src) {\n        const cap = this.rules.inline.link.exec(src);\n        if (cap) {\n            const trimmedUrl = cap[2].trim();\n            if (!this.options.pedantic && this.rules.other.startAngleBracket.test(trimmedUrl)) {\n                // commonmark requires matching angle brackets\n                if (!(this.rules.other.endAngleBracket.test(trimmedUrl))) {\n                    return;\n                }\n                // ending angle bracket cannot be escaped\n                const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\\\');\n                if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n                    return;\n                }\n            }\n            else {\n                // find closing parenthesis\n                const lastParenIndex = findClosingBracket(cap[2], '()');\n                if (lastParenIndex > -1) {\n                    const start = cap[0].indexOf('!') === 0 ? 5 : 4;\n                    const linkLen = start + cap[1].length + lastParenIndex;\n                    cap[2] = cap[2].substring(0, lastParenIndex);\n                    cap[0] = cap[0].substring(0, linkLen).trim();\n                    cap[3] = '';\n                }\n            }\n            let href = cap[2];\n            let title = '';\n            if (this.options.pedantic) {\n                // split pedantic href and title\n                const link = this.rules.other.pedanticHrefTitle.exec(href);\n                if (link) {\n                    href = link[1];\n                    title = link[3];\n                }\n            }\n            else {\n                title = cap[3] ? cap[3].slice(1, -1) : '';\n            }\n            href = href.trim();\n            if (this.rules.other.startAngleBracket.test(href)) {\n                if (this.options.pedantic && !(this.rules.other.endAngleBracket.test(trimmedUrl))) {\n                    // pedantic allows starting angle bracket without ending angle bracket\n                    href = href.slice(1);\n                }\n                else {\n                    href = href.slice(1, -1);\n                }\n            }\n            return outputLink(cap, {\n                href: href ? href.replace(this.rules.inline.anyPunctuation, '$1') : href,\n                title: title ? title.replace(this.rules.inline.anyPunctuation, '$1') : title,\n            }, cap[0], this.lexer, this.rules);\n        }\n    }\n    reflink(src, links) {\n        let cap;\n        if ((cap = this.rules.inline.reflink.exec(src))\n            || (cap = this.rules.inline.nolink.exec(src))) {\n            const linkString = (cap[2] || cap[1]).replace(this.rules.other.multipleSpaceGlobal, ' ');\n            const link = links[linkString.toLowerCase()];\n            if (!link) {\n                const text = cap[0].charAt(0);\n                return {\n                    type: 'text',\n                    raw: text,\n                    text,\n                };\n            }\n            return outputLink(cap, link, cap[0], this.lexer, this.rules);\n        }\n    }\n    emStrong(src, maskedSrc, prevChar = '') {\n        let match = this.rules.inline.emStrongLDelim.exec(src);\n        if (!match)\n            return;\n        // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n        if (match[3] && prevChar.match(this.rules.other.unicodeAlphaNumeric))\n            return;\n        const nextChar = match[1] || match[2] || '';\n        if (!nextChar || !prevChar || this.rules.inline.punctuation.exec(prevChar)) {\n            // unicode Regex counts emoji as 1 char; spread into array for proper count (used multiple times below)\n            const lLength = [...match[0]].length - 1;\n            let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;\n            const endReg = match[0][0] === '*' ? this.rules.inline.emStrongRDelimAst : this.rules.inline.emStrongRDelimUnd;\n            endReg.lastIndex = 0;\n            // Clip maskedSrc to same section of string as src (move to lexer?)\n            maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\n            while ((match = endReg.exec(maskedSrc)) != null) {\n                rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n                if (!rDelim)\n                    continue; // skip single * in __abc*abc__\n                rLength = [...rDelim].length;\n                if (match[3] || match[4]) { // found another Left Delim\n                    delimTotal += rLength;\n                    continue;\n                }\n                else if (match[5] || match[6]) { // either Left or Right Delim\n                    if (lLength % 3 && !((lLength + rLength) % 3)) {\n                        midDelimTotal += rLength;\n                        continue; // CommonMark Emphasis Rules 9-10\n                    }\n                }\n                delimTotal -= rLength;\n                if (delimTotal > 0)\n                    continue; // Haven't found enough closing delimiters\n                // Remove extra characters. *a*** -> *a*\n                rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\n                // char length can be >1 for unicode characters;\n                const lastCharLength = [...match[0]][0].length;\n                const raw = src.slice(0, lLength + match.index + lastCharLength + rLength);\n                // Create `em` if smallest delimiter has odd char count. *a***\n                if (Math.min(lLength, rLength) % 2) {\n                    const text = raw.slice(1, -1);\n                    return {\n                        type: 'em',\n                        raw,\n                        text,\n                        tokens: this.lexer.inlineTokens(text),\n                    };\n                }\n                // Create 'strong' if smallest delimiter has even char count. **a***\n                const text = raw.slice(2, -2);\n                return {\n                    type: 'strong',\n                    raw,\n                    text,\n                    tokens: this.lexer.inlineTokens(text),\n                };\n            }\n        }\n    }\n    codespan(src) {\n        const cap = this.rules.inline.code.exec(src);\n        if (cap) {\n            let text = cap[2].replace(this.rules.other.newLineCharGlobal, ' ');\n            const hasNonSpaceChars = this.rules.other.nonSpaceChar.test(text);\n            const hasSpaceCharsOnBothEnds = this.rules.other.startingSpaceChar.test(text) && this.rules.other.endingSpaceChar.test(text);\n            if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n                text = text.substring(1, text.length - 1);\n            }\n            return {\n                type: 'codespan',\n                raw: cap[0],\n                text,\n            };\n        }\n    }\n    br(src) {\n        const cap = this.rules.inline.br.exec(src);\n        if (cap) {\n            return {\n                type: 'br',\n                raw: cap[0],\n            };\n        }\n    }\n    del(src) {\n        const cap = this.rules.inline.del.exec(src);\n        if (cap) {\n            return {\n                type: 'del',\n                raw: cap[0],\n                text: cap[2],\n                tokens: this.lexer.inlineTokens(cap[2]),\n            };\n        }\n    }\n    autolink(src) {\n        const cap = this.rules.inline.autolink.exec(src);\n        if (cap) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = cap[1];\n                href = 'mailto:' + text;\n            }\n            else {\n                text = cap[1];\n                href = text;\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text,\n                    },\n                ],\n            };\n        }\n    }\n    url(src) {\n        let cap;\n        if (cap = this.rules.inline.url.exec(src)) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = cap[0];\n                href = 'mailto:' + text;\n            }\n            else {\n                // do extended autolink path validation\n                let prevCapZero;\n                do {\n                    prevCapZero = cap[0];\n                    cap[0] = this.rules.inline._backpedal.exec(cap[0])?.[0] ?? '';\n                } while (prevCapZero !== cap[0]);\n                text = cap[0];\n                if (cap[1] === 'www.') {\n                    href = 'http://' + cap[0];\n                }\n                else {\n                    href = cap[0];\n                }\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text,\n                    },\n                ],\n            };\n        }\n    }\n    inlineText(src) {\n        const cap = this.rules.inline.text.exec(src);\n        if (cap) {\n            const escaped = this.lexer.state.inRawBlock;\n            return {\n                type: 'text',\n                raw: cap[0],\n                text: cap[0],\n                escaped,\n            };\n        }\n    }\n}\n\n/**\n * Block Lexer\n */\nclass _Lexer {\n    tokens;\n    options;\n    state;\n    tokenizer;\n    inlineQueue;\n    constructor(options) {\n        // TokenList cannot be created in one go\n        this.tokens = [];\n        this.tokens.links = Object.create(null);\n        this.options = options || _defaults;\n        this.options.tokenizer = this.options.tokenizer || new _Tokenizer();\n        this.tokenizer = this.options.tokenizer;\n        this.tokenizer.options = this.options;\n        this.tokenizer.lexer = this;\n        this.inlineQueue = [];\n        this.state = {\n            inLink: false,\n            inRawBlock: false,\n            top: true,\n        };\n        const rules = {\n            other,\n            block: block.normal,\n            inline: inline.normal,\n        };\n        if (this.options.pedantic) {\n            rules.block = block.pedantic;\n            rules.inline = inline.pedantic;\n        }\n        else if (this.options.gfm) {\n            rules.block = block.gfm;\n            if (this.options.breaks) {\n                rules.inline = inline.breaks;\n            }\n            else {\n                rules.inline = inline.gfm;\n            }\n        }\n        this.tokenizer.rules = rules;\n    }\n    /**\n     * Expose Rules\n     */\n    static get rules() {\n        return {\n            block,\n            inline,\n        };\n    }\n    /**\n     * Static Lex Method\n     */\n    static lex(src, options) {\n        const lexer = new _Lexer(options);\n        return lexer.lex(src);\n    }\n    /**\n     * Static Lex Inline Method\n     */\n    static lexInline(src, options) {\n        const lexer = new _Lexer(options);\n        return lexer.inlineTokens(src);\n    }\n    /**\n     * Preprocessing\n     */\n    lex(src) {\n        src = src.replace(other.carriageReturn, '\\n');\n        this.blockTokens(src, this.tokens);\n        for (let i = 0; i < this.inlineQueue.length; i++) {\n            const next = this.inlineQueue[i];\n            this.inlineTokens(next.src, next.tokens);\n        }\n        this.inlineQueue = [];\n        return this.tokens;\n    }\n    blockTokens(src, tokens = [], lastParagraphClipped = false) {\n        if (this.options.pedantic) {\n            src = src.replace(other.tabCharGlobal, '    ').replace(other.spaceLine, '');\n        }\n        while (src) {\n            let token;\n            if (this.options.extensions?.block?.some((extTokenizer) => {\n                if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\n                    src = src.substring(token.raw.length);\n                    tokens.push(token);\n                    return true;\n                }\n                return false;\n            })) {\n                continue;\n            }\n            // newline\n            if (token = this.tokenizer.space(src)) {\n                src = src.substring(token.raw.length);\n                const lastToken = tokens.at(-1);\n                if (token.raw.length === 1 && lastToken !== undefined) {\n                    // if there's a single \\n as a spacer, it's terminating the last line,\n                    // so move it there so that we don't get unnecessary paragraph tags\n                    lastToken.raw += '\\n';\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // code\n            if (token = this.tokenizer.code(src)) {\n                src = src.substring(token.raw.length);\n                const lastToken = tokens.at(-1);\n                // An indented code block cannot interrupt a paragraph.\n                if (lastToken?.type === 'paragraph' || lastToken?.type === 'text') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.at(-1).src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // fences\n            if (token = this.tokenizer.fences(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // heading\n            if (token = this.tokenizer.heading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // hr\n            if (token = this.tokenizer.hr(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // blockquote\n            if (token = this.tokenizer.blockquote(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // list\n            if (token = this.tokenizer.list(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // html\n            if (token = this.tokenizer.html(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // def\n            if (token = this.tokenizer.def(src)) {\n                src = src.substring(token.raw.length);\n                const lastToken = tokens.at(-1);\n                if (lastToken?.type === 'paragraph' || lastToken?.type === 'text') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.raw;\n                    this.inlineQueue.at(-1).src = lastToken.text;\n                }\n                else if (!this.tokens.links[token.tag]) {\n                    this.tokens.links[token.tag] = {\n                        href: token.href,\n                        title: token.title,\n                    };\n                }\n                continue;\n            }\n            // table (gfm)\n            if (token = this.tokenizer.table(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // lheading\n            if (token = this.tokenizer.lheading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // top-level paragraph\n            // prevent paragraph consuming extensions by clipping 'src' to extension start\n            let cutSrc = src;\n            if (this.options.extensions?.startBlock) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startBlock.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({ lexer: this }, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\n                const lastToken = tokens.at(-1);\n                if (lastParagraphClipped && lastToken?.type === 'paragraph') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue.at(-1).src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                lastParagraphClipped = cutSrc.length !== src.length;\n                src = src.substring(token.raw.length);\n                continue;\n            }\n            // text\n            if (token = this.tokenizer.text(src)) {\n                src = src.substring(token.raw.length);\n                const lastToken = tokens.at(-1);\n                if (lastToken?.type === 'text') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue.at(-1).src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                }\n                else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n        this.state.top = true;\n        return tokens;\n    }\n    inline(src, tokens = []) {\n        this.inlineQueue.push({ src, tokens });\n        return tokens;\n    }\n    /**\n     * Lexing/Compiling\n     */\n    inlineTokens(src, tokens = []) {\n        // String with links masked to avoid interference with em and strong\n        let maskedSrc = src;\n        let match = null;\n        // Mask out reflinks\n        if (this.tokens.links) {\n            const links = Object.keys(this.tokens.links);\n            if (links.length > 0) {\n                while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n                    if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n                        maskedSrc = maskedSrc.slice(0, match.index)\n                            + '[' + 'a'.repeat(match[0].length - 2) + ']'\n                            + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n                    }\n                }\n            }\n        }\n        // Mask out other blocks\n        while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\n        }\n        // Mask out escaped characters\n        while ((match = this.tokenizer.rules.inline.anyPunctuation.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);\n        }\n        let keepPrevChar = false;\n        let prevChar = '';\n        while (src) {\n            if (!keepPrevChar) {\n                prevChar = '';\n            }\n            keepPrevChar = false;\n            let token;\n            // extensions\n            if (this.options.extensions?.inline?.some((extTokenizer) => {\n                if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\n                    src = src.substring(token.raw.length);\n                    tokens.push(token);\n                    return true;\n                }\n                return false;\n            })) {\n                continue;\n            }\n            // escape\n            if (token = this.tokenizer.escape(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // tag\n            if (token = this.tokenizer.tag(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // link\n            if (token = this.tokenizer.link(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // reflink, nolink\n            if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n                src = src.substring(token.raw.length);\n                const lastToken = tokens.at(-1);\n                if (token.type === 'text' && lastToken?.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // em & strong\n            if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // code\n            if (token = this.tokenizer.codespan(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // br\n            if (token = this.tokenizer.br(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // del (gfm)\n            if (token = this.tokenizer.del(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // autolink\n            if (token = this.tokenizer.autolink(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // url (gfm)\n            if (!this.state.inLink && (token = this.tokenizer.url(src))) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // text\n            // prevent inlineText consuming extensions by clipping 'src' to extension start\n            let cutSrc = src;\n            if (this.options.extensions?.startInline) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startInline.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({ lexer: this }, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (token = this.tokenizer.inlineText(cutSrc)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.slice(-1) !== '_') { // Track prevChar before string of ____ started\n                    prevChar = token.raw.slice(-1);\n                }\n                keepPrevChar = true;\n                const lastToken = tokens.at(-1);\n                if (lastToken?.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                }\n                else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n        return tokens;\n    }\n}\n\n/**\n * Renderer\n */\nclass _Renderer {\n    options;\n    parser; // set by the parser\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    space(token) {\n        return '';\n    }\n    code({ text, lang, escaped }) {\n        const langString = (lang || '').match(other.notSpaceStart)?.[0];\n        const code = text.replace(other.endingNewline, '') + '\\n';\n        if (!langString) {\n            return '<pre><code>'\n                + (escaped ? code : escape(code, true))\n                + '</code></pre>\\n';\n        }\n        return '<pre><code class=\"language-'\n            + escape(langString)\n            + '\">'\n            + (escaped ? code : escape(code, true))\n            + '</code></pre>\\n';\n    }\n    blockquote({ tokens }) {\n        const body = this.parser.parse(tokens);\n        return `<blockquote>\\n${body}</blockquote>\\n`;\n    }\n    html({ text }) {\n        return text;\n    }\n    heading({ tokens, depth }) {\n        return `<h${depth}>${this.parser.parseInline(tokens)}</h${depth}>\\n`;\n    }\n    hr(token) {\n        return '<hr>\\n';\n    }\n    list(token) {\n        const ordered = token.ordered;\n        const start = token.start;\n        let body = '';\n        for (let j = 0; j < token.items.length; j++) {\n            const item = token.items[j];\n            body += this.listitem(item);\n        }\n        const type = ordered ? 'ol' : 'ul';\n        const startAttr = (ordered && start !== 1) ? (' start=\"' + start + '\"') : '';\n        return '<' + type + startAttr + '>\\n' + body + '</' + type + '>\\n';\n    }\n    listitem(item) {\n        let itemBody = '';\n        if (item.task) {\n            const checkbox = this.checkbox({ checked: !!item.checked });\n            if (item.loose) {\n                if (item.tokens[0]?.type === 'paragraph') {\n                    item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n                    if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {\n                        item.tokens[0].tokens[0].text = checkbox + ' ' + escape(item.tokens[0].tokens[0].text);\n                        item.tokens[0].tokens[0].escaped = true;\n                    }\n                }\n                else {\n                    item.tokens.unshift({\n                        type: 'text',\n                        raw: checkbox + ' ',\n                        text: checkbox + ' ',\n                        escaped: true,\n                    });\n                }\n            }\n            else {\n                itemBody += checkbox + ' ';\n            }\n        }\n        itemBody += this.parser.parse(item.tokens, !!item.loose);\n        return `<li>${itemBody}</li>\\n`;\n    }\n    checkbox({ checked }) {\n        return '<input '\n            + (checked ? 'checked=\"\" ' : '')\n            + 'disabled=\"\" type=\"checkbox\">';\n    }\n    paragraph({ tokens }) {\n        return `<p>${this.parser.parseInline(tokens)}</p>\\n`;\n    }\n    table(token) {\n        let header = '';\n        // header\n        let cell = '';\n        for (let j = 0; j < token.header.length; j++) {\n            cell += this.tablecell(token.header[j]);\n        }\n        header += this.tablerow({ text: cell });\n        let body = '';\n        for (let j = 0; j < token.rows.length; j++) {\n            const row = token.rows[j];\n            cell = '';\n            for (let k = 0; k < row.length; k++) {\n                cell += this.tablecell(row[k]);\n            }\n            body += this.tablerow({ text: cell });\n        }\n        if (body)\n            body = `<tbody>${body}</tbody>`;\n        return '<table>\\n'\n            + '<thead>\\n'\n            + header\n            + '</thead>\\n'\n            + body\n            + '</table>\\n';\n    }\n    tablerow({ text }) {\n        return `<tr>\\n${text}</tr>\\n`;\n    }\n    tablecell(token) {\n        const content = this.parser.parseInline(token.tokens);\n        const type = token.header ? 'th' : 'td';\n        const tag = token.align\n            ? `<${type} align=\"${token.align}\">`\n            : `<${type}>`;\n        return tag + content + `</${type}>\\n`;\n    }\n    /**\n     * span level renderer\n     */\n    strong({ tokens }) {\n        return `<strong>${this.parser.parseInline(tokens)}</strong>`;\n    }\n    em({ tokens }) {\n        return `<em>${this.parser.parseInline(tokens)}</em>`;\n    }\n    codespan({ text }) {\n        return `<code>${escape(text, true)}</code>`;\n    }\n    br(token) {\n        return '<br>';\n    }\n    del({ tokens }) {\n        return `<del>${this.parser.parseInline(tokens)}</del>`;\n    }\n    link({ href, title, tokens }) {\n        const text = this.parser.parseInline(tokens);\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = '<a href=\"' + href + '\"';\n        if (title) {\n            out += ' title=\"' + (escape(title)) + '\"';\n        }\n        out += '>' + text + '</a>';\n        return out;\n    }\n    image({ href, title, text }) {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return escape(text);\n        }\n        href = cleanHref;\n        let out = `<img src=\"${href}\" alt=\"${text}\"`;\n        if (title) {\n            out += ` title=\"${escape(title)}\"`;\n        }\n        out += '>';\n        return out;\n    }\n    text(token) {\n        return 'tokens' in token && token.tokens\n            ? this.parser.parseInline(token.tokens)\n            : ('escaped' in token && token.escaped ? token.text : escape(token.text));\n    }\n}\n\n/**\n * TextRenderer\n * returns only the textual part of the token\n */\nclass _TextRenderer {\n    // no need for block level renderers\n    strong({ text }) {\n        return text;\n    }\n    em({ text }) {\n        return text;\n    }\n    codespan({ text }) {\n        return text;\n    }\n    del({ text }) {\n        return text;\n    }\n    html({ text }) {\n        return text;\n    }\n    text({ text }) {\n        return text;\n    }\n    link({ text }) {\n        return '' + text;\n    }\n    image({ text }) {\n        return '' + text;\n    }\n    br() {\n        return '';\n    }\n}\n\n/**\n * Parsing & Compiling\n */\nclass _Parser {\n    options;\n    renderer;\n    textRenderer;\n    constructor(options) {\n        this.options = options || _defaults;\n        this.options.renderer = this.options.renderer || new _Renderer();\n        this.renderer = this.options.renderer;\n        this.renderer.options = this.options;\n        this.renderer.parser = this;\n        this.textRenderer = new _TextRenderer();\n    }\n    /**\n     * Static Parse Method\n     */\n    static parse(tokens, options) {\n        const parser = new _Parser(options);\n        return parser.parse(tokens);\n    }\n    /**\n     * Static Parse Inline Method\n     */\n    static parseInline(tokens, options) {\n        const parser = new _Parser(options);\n        return parser.parseInline(tokens);\n    }\n    /**\n     * Parse Loop\n     */\n    parse(tokens, top = true) {\n        let out = '';\n        for (let i = 0; i < tokens.length; i++) {\n            const anyToken = tokens[i];\n            // Run any renderer extensions\n            if (this.options.extensions?.renderers?.[anyToken.type]) {\n                const genericToken = anyToken;\n                const ret = this.options.extensions.renderers[genericToken.type].call({ parser: this }, genericToken);\n                if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(genericToken.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n            const token = anyToken;\n            switch (token.type) {\n                case 'space': {\n                    out += this.renderer.space(token);\n                    continue;\n                }\n                case 'hr': {\n                    out += this.renderer.hr(token);\n                    continue;\n                }\n                case 'heading': {\n                    out += this.renderer.heading(token);\n                    continue;\n                }\n                case 'code': {\n                    out += this.renderer.code(token);\n                    continue;\n                }\n                case 'table': {\n                    out += this.renderer.table(token);\n                    continue;\n                }\n                case 'blockquote': {\n                    out += this.renderer.blockquote(token);\n                    continue;\n                }\n                case 'list': {\n                    out += this.renderer.list(token);\n                    continue;\n                }\n                case 'html': {\n                    out += this.renderer.html(token);\n                    continue;\n                }\n                case 'paragraph': {\n                    out += this.renderer.paragraph(token);\n                    continue;\n                }\n                case 'text': {\n                    let textToken = token;\n                    let body = this.renderer.text(textToken);\n                    while (i + 1 < tokens.length && tokens[i + 1].type === 'text') {\n                        textToken = tokens[++i];\n                        body += '\\n' + this.renderer.text(textToken);\n                    }\n                    if (top) {\n                        out += this.renderer.paragraph({\n                            type: 'paragraph',\n                            raw: body,\n                            text: body,\n                            tokens: [{ type: 'text', raw: body, text: body, escaped: true }],\n                        });\n                    }\n                    else {\n                        out += body;\n                    }\n                    continue;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    }\n                    else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n    /**\n     * Parse Inline Tokens\n     */\n    parseInline(tokens, renderer = this.renderer) {\n        let out = '';\n        for (let i = 0; i < tokens.length; i++) {\n            const anyToken = tokens[i];\n            // Run any renderer extensions\n            if (this.options.extensions?.renderers?.[anyToken.type]) {\n                const ret = this.options.extensions.renderers[anyToken.type].call({ parser: this }, anyToken);\n                if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(anyToken.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n            const token = anyToken;\n            switch (token.type) {\n                case 'escape': {\n                    out += renderer.text(token);\n                    break;\n                }\n                case 'html': {\n                    out += renderer.html(token);\n                    break;\n                }\n                case 'link': {\n                    out += renderer.link(token);\n                    break;\n                }\n                case 'image': {\n                    out += renderer.image(token);\n                    break;\n                }\n                case 'strong': {\n                    out += renderer.strong(token);\n                    break;\n                }\n                case 'em': {\n                    out += renderer.em(token);\n                    break;\n                }\n                case 'codespan': {\n                    out += renderer.codespan(token);\n                    break;\n                }\n                case 'br': {\n                    out += renderer.br(token);\n                    break;\n                }\n                case 'del': {\n                    out += renderer.del(token);\n                    break;\n                }\n                case 'text': {\n                    out += renderer.text(token);\n                    break;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    }\n                    else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n}\n\nclass _Hooks {\n    options;\n    block;\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    static passThroughHooks = new Set([\n        'preprocess',\n        'postprocess',\n        'processAllTokens',\n    ]);\n    /**\n     * Process markdown before marked\n     */\n    preprocess(markdown) {\n        return markdown;\n    }\n    /**\n     * Process HTML after marked is finished\n     */\n    postprocess(html) {\n        return html;\n    }\n    /**\n     * Process all tokens before walk tokens\n     */\n    processAllTokens(tokens) {\n        return tokens;\n    }\n    /**\n     * Provide function to tokenize markdown\n     */\n    provideLexer() {\n        return this.block ? _Lexer.lex : _Lexer.lexInline;\n    }\n    /**\n     * Provide function to parse tokens\n     */\n    provideParser() {\n        return this.block ? _Parser.parse : _Parser.parseInline;\n    }\n}\n\nclass Marked {\n    defaults = _getDefaults();\n    options = this.setOptions;\n    parse = this.parseMarkdown(true);\n    parseInline = this.parseMarkdown(false);\n    Parser = _Parser;\n    Renderer = _Renderer;\n    TextRenderer = _TextRenderer;\n    Lexer = _Lexer;\n    Tokenizer = _Tokenizer;\n    Hooks = _Hooks;\n    constructor(...args) {\n        this.use(...args);\n    }\n    /**\n     * Run callback for every token\n     */\n    walkTokens(tokens, callback) {\n        let values = [];\n        for (const token of tokens) {\n            values = values.concat(callback.call(this, token));\n            switch (token.type) {\n                case 'table': {\n                    const tableToken = token;\n                    for (const cell of tableToken.header) {\n                        values = values.concat(this.walkTokens(cell.tokens, callback));\n                    }\n                    for (const row of tableToken.rows) {\n                        for (const cell of row) {\n                            values = values.concat(this.walkTokens(cell.tokens, callback));\n                        }\n                    }\n                    break;\n                }\n                case 'list': {\n                    const listToken = token;\n                    values = values.concat(this.walkTokens(listToken.items, callback));\n                    break;\n                }\n                default: {\n                    const genericToken = token;\n                    if (this.defaults.extensions?.childTokens?.[genericToken.type]) {\n                        this.defaults.extensions.childTokens[genericToken.type].forEach((childTokens) => {\n                            const tokens = genericToken[childTokens].flat(Infinity);\n                            values = values.concat(this.walkTokens(tokens, callback));\n                        });\n                    }\n                    else if (genericToken.tokens) {\n                        values = values.concat(this.walkTokens(genericToken.tokens, callback));\n                    }\n                }\n            }\n        }\n        return values;\n    }\n    use(...args) {\n        const extensions = this.defaults.extensions || { renderers: {}, childTokens: {} };\n        args.forEach((pack) => {\n            // copy options to new object\n            const opts = { ...pack };\n            // set async to true if it was set to true before\n            opts.async = this.defaults.async || opts.async || false;\n            // ==-- Parse \"addon\" extensions --== //\n            if (pack.extensions) {\n                pack.extensions.forEach((ext) => {\n                    if (!ext.name) {\n                        throw new Error('extension name required');\n                    }\n                    if ('renderer' in ext) { // Renderer extensions\n                        const prevRenderer = extensions.renderers[ext.name];\n                        if (prevRenderer) {\n                            // Replace extension with func to run new extension but fall back if false\n                            extensions.renderers[ext.name] = function (...args) {\n                                let ret = ext.renderer.apply(this, args);\n                                if (ret === false) {\n                                    ret = prevRenderer.apply(this, args);\n                                }\n                                return ret;\n                            };\n                        }\n                        else {\n                            extensions.renderers[ext.name] = ext.renderer;\n                        }\n                    }\n                    if ('tokenizer' in ext) { // Tokenizer Extensions\n                        if (!ext.level || (ext.level !== 'block' && ext.level !== 'inline')) {\n                            throw new Error(\"extension level must be 'block' or 'inline'\");\n                        }\n                        const extLevel = extensions[ext.level];\n                        if (extLevel) {\n                            extLevel.unshift(ext.tokenizer);\n                        }\n                        else {\n                            extensions[ext.level] = [ext.tokenizer];\n                        }\n                        if (ext.start) { // Function to check for start of token\n                            if (ext.level === 'block') {\n                                if (extensions.startBlock) {\n                                    extensions.startBlock.push(ext.start);\n                                }\n                                else {\n                                    extensions.startBlock = [ext.start];\n                                }\n                            }\n                            else if (ext.level === 'inline') {\n                                if (extensions.startInline) {\n                                    extensions.startInline.push(ext.start);\n                                }\n                                else {\n                                    extensions.startInline = [ext.start];\n                                }\n                            }\n                        }\n                    }\n                    if ('childTokens' in ext && ext.childTokens) { // Child tokens to be visited by walkTokens\n                        extensions.childTokens[ext.name] = ext.childTokens;\n                    }\n                });\n                opts.extensions = extensions;\n            }\n            // ==-- Parse \"overwrite\" extensions --== //\n            if (pack.renderer) {\n                const renderer = this.defaults.renderer || new _Renderer(this.defaults);\n                for (const prop in pack.renderer) {\n                    if (!(prop in renderer)) {\n                        throw new Error(`renderer '${prop}' does not exist`);\n                    }\n                    if (['options', 'parser'].includes(prop)) {\n                        // ignore options property\n                        continue;\n                    }\n                    const rendererProp = prop;\n                    const rendererFunc = pack.renderer[rendererProp];\n                    const prevRenderer = renderer[rendererProp];\n                    // Replace renderer with func to run extension, but fall back if false\n                    renderer[rendererProp] = (...args) => {\n                        let ret = rendererFunc.apply(renderer, args);\n                        if (ret === false) {\n                            ret = prevRenderer.apply(renderer, args);\n                        }\n                        return ret || '';\n                    };\n                }\n                opts.renderer = renderer;\n            }\n            if (pack.tokenizer) {\n                const tokenizer = this.defaults.tokenizer || new _Tokenizer(this.defaults);\n                for (const prop in pack.tokenizer) {\n                    if (!(prop in tokenizer)) {\n                        throw new Error(`tokenizer '${prop}' does not exist`);\n                    }\n                    if (['options', 'rules', 'lexer'].includes(prop)) {\n                        // ignore options, rules, and lexer properties\n                        continue;\n                    }\n                    const tokenizerProp = prop;\n                    const tokenizerFunc = pack.tokenizer[tokenizerProp];\n                    const prevTokenizer = tokenizer[tokenizerProp];\n                    // Replace tokenizer with func to run extension, but fall back if false\n                    // @ts-expect-error cannot type tokenizer function dynamically\n                    tokenizer[tokenizerProp] = (...args) => {\n                        let ret = tokenizerFunc.apply(tokenizer, args);\n                        if (ret === false) {\n                            ret = prevTokenizer.apply(tokenizer, args);\n                        }\n                        return ret;\n                    };\n                }\n                opts.tokenizer = tokenizer;\n            }\n            // ==-- Parse Hooks extensions --== //\n            if (pack.hooks) {\n                const hooks = this.defaults.hooks || new _Hooks();\n                for (const prop in pack.hooks) {\n                    if (!(prop in hooks)) {\n                        throw new Error(`hook '${prop}' does not exist`);\n                    }\n                    if (['options', 'block'].includes(prop)) {\n                        // ignore options and block properties\n                        continue;\n                    }\n                    const hooksProp = prop;\n                    const hooksFunc = pack.hooks[hooksProp];\n                    const prevHook = hooks[hooksProp];\n                    if (_Hooks.passThroughHooks.has(prop)) {\n                        // @ts-expect-error cannot type hook function dynamically\n                        hooks[hooksProp] = (arg) => {\n                            if (this.defaults.async) {\n                                return Promise.resolve(hooksFunc.call(hooks, arg)).then(ret => {\n                                    return prevHook.call(hooks, ret);\n                                });\n                            }\n                            const ret = hooksFunc.call(hooks, arg);\n                            return prevHook.call(hooks, ret);\n                        };\n                    }\n                    else {\n                        // @ts-expect-error cannot type hook function dynamically\n                        hooks[hooksProp] = (...args) => {\n                            let ret = hooksFunc.apply(hooks, args);\n                            if (ret === false) {\n                                ret = prevHook.apply(hooks, args);\n                            }\n                            return ret;\n                        };\n                    }\n                }\n                opts.hooks = hooks;\n            }\n            // ==-- Parse WalkTokens extensions --== //\n            if (pack.walkTokens) {\n                const walkTokens = this.defaults.walkTokens;\n                const packWalktokens = pack.walkTokens;\n                opts.walkTokens = function (token) {\n                    let values = [];\n                    values.push(packWalktokens.call(this, token));\n                    if (walkTokens) {\n                        values = values.concat(walkTokens.call(this, token));\n                    }\n                    return values;\n                };\n            }\n            this.defaults = { ...this.defaults, ...opts };\n        });\n        return this;\n    }\n    setOptions(opt) {\n        this.defaults = { ...this.defaults, ...opt };\n        return this;\n    }\n    lexer(src, options) {\n        return _Lexer.lex(src, options ?? this.defaults);\n    }\n    parser(tokens, options) {\n        return _Parser.parse(tokens, options ?? this.defaults);\n    }\n    parseMarkdown(blockType) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const parse = (src, options) => {\n            const origOpt = { ...options };\n            const opt = { ...this.defaults, ...origOpt };\n            const throwError = this.onError(!!opt.silent, !!opt.async);\n            // throw error if an extension set async to true but parse was called with async: false\n            if (this.defaults.async === true && origOpt.async === false) {\n                return throwError(new Error('marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise.'));\n            }\n            // throw error in case of non string input\n            if (typeof src === 'undefined' || src === null) {\n                return throwError(new Error('marked(): input parameter is undefined or null'));\n            }\n            if (typeof src !== 'string') {\n                return throwError(new Error('marked(): input parameter is of type '\n                    + Object.prototype.toString.call(src) + ', string expected'));\n            }\n            if (opt.hooks) {\n                opt.hooks.options = opt;\n                opt.hooks.block = blockType;\n            }\n            const lexer = opt.hooks ? opt.hooks.provideLexer() : (blockType ? _Lexer.lex : _Lexer.lexInline);\n            const parser = opt.hooks ? opt.hooks.provideParser() : (blockType ? _Parser.parse : _Parser.parseInline);\n            if (opt.async) {\n                return Promise.resolve(opt.hooks ? opt.hooks.preprocess(src) : src)\n                    .then(src => lexer(src, opt))\n                    .then(tokens => opt.hooks ? opt.hooks.processAllTokens(tokens) : tokens)\n                    .then(tokens => opt.walkTokens ? Promise.all(this.walkTokens(tokens, opt.walkTokens)).then(() => tokens) : tokens)\n                    .then(tokens => parser(tokens, opt))\n                    .then(html => opt.hooks ? opt.hooks.postprocess(html) : html)\n                    .catch(throwError);\n            }\n            try {\n                if (opt.hooks) {\n                    src = opt.hooks.preprocess(src);\n                }\n                let tokens = lexer(src, opt);\n                if (opt.hooks) {\n                    tokens = opt.hooks.processAllTokens(tokens);\n                }\n                if (opt.walkTokens) {\n                    this.walkTokens(tokens, opt.walkTokens);\n                }\n                let html = parser(tokens, opt);\n                if (opt.hooks) {\n                    html = opt.hooks.postprocess(html);\n                }\n                return html;\n            }\n            catch (e) {\n                return throwError(e);\n            }\n        };\n        return parse;\n    }\n    onError(silent, async) {\n        return (e) => {\n            e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n            if (silent) {\n                const msg = '<p>An error occurred:</p><pre>'\n                    + escape(e.message + '', true)\n                    + '</pre>';\n                if (async) {\n                    return Promise.resolve(msg);\n                }\n                return msg;\n            }\n            if (async) {\n                return Promise.reject(e);\n            }\n            throw e;\n        };\n    }\n}\n\nconst markedInstance = new Marked();\nfunction marked(src, opt) {\n    return markedInstance.parse(src, opt);\n}\n/**\n * Sets the default options.\n *\n * @param options Hash of options\n */\nmarked.options =\n    marked.setOptions = function (options) {\n        markedInstance.setOptions(options);\n        marked.defaults = markedInstance.defaults;\n        changeDefaults(marked.defaults);\n        return marked;\n    };\n/**\n * Gets the original marked default options.\n */\nmarked.getDefaults = _getDefaults;\nmarked.defaults = _defaults;\n/**\n * Use Extension\n */\nmarked.use = function (...args) {\n    markedInstance.use(...args);\n    marked.defaults = markedInstance.defaults;\n    changeDefaults(marked.defaults);\n    return marked;\n};\n/**\n * Run callback for every token\n */\nmarked.walkTokens = function (tokens, callback) {\n    return markedInstance.walkTokens(tokens, callback);\n};\n/**\n * Compiles markdown to HTML without enclosing `p` tag.\n *\n * @param src String of markdown source to be compiled\n * @param options Hash of options\n * @return String of compiled HTML\n */\nmarked.parseInline = markedInstance.parseInline;\n/**\n * Expose\n */\nmarked.Parser = _Parser;\nmarked.parser = _Parser.parse;\nmarked.Renderer = _Renderer;\nmarked.TextRenderer = _TextRenderer;\nmarked.Lexer = _Lexer;\nmarked.lexer = _Lexer.lex;\nmarked.Tokenizer = _Tokenizer;\nmarked.Hooks = _Hooks;\nmarked.parse = marked;\nconst options = marked.options;\nconst setOptions = marked.setOptions;\nconst use = marked.use;\nconst walkTokens = marked.walkTokens;\nconst parseInline = marked.parseInline;\nconst parse = marked;\nconst parser = _Parser.parse;\nconst lexer = _Lexer.lex;\n\nexport { _Hooks as Hooks, _Lexer as Lexer, Marked, _Parser as Parser, _Renderer as Renderer, _TextRenderer as TextRenderer, _Tokenizer as Tokenizer, _defaults as defaults, _getDefaults as getDefaults, lexer, marked, options, parse, parseInline, parser, setOptions, use, walkTokens };\n//# sourceMappingURL=marked.esm.js.map\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office */\nimport { marked } from 'marked';\n\n// Import image assets\nimport michaelBlackLogo from '../../assets/michael-black.png';\nimport michaelWhiteLogo from '../../assets/michael-white.png';\nimport meetMichaelBlackLogo from '../../assets/meet-michael-black.png';\nimport meetMichaelWhiteLogo from '../../assets/meet-michael-white.png';\n\n// Safety settings for Gemini API\nconst safetySettings = [{\n  category: \"HARM_CATEGORY_HARASSMENT\",\n  threshold: \"BLOCK_NONE\"\n},\n{\n  category: \"HARM_CATEGORY_HATE_SPEECH\",\n  threshold: \"BLOCK_NONE\"\n},\n{\n  category: \"HARM_CATEGORY_SEXUALLY_EXPLICIT\",\n  threshold: \"BLOCK_NONE\"\n},\n{\n  category: \"HARM_CATEGORY_DANGEROUS_CONTENT\",\n  threshold: \"BLOCK_NONE\"\n}];\n\nconst TYPES = {\n  SUMMARIZE: 0,\n  TRANSLATE: 1,\n  TRANSLATE_SUMMARIZE: 2,\n  REPLY: 3,\n  CALENDAR: 4\n};\n\n// Default templates\nconst DEFAULT_TEMPLATES = {\n  summarize: `You are an expert researcher. Your task is to review the provided research document and complete the following tasks with academic depth and varied sentence structures:\n\n1. Summarize the Research Background:\n   - Provide a concise yet comprehensive summary of the study's background, including its context and motivation.\n\n2. Extract the Problem Statement:\n   - Clearly identify and articulate the central problem or challenge addressed by the research.\n\n3. Identify Strengths:\n   - List 3–5 key strengths of the study, focusing on aspects such as methodology, innovation, robustness of results, or any other notable positive attributes.\n\n4. Identify Weaknesses:\n   - Enumerate 4–5 significant weaknesses or limitations present in the research, considering issues like methodological gaps, limited scope, or areas lacking clarity.\n\n5. Propose Research Topics:\n   - Based on the weaknesses identified, suggest three potential research topics that could address these limitations or explore related areas further.\n\n6. Include a \"tl;dr\" Section:\n   - At the very top of your response, provide a succinct \"tl;dr\" summary without any syntax highlighting that encapsulates the main points and any necessary takeaways.\n\nDo not include any extraneous messages, introductions, or commentary. Your final output should strictly adhere to these instructions.\n\nSubject: {subject}\nContent:\n{content}`,\n  translate: `You are an expert translator and interpreter with extensive proficiency in various languages, specializing in translating texts into polished, academic Korean. Your task is to translate the provided text from the source language into Korean, ensuring that every nuance, stylistic detail, and analytical aspect is accurately and naturally conveyed. Please follow these guidelines:\n\nPreserve Nuance and Style:\n- Accurately reflect the original text's tone, emotional nuance, and stylistic characteristics in Korean.\n- Adapt idiomatic expressions, metaphors, and culturally specific references to ensure they resonate with Korean readers.\n\nMaintain Analytical Precision:\n- Carefully dissect complex sentences and ideas, ensuring that your translation maintains the original text's logical flow and depth of analysis.\n- Where necessary, integrate brief annotations or contextual clarifications to help convey any cultural or conceptual subtleties.\n\nEnsure Accuracy and Consistency:\n- Translate specialized vocabulary, technical terms, and academic language with precision and maintain consistency throughout the text.\n- Verify that the structure and argumentative progression of the source material are preserved in the Korean version.\n\nUphold Contextual Integrity:\n- Ensure that the overall message and intent of the original text are fully maintained in your translation.\n- Make sure that transitions between ideas and sections remain coherent and logically connected in Korean.\n\nReview and Refine:\n- Reassess your translation for any potential ambiguities or loss of nuance, refining as necessary to enhance clarity and precision.\n- Strive for a balanced outcome that honors the original text while ensuring the translation is engaging and accessible to a Korean audience.\n\nProvide tl;dr at the top:\nWrite a tl;dr section at the top of your response that summarizes the main points and todos if needed.\n\nDeliver your final translation in refined, academic Korean that faithfully embodies the original text's analytical and stylistic essence.\n\nSubject: {subject}\n\nContent:\n{content}`,\n  translateSummarize: `You are an expert translator and summarizer with extensive proficiency in various languages, specializing in translating texts into polished, academic Korean. Your task is to translate the provided text from the source language into Korean AND create a concise summary of the main points. Please follow these guidelines:\n\nTranslation Aspects:\n- Accurately reflect the original text's tone, emotional nuance, and stylistic characteristics in Korean.\n- Adapt idiomatic expressions, metaphors, and culturally specific references to ensure they resonate with Korean readers.\n- Maintain analytical precision and logical flow in the Korean translation.\n\nSummarization Requirements:\n- Create a concise and focused summary of the key points in Korean.\n- Prioritize clarity and brevity while maintaining the essential meaning.\n- Ensure the summary captures the main ideas, arguments, and conclusions.\n- Limit the summary to approximately 30-40% of the original length.\n\nFinal Delivery Format:\n1. First provide tl;dr at the top:\nWrite a tl;dr section at the top of your response that summarizes the main points and todos if needed.\n2. Then provide a concise summary section (제목: 요약)\n3. Then provide the full translation (제목: 전체 번역)\n\nSubject: {subject}\n\nContent:\n{content}`,\n  reply: `You are an expert assistant that can help me with my email. I will provide you with the email content and you will help me with the following tasks:\n\n  Write a reply to the email.\n\n  Subject: {subject}\n\n  Content:\n  {content}\n  in {language}`,\n  tldrPrompt: `Please provide a very concise summary in {language} of the following content. Focus on the main points and key takeaways. Do not include any extraneous messages, introductions, or commentary. Your final output should strictly adhere to these instructions.\n\n  Subject: {subject}\n\n  Content:\n  {content}`\n};\n\nOffice.onReady((info) => {\n    if (info.host === Office.HostType.Outlook) {\n        document.getElementById(\"sideload-msg\").style.display = \"none\";\n        document.getElementById(\"app-body\").style.display = \"flex\";\n\n        // Initialize the application\n        initializeApp();\n\n        // Check if autorun is enabled and get the selected option\n        let autorunEnabled = false;\n        let selectedOption = null;\n        try {\n            const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n            if (savedSettings) {\n                const settings = JSON.parse(savedSettings);\n                autorunEnabled = settings.autorun === 'true';\n                selectedOption = settings.autorunOption;\n            }\n        } catch (error) {\n            console.error('Error getting autorun settings:', error);\n        }\n\n        // If autorun is enabled and an option is selected, execute it\n        if (autorunEnabled && selectedOption) {\n            switch (selectedOption) {\n                case 'summarize':\n                    summarizeEmail();\n                    break;\n                case 'translate':\n                    translateEmail();\n                    break;\n                case 'translateAndSummarize':\n                    translateAndSummarizeEmail();\n                    break;\n                case 'reply':\n                    generateReply();\n                    break;\n            }\n        }\n\n        // Add event listeners for the application buttons\n        document.getElementById(\"summarize\").addEventListener(\"click\", summarizeEmail);\n        document.getElementById(\"translate\").addEventListener(\"click\", translateEmail);\n        document.getElementById(\"translate-summarize\").addEventListener(\"click\", translateAndSummarizeEmail);\n        document.getElementById(\"calendar-event\").addEventListener(\"click\", handleCalendarEvent);\n        document.getElementById(\"settings-toggle\").addEventListener(\"click\", toggleSettingsDropdown);\n        document.getElementById(\"dropdown-close-settings\").addEventListener(\"click\", toggleSettingsDropdown);\n        document.getElementById(\"dropdown-save-settings\").addEventListener(\"click\", saveDropdownSettings);\n        document.getElementById(\"dropdown-reset-all\").addEventListener(\"click\", resetAllSettings);\n        document.getElementById(\"dropdown-export-markdown\").addEventListener(\"click\", exportTemplatesAsMarkdown);\n        document.getElementById(\"dropdown-api-key\").addEventListener(\"keypress\", (event) => {\n            if (event.key === \"Enter\") {\n                saveDropdownSettings();\n            }\n        });\n\n        // Add dev mode toggle listener\n        document.getElementById(\"dropdown-dev-mode\").addEventListener(\"change\", function() {\n            const devServerGroup = document.getElementById(\"dev-server-group\");\n            devServerGroup.style.display = this.value === \"true\" ? \"block\" : \"none\";\n        });\n\n        // Settings selection change listeners\n        document.querySelectorAll(\".settings-dropdown-container select\").forEach(select => {\n            select.addEventListener(\"change\", saveDropdownSettings);\n        });\n\n        // Expand button listener\n        document.getElementById(\"expand-content\").addEventListener(\"click\", expandContent);\n\n        // Copy buttons listeners\n        document.getElementById(\"copy-result\").addEventListener(\"click\", copyResult);\n        document.getElementById(\"generate-reply\").addEventListener(\"click\", generateReply);\n\n        // Load saved settings if any\n        loadDropdownSettings();\n\n        // Apply current theme\n        applyCurrentTheme();\n\n        // Register for theme change events\n        if (Office.context.mailbox.addHandlerAsync) {\n            Office.context.mailbox.addHandlerAsync(\n                Office.EventType.SettingsChanged,\n                onSettingsChanged\n            );\n        }\n\n        // Add event handler for email selection\n        Office.context.mailbox.addHandlerAsync(\n            Office.EventType.ItemChanged,\n            function (args) {\n                // Check if autorun is enabled and get the selected option\n                let autorunEnabled = false;\n                let selectedOption = null;\n                try {\n                    const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n                    if (savedSettings) {\n                        const settings = JSON.parse(savedSettings);\n                        autorunEnabled = settings.autorun === 'true';\n                        selectedOption = settings.autorunOption;\n                    }\n                } catch (error) {\n                    console.error('Error getting autorun settings:', error);\n                }\n\n                // If autorun is enabled and an option is selected, execute it\n                if (autorunEnabled && selectedOption) {\n                    switch (selectedOption) {\n                        case 'summarize':\n                            summarizeEmail();\n                            break;\n                        case 'translate':\n                            translateEmail();\n                            break;\n                        case 'translateAndSummarize':\n                            translateAndSummarizeEmail();\n                            break;\n                        case 'reply':\n                            generateReply();\n                            break;\n                    }\n                }\n            },\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Succeeded) {\n                    result.value.addHandlerAsync(\n                        Office.EventType.ItemChanged,\n                        function (args) {\n                            // Check if autorun is enabled and get the selected option\n                            let autorunEnabled = false;\n                            let selectedOption = null;\n                            try {\n                                const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n                                if (savedSettings) {\n                                    const settings = JSON.parse(savedSettings);\n                                    autorunEnabled = settings.autorun === 'true';\n                                    selectedOption = settings.autorunOption;\n                                }\n                            } catch (error) {\n                                console.error('Error getting autorun settings:', error);\n                            }\n\n                            // If autorun is enabled and an option is selected, execute it\n                            if (autorunEnabled && selectedOption) {\n                                switch (selectedOption) {\n                                    case 'summarize':\n                                        summarizeEmail();\n                                        break;\n                                    case 'translate':\n                                        translateEmail();\n                                        break;\n                                    case 'translateAndSummarize':\n                                        translateAndSummarizeEmail();\n                                        break;\n                                    case 'reply':\n                                        generateReply();\n                                        break;\n                                }\n                            }\n                        },\n                        function (result) {\n                            if (result.status === Office.AsyncResultStatus.Succeeded) {\n                                result.value.register();\n                            }\n                        }\n                    );\n                }\n            }\n        );\n\n        // Update calendar button state when email changes\n        Office.context.mailbox.addHandlerAsync(\n            Office.EventType.ItemChanged,\n            function (args) {\n                updateCalendarButtonState();\n            },\n            function (result) {\n                if (result.status === Office.AsyncResultStatus.Succeeded) {\n                    result.value.addHandlerAsync(\n                        Office.EventType.ItemChanged,\n                        function (args) {\n                            updateCalendarButtonState();\n                        }\n                    );\n                }\n            }\n        );\n\n        // Initial calendar button state update\n        updateCalendarButtonState();\n    }\n});\n\n/**\n * Toggle the visibility of the settings dropdown\n */\nfunction toggleSettingsDropdown() {\n  const dropdown = document.getElementById(\"settings-dropdown\");\n  if (dropdown) {\n    const isVisible = dropdown.style.display === \"block\";\n    dropdown.style.display = isVisible ? \"none\" : \"block\";\n  }\n}\n\n// Make the function available globally\nwindow.toggleSettingsDropdown = toggleSettingsDropdown;\n\n/**\n * Apply the current theme based on user preference or Office theme\n */\nfunction applyCurrentTheme() {\n  // Default to dark theme instead of system\n  const savedTheme = localStorage.getItem('theme') || 'dark';\n\n  if (savedTheme === 'light') {\n    document.body.setAttribute('data-theme', 'light');\n    document.body.classList.remove('dark-theme');\n  } else if (savedTheme === 'dark') {\n    document.body.setAttribute('data-theme', 'dark');\n    document.body.classList.add('dark-theme');\n  } else {\n    // Use Office theme\n    if (Office.context.officeTheme) {\n      const bodyBackgroundColor = Office.context.officeTheme.bodyBackgroundColor;\n      // Only call isDarkTheme if bodyBackgroundColor exists\n      if (bodyBackgroundColor) {\n        if (isDarkTheme(bodyBackgroundColor)) {\n          document.body.setAttribute('data-theme', 'dark');\n          document.body.classList.add('dark-theme');\n        } else {\n          document.body.setAttribute('data-theme', 'light');\n          document.body.classList.remove('dark-theme');\n        }\n      } else {\n        // Default to dark theme if no color information\n        document.body.setAttribute('data-theme', 'dark');\n        document.body.classList.add('dark-theme');\n      }\n    }\n  }\n\n  // ----- Logo Switching Logic Start -----\n  const sideloadLogo = document.getElementById('sideload-logo');\n  const landingLogo = document.getElementById('landing-logo-main');\n  const brandLogo = document.getElementById('brand-logo');\n\n  // Determine correct image sources based on theme using imported variables\n  const meetMichaelSrc = document.body.classList.contains('dark-theme') ? meetMichaelWhiteLogo : meetMichaelBlackLogo;\n  const michaelSrc = document.body.classList.contains('dark-theme') ? michaelWhiteLogo : michaelBlackLogo;\n\n  // Set logo sources\n  if (sideloadLogo) {\n    sideloadLogo.src = meetMichaelSrc;\n  }\n  if (landingLogo) {\n    landingLogo.src = meetMichaelSrc;\n  }\n  if (brandLogo) {\n    brandLogo.src = michaelSrc;\n  }\n  // ----- Logo Switching Logic End -----\n}\n\n/**\n * Determine if a color is dark by converting it to RGB and calculating perceived brightness\n * @param {string} color - Hex color code\n * @returns {boolean} - True if the color is dark\n */\nfunction isDarkTheme(color) {\n  // If color is undefined or not a string, default to light theme\n  if (!color || typeof color !== 'string') {\n    return false;\n  }\n\n  try {\n    // Convert hex to RGB\n    color = color.replace('#', '');\n    const r = parseInt(color.substr(0, 2), 16);\n    const g = parseInt(color.substr(2, 2), 16);\n    const b = parseInt(color.substr(4, 2), 16);\n\n    // Check if we got valid RGB values\n    if (isNaN(r) || isNaN(g) || isNaN(b)) {\n      return false;\n    }\n\n    // Calculate perceived brightness using the formula: (0.299*R + 0.587*G + 0.114*B)\n    const brightness = (0.299 * r + 0.587 * g + 0.114 * b);\n\n    // If brightness is less than 128, consider it dark\n    return brightness < 128;\n  } catch (error) {\n    console.error(\"Error calculating theme brightness:\", error);\n    return false;\n  }\n}\n\n/**\n * Handle Office theme change event\n */\nfunction onSettingsChanged(eventArgs) {\n  const savedTheme = localStorage.getItem('theme') || 'system';\n  if (savedTheme === 'system') {\n    applyCurrentTheme();\n  }\n}\n\n/**\n * Show notification message\n */\nfunction showNotification(message, type = \"info\") {\n  // Remove any existing notification\n  const existingNotification = document.getElementById(\"notification\");\n  if (existingNotification) {\n    existingNotification.remove();\n  }\n\n  // Create new notification element\n  const notification = document.createElement(\"div\");\n  notification.id = \"notification\";\n  notification.className = `notification ${type}`;\n  notification.textContent = message;\n\n  // Add to document\n  document.body.appendChild(notification);\n\n  // Force reflow to ensure animation plays\n  notification.offsetHeight;\n\n  // Add slide-in animation\n  notification.style.animation = \"slideInFromTop 0.3s ease-out\";\n\n  // Set timeout to remove notification\n  setTimeout(() => {\n    // Add slide-out animation\n    notification.style.animation = \"slideOutToTop 0.3s ease-out\";\n\n    // Remove element after animation\n    setTimeout(() => {\n      notification.remove();\n    }, 300);\n  }, 3000);\n}\n\n/**\n * Save settings from the dropdown menu\n */\nfunction saveDropdownSettings() {\n  // Get existing settings\n  let settings = {};\n  try {\n    const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n    if (savedSettings) {\n      settings = JSON.parse(savedSettings);\n    }\n  } catch (error) {\n    console.error('Error parsing settings:', error);\n  }\n\n  // Update with values from dropdown form\n  const apiKey = document.getElementById('dropdown-api-key').value;\n  // Get model from input field\n  const model = document.getElementById('dropdown-model').value;\n  const language = document.getElementById('dropdown-language').value;\n  const eventTitleLanguage = document.getElementById('dropdown-event-title-language').value;\n  const theme = document.getElementById('dropdown-theme').value;\n  const fontSize = document.getElementById('dropdown-font-size').value;\n  const tldrMode = document.getElementById('dropdown-tldr-mode').value;\n  const showReply = document.getElementById('dropdown-show-reply').value;\n  // Get reply template\n  const replyTemplate = document.getElementById('dropdown-reply-template').value;\n  const autorun = document.getElementById('dropdown-autorun').value;\n  const autorunOption = document.getElementById('dropdown-autorun-option').value;\n  const devMode = document.getElementById('dropdown-dev-mode').value;\n  const devServer = document.getElementById('dropdown-dev-server').value;\n  const summarizeTemplate = document.getElementById('dropdown-summarize-template').value;\n  const translateTemplate = document.getElementById('dropdown-translate-template').value;\n  const translateSummarizeTemplate = document.getElementById('dropdown-translate-summarize-template').value;\n\n  // Update settings object\n  settings.apiKey = apiKey;\n  settings.model = model; // Save model from input\n  settings.defaultLanguage = language;\n  settings.eventTitleLanguage = eventTitleLanguage;\n  settings.theme = theme;\n  settings.fontSize = fontSize;\n  settings.tldrMode = tldrMode;\n  settings.showReply = showReply;\n  settings.replyModel = replyTemplate;\n  settings.autorun = autorun;\n  settings.autorunOption = autorunOption;\n  settings.devMode = devMode;\n  settings.devServer = devServer;\n\n  // Make sure templates object exists\n  if (!settings.templates) {\n    settings.templates = {};\n  }\n\n  settings.templates.summarize = summarizeTemplate;\n  settings.templates.translate = translateTemplate;\n  settings.templates.translateSummarize = translateSummarizeTemplate;\n  // Save reply template\n  settings.templates.reply = replyTemplate;\n\n  // Save settings\n  localStorage.setItem('my_sidekick_michael_settings', JSON.stringify(settings));\n\n  // Save API key separately\n  if (apiKey) {\n    localStorage.setItem(\"my_sidekick_michael_api_key\", apiKey);\n  } else {\n    localStorage.removeItem(\"my_sidekick_michael_api_key\"); // Remove if empty\n  }\n\n  // Apply theme if changed\n  localStorage.setItem('theme', theme);\n  applyCurrentTheme();\n\n  // Apply font size\n  applyFontSize(fontSize);\n\n  // Update UI for reply button\n  updateReplyButtonVisibility(showReply === 'true');\n\n  // Update dev badges visibility\n  updateDevBadges(devMode === 'true');\n\n  showNotification('All settings saved successfully');\n\n  // Close the dropdown\n  toggleSettingsDropdown();\n}\n\n/**\n * Reset template fields to defaults\n */\nfunction resetTemplates() {\n  // Save default templates back into the main settings object\n  const currentSettingsText = localStorage.getItem(\"my_sidekick_michael_settings\");\n  const currentSettings = currentSettingsText ? JSON.parse(currentSettingsText) : {};\n  currentSettings.templates = DEFAULT_TEMPLATES;\n  localStorage.setItem(\"my_sidekick_michael_settings\", JSON.stringify(currentSettings));\n\n  // Update textareas\n  document.getElementById('dropdown-summarize-template').value = DEFAULT_TEMPLATES.summarize;\n  document.getElementById('dropdown-translate-template').value = DEFAULT_TEMPLATES.translate;\n  if (document.getElementById('dropdown-translate-summarize-template')) {\n    document.getElementById('dropdown-translate-summarize-template').value = DEFAULT_TEMPLATES.translateSummarize;\n  }\n  // Update reply template textarea\n  if (document.getElementById('dropdown-reply-template')) {\n    document.getElementById('dropdown-reply-template').value = DEFAULT_TEMPLATES.reply;\n  }\n  showNotification('Templates reset to defaults');\n}\n\n/**\n * Load saved settings to the dropdown form fields\n */\nfunction loadDropdownSettings() {\n  try {\n    const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n    const apiKey = localStorage.getItem(\"my_sidekick_michael_api_key\");\n\n    // Load main settings\n    if (savedSettings) {\n      const settings = JSON.parse(savedSettings);\n\n      // Set form values\n      if (settings.apiKey) document.getElementById('dropdown-api-key').value = settings.apiKey;\n      // Set model input value\n      if (settings.model) document.getElementById('dropdown-model').value = settings.model;\n      if (settings.defaultLanguage) document.getElementById('dropdown-language').value = settings.defaultLanguage;\n      if (settings.eventTitleLanguage) document.getElementById('dropdown-event-title-language').value = settings.eventTitleLanguage;\n      if (settings.theme) document.getElementById('dropdown-theme').value = settings.theme;\n      if (settings.fontSize) document.getElementById('dropdown-font-size').value = settings.fontSize;\n      if (settings.tldrMode) document.getElementById('dropdown-tldr-mode').value = settings.tldrMode;\n      if (settings.showReply) document.getElementById('dropdown-show-reply').value = settings.showReply;\n      if (settings.devServer) document.getElementById('dropdown-dev-server').value = settings.devServer;\n\n      // Show/hide dev server input based on dev mode\n      const devServerGroup = document.getElementById(\"dev-server-group\");\n      if (devServerGroup) {\n        devServerGroup.style.display = settings.devMode === 'true' ? 'block' : 'none';\n      }\n\n      // Update dev badges visibility\n      updateDevBadges(settings.devMode === 'true');\n\n      // Apply font size if saved\n      if (settings.fontSize) {\n        applyFontSize(settings.fontSize);\n      }\n\n      // Update reply button visibility\n      if (settings.showReply) {\n        updateReplyButtonVisibility(settings.showReply === 'true');\n      }\n\n      // Set templates\n      if (settings.templates) {\n        document.getElementById('dropdown-summarize-template').value = settings.templates.summarize || DEFAULT_TEMPLATES.summarize;\n        document.getElementById('dropdown-translate-template').value = settings.templates.translate || DEFAULT_TEMPLATES.translate;\n        document.getElementById('dropdown-translate-summarize-template').value = settings.templates.translateSummarize || DEFAULT_TEMPLATES.translateSummarize;\n        // Load reply template\n        document.getElementById('dropdown-reply-template').value = settings.templates.reply || DEFAULT_TEMPLATES.reply;\n      } else {\n          // If templates object doesn't exist, load defaults\n          resetTemplates();\n      }\n    } else {\n      // No settings found, load default templates\n      resetTemplates();\n    }\n\n    // Load API key\n    if (apiKey) {\n      document.getElementById('dropdown-api-key').value = apiKey;\n    }\n  } catch (error) {\n    console.error('Error loading dropdown settings:', error);\n    // If there's an error, reset to defaults\n    resetTemplates();\n  }\n}\n\n/**\n * Apply the selected font size to result content\n * @param {string} size - The font size to apply (small, medium, large)\n */\nfunction applyFontSize(size) {\n  document.documentElement.setAttribute('data-font-size', size || 'medium');\n}\n\n// Get email content\nasync function getEmailContent() {\n  return new Promise((resolve, reject) => {\n    Office.context.mailbox.item.body.getAsync(\"text\", (result) => {\n      if (result.status === Office.AsyncResultStatus.Succeeded) {\n        resolve(result.value);\n      } else {\n        reject(new Error(\"Failed to get email content\"));\n      }\n    });\n  });\n}\n\n// Generate content using Gemini API\nasync function generateContent(prompt, apiKey, modelOverride = null, isTldr = false) {\n    // Get model from settings or use default\n    let model = \"gemini-2.0-flash-light\"; // Default model\n\n    if (modelOverride) {\n        model = modelOverride;\n    } else {\n        try {\n            const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n            if (savedSettings) {\n                const settings = JSON.parse(savedSettings);\n                if (settings.model) {\n                    model = settings.model;\n                }\n            }\n        } catch (error) {\n            console.error(\"Error getting model from settings:\", error);\n        }\n    }\n\n    // API URL with selected model\n    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;\n\n    try {\n        const response = await fetch(apiUrl, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                contents: [\n                    {\n                        parts: [\n                            {\n                                text: prompt\n                            }\n                        ]\n                    }\n                ],\n                generationConfig: {\n                    temperature: 0.4,\n                    topK: 32,\n                    topP: 0.95,\n                    maxOutputTokens: isTldr ? 800 : 8192, // Limit tokens for TL;DR\n                },\n                safetySettings: safetySettings\n            })\n        });\n\n        const data = await response.json();\n\n        if (!response.ok) {\n            throw new Error(data.error?.message || 'Error generating content');\n        }\n\n        if (!data.candidates || data.candidates.length === 0) {\n            throw new Error('No content generated');\n        }\n\n        // Extract the generated text\n        const generatedText = data.candidates[0].content.parts[0].text;\n        return generatedText;\n    } catch (error) {\n        console.error('Error generating content:', error);\n        throw error;\n    } finally {\n        // Hide loading spinner only if this is not a TL;DR request\n        if (!isTldr) {\n            document.getElementById(\"loading\").style.display = \"none\";\n        }\n    }\n}\n\n// Generate TL;DR content\nasync function generateTldrContent(prompt, apiKey, language = \"Korean\",modelOverride = null) {\n  const subject = Office.context.mailbox.item.subject;\n  const emailContent = await getEmailContent();\n\n  const tldrPrompt = DEFAULT_TEMPLATES.tldrPrompt\n      .replace('{subject}', subject)\n      .replace('{content}', emailContent)\n      .replace('{language}', language);\n\n  const content = await generateContent(tldrPrompt, apiKey, modelOverride, true);\n  return content;\n}\n\n// Get language display text\nfunction getLanguageText(languageCode) {\n  switch (languageCode) {\n    case \"es\": return \"Spanish\";\n    case \"fr\": return \"French\";\n    case \"de\": return \"German\";\n    case \"it\": return \"Italian\";\n    case \"ja\": return \"Japanese\";\n    case \"ko\": return \"Korean\";\n    case \"zh_cn\": return \"Chinese\";\n    default: return \"English\";\n  }\n}\n\n// Get API key from local storage\nfunction getApiKey() {\n  return localStorage.getItem(\"my_sidekick_michael_api_key\");\n}\n\n// Get language from settings\nfunction getLanguage() {\n  try {\n    const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n    if (savedSettings) {\n      const settings = JSON.parse(savedSettings);\n      if (settings.defaultLanguage) {\n        return settings.defaultLanguage;\n      }\n    }\n    return 'ko'; // Default to Korean\n  } catch (error) {\n    console.error('Error getting language:', error);\n    return 'ko';\n  }\n}\n\n// Summarize email\nasync function summarizeEmail() {\n    const apiKey = getApiKey();\n\n    if (!apiKey) {\n        showNotification(\"Please add your Gemini API key in the settings\", 'error');\n        toggleSettingsDropdown(); // Open settings dropdown to prompt for API key\n        return;\n    }\n\n    // Show loading UI\n    showLoading(\"Summarizing email...\");\n\n    try {\n        const emailContent = await getEmailContent();\n        const subject = Office.context.mailbox.item.subject;\n\n        // Get template from storage or use default\n        let template = DEFAULT_TEMPLATES.summarize;\n        try {\n            const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n            if (savedSettings) {\n                const settings = JSON.parse(savedSettings);\n                if (settings.templates && settings.templates.summarize) {\n                    template = settings.templates.summarize;\n                }\n            }\n        } catch (error) {\n            console.error(\"Error getting template:\", error);\n        }\n\n        // Replace placeholders in template\n        const prompt = template\n            .replace('{subject}', subject)\n            .replace('{content}', emailContent);\n\n        // Check for TL;DR mode\n        let tldrMode = true;\n        try {\n            const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n            if (savedSettings) {\n                const settings = JSON.parse(savedSettings);\n                if (settings.tldrMode) {\n                    tldrMode = settings.tldrMode === 'true';\n                }\n            }\n        } catch (error) {\n            console.error('Error getting TLDR mode setting:', error);\n        }\n\n        if (tldrMode) {\n            // Generate TL;DR first\n            const tldrContent = await generateTldrContent(prompt, apiKey, \"English\");\n            hideLoading();\n            showResults(tldrContent, TYPES.SUMMARIZE);\n\n            // Then generate full content in the background\n            const fullContent = await generateContent(prompt, apiKey);\n\n            // display notification of full content\n            updateResults(fullContent);\n            updateExpandButton(true);\n        } else {\n            // Generate full content only\n            const summary = await generateContent(prompt, apiKey);\n            showResults(summary, TYPES.SUMMARIZE);\n        }\n    } catch (error) {\n        showNotification(`Error: ${error.message}`, 'error');\n    }\n}\n\n// Translate email\nasync function translateEmail() {\n    const apiKey = getApiKey();\n    const language = getLanguage();\n\n    if (!apiKey) {\n        showNotification(\"Please add your Gemini API key in the settings\", 'error');\n        toggleSettingsDropdown(); // Open settings dropdown to prompt for API key\n        return;\n    }\n\n    // Show loading UI\n    showLoading(\"Translating to \" + getLanguageText(language) + \"...\");\n\n    try {\n        const emailContent = await getEmailContent();\n        const subject = Office.context.mailbox.item.subject;\n\n        // Get template from storage or use default\n        let template = DEFAULT_TEMPLATES.translate;\n        try {\n            const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n            if (savedSettings) {\n                const settings = JSON.parse(savedSettings);\n                if (settings.templates && settings.templates.translate) {\n                    template = settings.templates.translate;\n                }\n            }\n        } catch (error) {\n            console.error(\"Error getting template:\", error);\n        }\n\n        // Replace placeholders in template\n        const prompt = template\n            .replace('{subject}', subject)\n            .replace('{content}', emailContent);\n\n        // Check for TL;DR mode\n        let tldrMode = true;\n        try {\n            const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n            if (savedSettings) {\n                const settings = JSON.parse(savedSettings);\n                if (settings.tldrMode) {\n                    tldrMode = settings.tldrMode === 'true';\n                }\n            }\n        } catch (error) {\n            console.error('Error getting TLDR mode setting:', error);\n        }\n\n        if (tldrMode) {\n            // Generate TL;DR first\n            const tldrContent = await generateTldrContent(prompt, apiKey, language);\n            hideLoading();\n            showResults(tldrContent, TYPES.TRANSLATE);\n\n            // Then generate full content in the background\n            const fullContent = await generateContent(prompt, apiKey);\n\n            // display notification of full content\n            updateResults(fullContent);\n            updateExpandButton(true);\n        } else {\n            // Generate full content only\n            const translation = await generateContent(prompt, apiKey, language);\n            showResults(translation, TYPES.TRANSLATE);\n        }\n    } catch (error) {\n        showNotification(`Error: ${error.message}`, 'error');\n    }\n}\n\n/**\n * Update the expand button text and style based on the full content display state\n */\nfunction updateExpandButton(isFullContentVisible) {\n  const expandButton = document.getElementById('expand-content');\n\n  if (expandButton) {\n    expandButton.disabled = !isFullContentVisible;\n    expandButton.classList.toggle('ms-Button--disabled', !isFullContentVisible);\n    expandButton.innerHTML = isFullContentVisible ? 'Show Full Content' : 'Hide Full Content';\n    expandButton.classList.toggle('ms-Button--primary', isFullContentVisible);\n  }\n}\n\n// Copy result to clipboard\nfunction copyResult() {\n  // Check if this is a reply (both TLDR and full content need to be combined)\n  let resultContent = \"\";\n\n  // Get the TLDR content (might contain the subject)\n  const tldrContent = document.getElementById(\"tldr-content\").innerText;\n\n  // Get the full content (might contain the body)\n  const fullContent = document.getElementById(\"result-content\").innerText;\n\n  // Check if this is a reply format\n  const isReply = tldrContent.includes(\"Subject:\") || fullContent.includes(\"Subject:\");\n\n  if (isReply) {\n    // If it's a reply, try to extract and format subject and body properly\n    let subject = \"\";\n    let body = \"\";\n\n    // Try to get subject from headings\n    const headingMatch = /^(?:Subject:\\s*)?(.+?)(?:\\n|$)/i.exec(tldrContent);\n    if (headingMatch) {\n      subject = headingMatch[1].trim();\n    }\n\n    // Get the body text (prioritize full content if visible, otherwise use TLDR minus subject)\n    if (document.getElementById(\"full-content-container\").style.display !== \"none\") {\n      body = fullContent;\n    } else {\n      // Attempt to remove subject line from TLDR if present\n      if (headingMatch) {\n        const lines = tldrContent.split(\"\\n\");\n        body = lines.slice(1).join(\"\\n\").trim();\n      } else {\n        body = tldrContent;\n      }\n    }\n\n    // Format as email reply\n    resultContent = `Subject: ${subject}\\n\\n${body}`;\n  } else {\n    // For normal content, get what's visible (either TLDR or full content)\n    if (document.getElementById(\"full-content-container\").style.display !== \"none\") {\n      resultContent = fullContent;\n    } else {\n      resultContent = tldrContent;\n    }\n  }\n\n  navigator.clipboard.writeText(resultContent).then(() => {\n    const copyStatus = document.getElementById(\"copy-status\");\n    copyStatus.textContent = \"Copied!\";\n    setTimeout(() => {\n      copyStatus.textContent = \"\";\n    }, 2000);\n  }).catch(err => {\n    console.error('Could not copy text: ', err);\n    showNotification(\"Failed to copy to clipboard\", \"error\");\n  });\n}\n\n// Convert markdown to HTML for rendering\nfunction markdownToHtml(markdown) {\n  if (!markdown) return '';\n\n  // Get the current font size from settings\n  let fontSize = 'medium';\n  try {\n    const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n    if (savedSettings) {\n      const settings = JSON.parse(savedSettings);\n      if (settings.fontSize) {\n        fontSize = settings.fontSize;\n      }\n    }\n  } catch (error) {\n    console.error('Error getting font size:', error);\n  }\n\n  // Get font size values\n  const fontSizeValue = fontSize === 'small' ? '13px' :\n                        fontSize === 'large' ? '18px' : '16px';\n\n  const lineHeightValue = fontSize === 'small' ? '1.5' :\n                           fontSize === 'large' ? '1.7' : '1.6';\n\n  const codeFontSize = fontSize === 'small' ? '13px' :\n                        fontSize === 'large' ? '17px' : '15px';\n\n  // Check if this is a reply format (starts with # Re: or similar)\n  const isReply = /^#\\s+(?:Re:|Subject:|\\[Reply\\]|Response:)/i.test(markdown);\n\n  // Simple markdown to HTML conversion\n  let html = markdown\n    // Handle reply format headings specially\n    .replace(/^#\\s+(.*$)/gim, function(match, p1) {\n      if (isReply) {\n        return `<h1 class=\"reply-heading\">${p1}</h1>`;\n      } else {\n        return `<h1>${p1}</h1>`;\n      }\n    })\n    // Other headings\n    .replace(/^###\\s+(.*$)/gim, '<h3>$1</h3>')\n    .replace(/^##\\s+(.*$)/gim, '<h2>$1</h2>')\n\n    // Convert bold and italic with stronger styling\n    .replace(/\\*\\*(.*?)\\*\\*/gim, '<strong style=\"font-weight: 700;\">$1</strong>')\n    .replace(/\\*(.*?)\\*/gim, '<em style=\"font-style: italic;\">$1</em>')\n    .replace(/\\_\\_([^_]+)\\_\\_/gim, '<strong style=\"font-weight: 700;\">$1</strong>')\n    .replace(/\\_([^_]+)\\_/gim, '<em style=\"font-style: italic;\">$1</em>')\n\n    // Convert lists - updated to remove indentation\n    .replace(/^\\s*\\n\\* (.*)/gim, '<ul class=\"no-indent\">\\n<li>$1</li>')\n    .replace(/^\\* (.*)/gim, '<li>$1</li>')\n    .replace(/^\\s*\\n\\d+\\. (.*)/gim, '<ol class=\"no-indent\">\\n<li>$1</li>')\n    .replace(/^\\d+\\. (.*)/gim, '<li>$1</li>')\n\n    // Convert blockquotes with improved styling\n    .replace(/^\\> (.*$)/gim, '<blockquote style=\"border-left: 4px solid var(--accent-color); padding-left: 1em; margin: 1em 0; background-color: rgba(0,0,0,0.03);\">$1</blockquote>')\n\n    // Convert code blocks with improved visibility\n    .replace(/```([\\s\\S]*?)```/gim, '<pre style=\"background-color: var(--code-background); padding: 12px; border-radius: 5px; overflow-x: auto; border: 1px solid var(--border-color);\"><code style=\"font-family: \\'Courier New\\', Courier, monospace; font-size: ' + codeFontSize + ';\">$1</code></pre>')\n    .replace(/`([^`]+)`/gim, '<code style=\"background-color: var(--code-background); padding: 3px 5px; border-radius: 3px; font-family: \\'Courier New\\', Courier, monospace; font-size: ' + codeFontSize + '; font-weight: 500;\">$1</code>')\n\n    // Convert horizontal rules\n    .replace(/^\\-\\-\\-$/gim, '<hr style=\"height: 2px; background-color: var(--border-color); border: 0; margin: 1.5em 0;\">')\n\n    // Convert links with better visibility\n    .replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/gim, '<a href=\"$2\" target=\"_blank\" style=\"color: var(--accent-color); text-decoration: none; font-weight: bold;\">$1</a>')\n\n    // Convert paragraphs - handle newlines\n    .replace(/\\n\\s*\\n/gim, '</p><p style=\"margin: 0.8em 0; font-size: ' + fontSizeValue + '; line-height: ' + lineHeightValue + ';\">')\n    .replace(/\\n/gim, '<br>')\n\n    // Wrap in paragraph if not already wrapped\n    .replace(/^(.+)$/gim, '<p style=\"margin: 0.8em 0; font-size: ' + fontSizeValue + '; line-height: ' + lineHeightValue + ';\">$1</p>');\n\n  return html;\n}\n\n// Translate and Summarize email\nasync function translateAndSummarizeEmail() {\n    const apiKey = getApiKey();\n\n    if (!apiKey) {\n        showNotification(\"Please add your Gemini API key in the settings\", 'error');\n        toggleSettingsDropdown(); // Open settings dropdown to prompt for API key\n        return;\n    }\n\n    // Show loading UI\n    showLoading(\"Translating and summarizing...\");\n\n    try {\n        const emailContent = await getEmailContent();\n        const subject = Office.context.mailbox.item.subject;\n        let language = \"English\";\n\n        // Get template from storage or use default\n        let template = DEFAULT_TEMPLATES.translateSummarize;\n        try {\n            const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n            if (savedSettings) {\n                const settings = JSON.parse(savedSettings);\n                if (settings.templates && settings.templates.translateSummarize) {\n                    template = settings.templates.translateSummarize;\n                }\n                if (settings.language) {\n                    language = settings.language;\n                }\n            }\n        } catch (error) {\n            console.error(\"Error getting template:\", error);\n        }\n\n        // Replace placeholders in template\n        const prompt = template\n            .replace('{subject}', subject)\n            .replace('{content}', emailContent)\n            .replace('{language}', language);\n\n        // Check for TL;DR mode\n        let tldrMode = true;\n        try {\n            const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n            if (savedSettings) {\n                const settings = JSON.parse(savedSettings);\n                if (settings.tldrMode) {\n                    tldrMode = settings.tldrMode === 'true';\n                }\n            }\n        } catch (error) {\n            console.error('Error getting TLDR mode setting:', error);\n        }\n\n        if (tldrMode) {\n            // Generate TL;DR first\n            const tldrContent = await generateTldrContent(prompt, apiKey);\n            hideLoading();\n            showResults(tldrContent, TYPES.TRANSLATE_SUMMARIZE);\n\n            // Then generate full content in the background\n            const fullContent = await generateContent(prompt, apiKey);\n\n\n            // display notification of full content\n            updateResults(fullContent);\n            updateExpandButton(true);\n        } else {\n            // Generate full content only\n            const result = await generateContent(prompt, apiKey);\n            showResults(result, TYPES.TRANSLATE_SUMMARIZE);\n        }\n    } catch (error) {\n        showNotification(`Error: ${error.message}`, 'error');\n    }\n}\n\n/**\n * Show loading indicator with message\n */\nfunction showLoading(message = \"Loading...\") {\n    // Show loading section\n    const loadingSection = document.getElementById(\"loading\");\n    loadingSection.style.display = \"block\";\n\n    // Update loading message\n    const loadingMessage = document.getElementById(\"loading-message\");\n    loadingMessage.textContent = message;\n\n    // Hide other sections\n    document.getElementById(\"landing-screen\").style.display = \"none\";\n    document.getElementById(\"result-section\").style.display = \"none\";\n}\n\n/**\n * Hide loading indicator\n */\nfunction hideLoading() {\n    const loadingSection = document.getElementById(\"loading\");\n    if (loadingSection) {\n        loadingSection.style.display = \"none\";\n    }\n}\n\n// Function to show the results\nfunction showResults(content, type) {\n\n    // Reset the full result content\n    document.getElementById(\"result-content\").innerHTML = \"\";\n    // Reset the tldr content\n    document.getElementById(\"tldr-content\").innerHTML = \"\";\n\n    // Reset the expand button\n    const expandButton = document.getElementById(\"expand-content\");\n    if (expandButton) {\n        expandButton.disabled = true;\n        expandButton.classList.add(\"ms-Button--disabled\");\n        expandButton.innerHTML = '<span class=\"ms-Button-label\">Show Full Content</span>';\n        expandButton.classList.remove('ms-Button--primary');\n    }\n\n    // Hide loading section\n    document.getElementById(\"loading\").style.display = \"none\";\n\n    // Show result section\n    document.getElementById(\"result-section\").style.display = \"block\";\n\n    // Hide landing screen\n    document.getElementById(\"landing-screen\").style.display = \"none\";\n\n    // Show the app body\n    document.getElementById(\"app-body\").style.display = \"block\";\n\n    // Check for TL;DR mode\n    let tldrMode = true;\n    try {\n        const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n        if (savedSettings) {\n            const settings = JSON.parse(savedSettings);\n            if (settings.tldrMode) {\n                tldrMode = settings.tldrMode === 'true';\n            }\n        }\n    } catch (error) {\n        console.error('Error getting TLDR mode setting:', error);\n    }\n\n    // Update content based on TL;DR mode\n    if (tldrMode) {\n        // For TL;DR mode, show the quick summary first\n        document.getElementById(\"tldr-content\").innerHTML = marked.parse(content);\n\n        // // Show loading spinner in full content section\n        // const fullContentContainer = document.getElementById(\"full-content-container\");\n        // fullContentContainer.style.display = \"block\";\n        // fullContentContainer.innerHTML = `\n        //     <div class=\"loading-container\" style=\"display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px;\">\n        //         <div class=\"spinner\"></div>\n        //         <p style=\"margin-top: 10px; color: var(--text-secondary);\">Generating full content...</p>\n        //     </div>\n        // `;\n\n        // Disable expand button and set to loading state\n        const expandButton = document.getElementById(\"expand-content\");\n        if (expandButton) {\n            expandButton.disabled = true;\n            expandButton.classList.add(\"ms-Button--disabled\");\n            expandButton.innerHTML = '<span class=\"ms-Button-label\">Loading Full Content...</span>';\n        }\n    } else {\n        // For non-TL;DR mode, show the full content\n        document.getElementById(\"tldr-content\").innerHTML = marked.parse(content);\n\n        // Ensure result-content element exists\n        let resultContent = document.getElementById(\"result-content\");\n        if (!resultContent) {\n            resultContent = document.createElement(\"div\");\n            resultContent.id = \"result-content\";\n            document.getElementById(\"full-content-container\").appendChild(resultContent);\n        }\n        resultContent.innerHTML = marked.parse(content);\n        document.getElementById(\"full-content-container\").style.display = \"block\";\n\n        // Enable expand button and set to normal state\n        const expandButton = document.getElementById(\"expand-content\");\n        if (expandButton) {\n            expandButton.disabled = false;\n            expandButton.classList.remove(\"ms-Button--disabled\");\n            expandButton.innerHTML = '<span class=\"ms-Button-label\">Show Full Content</span>';\n            expandButton.classList.add('ms-Button--primary');\n        }\n    }\n\n    // Show/hide copy reply button based on type\n    const copyReplyButton = document.getElementById(\"copy-reply\");\n    if (copyReplyButton) {\n        copyReplyButton.style.display = type === TYPES.REPLY ? \"inline-block\" : \"none\";\n    }\n\n    // Show/hide copy result button based on type\n    const copyResultButton = document.getElementById(\"copy-result\");\n    if (copyResultButton) {\n        copyResultButton.style.display = type === TYPES.REPLY ? \"none\" : \"inline-block\";\n    }\n\n    // Show/hide generate reply button based on type and settings\n    const generateReplyButton = document.getElementById(\"generate-reply\");\n    if (generateReplyButton) {\n        const showReply = localStorage.getItem('my_sidekick_michael_settings') &&\n            JSON.parse(localStorage.getItem('my_sidekick_michael_settings')).showReply === 'true';\n        generateReplyButton.style.display = type === TYPES.REPLY ? \"none\" : (showReply ? \"inline-block\" : \"none\");\n    }\n\n    // Apply font size from settings\n    try {\n        const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n        if (savedSettings) {\n            const settings = JSON.parse(savedSettings);\n            if (settings.fontSize) {\n                applyFontSize(settings.fontSize);\n            }\n            // Update reply button visibility\n            if (settings.showReply) {\n                updateReplyButtonVisibility(settings.showReply === 'true');\n            }\n        }\n    } catch (error) {\n        console.error('Error applying font size:', error);\n    }\n\n    // Scroll to top of result content if elements exist\n    const resultContent = document.getElementById(\"result-content\");\n    const tldrContent = document.getElementById(\"tldr-content\");\n    if (resultContent) {\n        resultContent.scrollTop = 0;\n    }\n    if (tldrContent) {\n        tldrContent.scrollTop = 0;\n    }\n}\n\nfunction updateResults(content) {\n  // change the button status to show full content\n  const expandButton = document.getElementById(\"expand-content\");\n  if (expandButton) {\n    expandButton.disabled = false;\n    expandButton.classList.remove(\"ms-Button--disabled\");\n    expandButton.innerHTML = '<span class=\"ms-Button-label\">Show Full Content</span>';\n  }\n\n  // Remove the loading container\n  const loadingContainer = document.getElementById(\"loading-container\");\n  if (loadingContainer) {\n    loadingContainer.remove();\n  }\n\n  // Redo the result content\n  const resultContent = document.getElementById(\"result-content\");\n  if (resultContent) {\n    resultContent.innerHTML = marked.parse(content);\n  }\n}\n\n// Function to reset the UI\nfunction resetUI() {\n    document.getElementById(\"loading\").style.display = \"none\";\n    document.getElementById(\"result-section\").style.display = \"none\";\n    document.getElementById(\"landing-screen\").style.display = \"block\";\n}\n\n/**\n * Update reply button visibility based on settings\n */\nfunction updateReplyButtonVisibility(show) {\n  const replyButton = document.getElementById('generate-reply');\n  if (replyButton) {\n    replyButton.style.display = show ? 'inline-block' : 'none';\n  }\n}\n\n/**\n * Expand the full content when the expand button is clicked\n */\nfunction expandContent() {\n    const expandButton = document.getElementById('expand-content');\n    if (expandButton.disabled) {\n        return; // Don't do anything if button is disabled\n    }\n\n    const fullContentContainer = document.getElementById('full-content-container');\n\n    if (fullContentContainer.style.display === 'none') {\n        fullContentContainer.style.display = 'block';\n        expandButton.innerHTML = '<span class=\"ms-Button-label\">Hide Full Content</span>';\n        expandButton.classList.remove('ms-Button--primary');\n    } else {\n        fullContentContainer.style.display = 'none';\n        expandButton.innerHTML = '<span class=\"ms-Button-label\">Show Full Content</span>';\n        expandButton.classList.add('ms-Button--primary');\n    }\n}\n\n// Format a reply with clear subject and body sections\nfunction formatReplyOutput(replyText) {\n  // Extract subject and body\n  let subject = \"\";\n  let body = \"\";\n\n  // Check for a SUBJECT: line first\n  const subjectMatch = replyText.match(/^(?:SUBJECT:|Subject:)\\s*(.+?)(?:\\n|$)/m);\n  if (subjectMatch) {\n    subject = subjectMatch[1].trim();\n\n    // Remove the subject line from the text to get the body\n    body = replyText.replace(/^(?:SUBJECT:|Subject:)\\s*.+?\\n+/m, '').trim();\n  } else {\n    // If no explicit subject marker, check for first line as subject\n    const lines = replyText.trim().split('\\n');\n    if (lines.length > 0) {\n      subject = lines[0].trim();\n      body = lines.slice(1).join('\\n').trim();\n    } else {\n      // Fallback if no clear structure\n      subject = \"Re: Your email\";\n      body = replyText.trim();\n    }\n  }\n\n  // Create formatted HTML\n  const formattedHtml = `\n    <div class=\"reply-container\">\n      <div class=\"reply-subject\">\n        <span class=\"reply-label\">Subject:</span>${subject}\n      </div>\n      <div class=\"reply-body\">${body}</div>\n    </div>\n  `;\n\n  return {\n    html: formattedHtml,\n    subject: subject,\n    body: body,\n    raw: `Subject: ${subject}\\n\\n${body}`\n  };\n}\n\n// Generate a reply based on the current content\nasync function generateReply() {\n  const apiKey = getApiKey();\n\n  if (!apiKey) {\n    showNotification(\"Please add your Gemini API key in the settings\", 'error');\n    toggleSettingsDropdown();\n    return;\n  }\n\n  // Show loading UI\n  showLoading(\"Generating reply...\");\n\n  try {\n    const emailContent = await getEmailContent();\n    const subject = Office.context.mailbox.item.subject;\n\n    // Get reply template from storage or use default\n    let template = DEFAULT_TEMPLATES.reply;\n    try {\n        const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n        if (savedSettings) {\n            const settings = JSON.parse(savedSettings);\n            if (settings.templates && settings.templates.reply) {\n                template = settings.templates.reply;\n            }\n        }\n    } catch (error) {\n        console.error(\"Error getting reply template:\", error);\n    }\n\n    // Get language (assuming you still want language for reply)\n    const language = getLanguage();\n\n    // Replace placeholders in template\n    const prompt = template\n        .replace('{subject}', subject)\n        .replace('{content}', emailContent)\n        .replace('{language}', getLanguageText(language)); // Ensure language name is used if placeholder exists\n\n    // Get reply model from settings\n    let replyModelOverride = null;\n    try {\n        const savedSettings = localStorage.getItem('my_sidekick_michael_settings');\n        if (savedSettings) {\n            const settings = JSON.parse(savedSettings);\n            if (settings.replyModel) {\n                replyModelOverride = settings.replyModel;\n            }\n        }\n    } catch (error) {\n        console.error(\"Error getting reply model:\", error);\n    }\n\n    const result = await generateContent(prompt, apiKey, replyModelOverride);\n    let formattedReply = formatReplyOutput(result);\n\n    // Display in TLDR and full content sections\n    document.getElementById(\"tldr-content\").innerHTML = formattedReply.html;\n    document.getElementById(\"result-content\").innerHTML = formattedReply.html;\n\n    // Show the result section\n    document.getElementById(\"result-section\").style.display = \"block\";\n\n    // Show the copy reply button and hide the regular copy button\n    document.getElementById(\"copy-reply\").style.display = \"inline-block\";\n    document.getElementById(\"copy-result\").style.display = \"none\";\n  } catch (error) {\n    showNotification(`Error: ${error.message}`, 'error');\n  } finally {\n    hideLoading();\n  }\n}\n\n// Copy the reply to clipboard\nfunction copyReply() {\n  // Get the formatted reply content\n  const tldrContent = document.getElementById(\"tldr-content\").innerText;\n\n  // Extract subject and body using regex\n  const subjectMatch = tldrContent.match(/Subject:\\s*(.+?)(?:\\n|$)/i);\n  const subject = subjectMatch ? subjectMatch[1].trim() : \"\";\n\n  // Get the body (everything after the subject)\n  const bodyStart = tldrContent.indexOf(subject) + subject.length;\n  const body = tldrContent.substring(bodyStart).trim();\n\n  // Format as email reply\n  const replyContent = `Subject: ${subject}\\n\\n${body}`;\n\n  navigator.clipboard.writeText(replyContent).then(() => {\n    const copyStatus = document.getElementById(\"copy-reply-status\");\n    copyStatus.textContent = \"Copied!\";\n    setTimeout(() => {\n      copyStatus.textContent = \"\";\n    }, 2000);\n  }).catch(err => {\n    console.error('Could not copy reply: ', err);\n    showNotification(\"Failed to copy reply\", \"error\");\n  });\n}\n\n/**\n * Extract TL;DR from content, or generate a brief summary\n */\nfunction extractTLDR(content) {\n    // Check if the content already contains a TL;DR section\n    const tldrRegex = /TL;DR:?\\s*(.*?)(?:\\n\\n|$)/is;\n    const tldrMatch = content.match(tldrRegex);\n\n    if (tldrMatch && tldrMatch[1]) {\n        return tldrMatch[1];\n    }\n\n    // Check for \"Summary:\" section\n    const summaryRegex = /Summary:?\\s*(.*?)(?:\\n\\n|$)/is;\n    const summaryMatch = content.match(summaryRegex);\n\n    if (summaryMatch && summaryMatch[1]) {\n        return summaryMatch[1];\n    }\n\n    // If no TL;DR or Summary found, use the first paragraph\n    const firstParagraph = content.split('\\n\\n')[0];\n    if (firstParagraph && firstParagraph.length < 300) {\n        return firstParagraph;\n    } else if (firstParagraph) {\n        return firstParagraph.substring(0, 250) + '...';\n    }\n\n    // Fallback\n    return content.substring(0, 200) + '...';\n}\n\n/**\n * Initialize the application\n */\nasync function initializeApp() {\n  // DOM 요소들을 먼저 찾아서 변수에 저장\n  const settingsSection = document.getElementById(\"settings-section\");\n  const resultSection = document.getElementById(\"result-section\");\n  const tldrSection = document.getElementById(\"tldr-section\");\n\n  // 요소가 존재하는지 확인 후 스타일 적용\n  if (settingsSection) {\n    settingsSection.style.display = \"none\";\n  }\n\n  if (resultSection) {\n    resultSection.style.display = \"none\";\n  }\n\n  if (tldrSection) {\n    tldrSection.style.display = \"none\";\n  }\n\n  // 설정 로드\n  const settings = loadSettings();\n  if (settings) {\n    // 테마 설정\n    if (settings.theme) {\n      setTheme(settings.theme);\n    }\n\n    // 폰트 크기 설정\n    if (settings.fontSize) {\n      setFontSize(settings.fontSize);\n    }\n  }\n\n  // API 키 확인\n  const apiKey = getApiKey();\n  if (!apiKey) {\n    showNotification(\"Please add your Gemini API key in settings\", \"warning\");\n  }\n}\n\n/**\n * Toggle settings panel visibility\n */\nfunction toggleSettings() {\n  const settingsSection = document.getElementById(\"settings-section\");\n  if (settingsSection.style.display === \"none\") {\n    settingsSection.style.display = \"block\";\n  } else {\n    settingsSection.style.display = \"none\";\n  }\n}\n\n/**\n * Save API key to settings\n */\nfunction saveApiKey() {\n  const apiKey = document.getElementById(\"api-key-input\").value;\n  localStorage.setItem(\"my_sidekick_michael_api_key\", apiKey);\n  showNotification(\"API key saved successfully!\", \"success\");\n  toggleSettings();\n}\n\n/**\n * Save settings to local storage\n */\nfunction saveSettings() {\n  const settings = {\n    theme: document.getElementById(\"theme-select\").value,\n    fontSize: document.getElementById(\"font-size-select\").value,\n    apiKey: document.getElementById(\"api-key-input\").value\n  };\n  localStorage.setItem(\"settings\", JSON.stringify(settings));\n  showNotification(\"Settings saved successfully!\", \"success\");\n  loadSettings();\n}\n\n/**\n * Load settings from local storage\n */\nfunction loadSettings() {\n  try {\n    const savedSettings = localStorage.getItem(\"michael_settings\");\n    if (savedSettings) {\n      const settings = JSON.parse(savedSettings);\n\n      // Apply to dropdown values\n      Object.keys(settings).forEach(key => {\n        const element = document.getElementById(key);\n        if (element && element.tagName === \"SELECT\") {\n          element.value = settings[key];\n        }\n      });\n    }\n  } catch (error) {\n    console.error(\"Error loading settings:\", error);\n  }\n}\n\n/**\n * Get a specific setting value\n */\nfunction getSetting(key) {\n  try {\n    const savedSettings = localStorage.getItem(\"michael_settings\");\n    if (savedSettings) {\n      const settings = JSON.parse(savedSettings);\n      return settings[key];\n    }\n  } catch (error) {\n    console.error(`Error getting setting ${key}:`, error);\n  }\n  return null;\n}\n\n/**\n * Set theme based on selection\n */\nfunction setTheme(theme) {\n  const root = document.documentElement;\n\n  if (theme === \"system\") {\n    // Use system preference\n    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {\n      root.setAttribute('data-theme', 'dark');\n    } else {\n      root.setAttribute('data-theme', 'light');\n    }\n  } else {\n    // Use explicit theme\n    root.setAttribute('data-theme', theme);\n  }\n}\n\n/**\n * Set font size for results\n */\nfunction setFontSize(size) {\n  const root = document.documentElement;\n  root.style.setProperty('--result-font-size', getFontSizeValue(size));\n}\n\n/**\n * Get font size value based on size name\n */\nfunction getFontSizeValue(size) {\n  switch (size) {\n    case \"small\": return \"0.875rem\";\n    case \"medium\": return \"1rem\";\n    case \"large\": return \"1.125rem\";\n    default: return \"1rem\";\n  }\n}\n\n/**\n * Reset all settings to defaults\n */\nfunction resetAllSettings() {\n    // Reset model selection\n    document.getElementById('dropdown-model').value = 'gemini-1.5-flash';\n\n    // Reset language selection\n    document.getElementById('dropdown-language').value = 'ko';\n\n    // Reset event title language selection\n    document.getElementById('dropdown-event-title-language').value = 'en';\n\n    // Reset theme selection\n    document.getElementById('dropdown-theme').value = 'system';\n\n    // Reset font size selection\n    document.getElementById('dropdown-font-size').value = 'medium';\n\n    // Reset TLDR mode selection\n    document.getElementById('dropdown-tldr-mode').value = 'true';\n\n    // Reset show reply selection\n    document.getElementById('dropdown-show-reply').value = 'true';\n\n    // Reset reply model selection\n    document.getElementById('dropdown-reply-model').value = 'gemini-2.0-flash-lite';\n\n    // Reset autorun settings\n    document.getElementById('dropdown-autorun').value = 'false';\n    document.getElementById('dropdown-autorun-option').value = 'summarize';\n\n    // Reset dev mode settings\n    document.getElementById('dropdown-dev-mode').value = 'false';\n    document.getElementById('dropdown-dev-server').value = '';\n    document.getElementById('dev-server-group').style.display = 'none';\n\n    // Reset templates\n    resetTemplates();\n\n    // Clear API key\n    document.getElementById('dropdown-api-key').value = '';\n\n    // Clear saved settings from localStorage\n    localStorage.removeItem('michael_api_key');\n    localStorage.removeItem('michael_settings'); // Clear all settings as well\n\n    // Apply default theme\n    applyCurrentTheme();\n\n    // Apply default font size\n    applyFontSize('medium');\n\n    // Update reply button visibility\n    updateReplyButtonVisibility(true);\n\n    // Update dev badges visibility\n    updateDevBadges(false);\n\n    showNotification('All settings reset to defaults', 'success');\n}\n\n/**\n * Update dev badges visibility\n */\nfunction updateDevBadges(show) {\n    const devBadge = document.getElementById('dev-badge');\n    const footerDevBadge = document.getElementById('footer-dev-badge');\n\n    if (devBadge) {\n        devBadge.style.display = show ? 'block' : 'none';\n    }\n    if (footerDevBadge) {\n        footerDevBadge.style.display = show ? 'block' : 'none';\n    }\n}\n\n// Get event title language from settings\nfunction getEventTitleLanguage() {\n  try {\n    const savedSettings = localStorage.getItem('michael_settings');\n    if (savedSettings) {\n      const settings = JSON.parse(savedSettings);\n      if (settings.eventTitleLanguage) {\n        return settings.eventTitleLanguage;\n      }\n    }\n    return 'en'; // Default to English\n  } catch (error) {\n    console.error('Error getting event title language:', error);\n    return 'en';\n  }\n}\n\n// Helper function to parse event details using Gemini API\nasync function parseEventDetailsWithGemini(emailContent) {\n  try {\n    const apiKey = getApiKey();\n    if (!apiKey) {\n      throw new Error('API key not found');\n    }\n\n    // Get event title language from settings\n    const titleLanguage = getEventTitleLanguage();\n    let langInstructions = \"\";\n\n    // Set language-specific instructions\n    if (titleLanguage === 'en') {\n      langInstructions = `Event title should be in English.\n      If the event has a type or category, include it in square brackets ([]) at the beginning, then if there's a presenter and topic, write the presenter's name first, followed by a hyphen (-) and then the topic.`;\n    } else if (titleLanguage === 'ko') {\n      langInstructions = `이벤트 제목은 한국어로 작성해주세요.\n      이벤트 유형이나 카테고리가 있다면 대괄호([])로 먼저 표시하고, 발표자와 주제가 있다면 발표자 이름을 먼저 쓰고 하이픈(-) 후에 주제를 적어주세요.`;\n    } else if (titleLanguage === 'ja') {\n      langInstructions = `イベントのタイトルは日本語で記載してください。\n      イベントのタイプやカテゴリがある場合は、角括弧（[]）で囲んで最初に表示し、発表者とトピックがある場合は、発表者の名前を最初に書き、ハイフン（-）の後にトピックを書いてください。`;\n    } else if (titleLanguage === 'zh_cn') {\n      langInstructions = `事件标题应该用中文书写。\n      如果事件有类型或类别，请使用方括号（[]）将其括起来并放在开头，如果有演讲者和主题，请先写演讲者的名字，然后是连字符（-），再写主题。`;\n    } else {\n      // Default English instructions for other languages\n      langInstructions = `Event title should be in ${getLanguageText(titleLanguage)}.\n      If the event has a type or category, include it in square brackets ([]) at the beginning, then if there's a presenter and topic, write the presenter's name first, followed by a hyphen (-) and then the topic.`;\n    }\n\n    const prompt = `Analyze the following email content and extract information needed to create a calendar event for Microsoft Graph API.\n    The response must be in valid JSON format and follow the format below exactly.\n    Do not use escape characters that would cause parsing issues.\n    Mark any information that cannot be found as null.\n\n    ${langInstructions}\n\n    Event title format examples:\n    - \"[Event Type] Presenter - Topic\"\n    - \"[Conference Name] Presenter Name - Presentation Topic\"\n    - \"[Seminar Type] Speaker Name - Presentation Title\"\n\n    Required JSON format:\n    {\n      \"subject\": \"Meeting title\",\n      \"body\": {\n        \"contentType\": \"HTML\",\n        \"content\": \"Meeting description\"\n      },\n      \"start\": {\n        \"dateTime\": \"YYYY-MM-DDTHH:mm:ss\",\n        \"timeZone\": \"Asia/Seoul\"\n      },\n      \"end\": {\n        \"dateTime\": \"YYYY-MM-DDTHH:mm:ss\",\n        \"timeZone\": \"Asia/Seoul\"\n      },\n      \"location\": {\n        \"displayName\": \"Location name\"\n      },\n      \"attendees\": [\n        {\n          \"emailAddress\": {\n            \"address\": \"attendee@email.com\",\n            \"name\": \"Attendee Name\"\n          },\n          \"type\": \"required\"\n        }\n      ],\n      \"isOnlineMeeting\": true,\n      \"onlineMeetingProvider\": \"teamsForBusiness\"\n    }\n\n    Important notes:\n    1. Convert dates and times to ISO 8601 format (YYYY-MM-DDTHH:mm:ss)\n    2. Email addresses must be in valid format\n    3. Use \"Asia/Seoul\" as the default timezone\n    4. Set isOnlineMeeting to true if there are Teams links or video conference details\n    5. Process special characters properly to ensure valid JSON\n    6. Return only JSON without any additional explanations or comments\n\n    Email content:\n    ${emailContent}`;\n\n    console.log('Sending prompt to Gemini API');\n    const result = await generateContent(prompt, apiKey, null, false);\n    console.log('Received response from Gemini API');\n\n    // Extract only the JSON part from the result (remove any explanations or comments)\n    let jsonText = result;\n\n    // Extract text that starts with { and ends with } (JSON only)\n    const jsonMatch = result.match(/\\{[\\s\\S]*\\}/);\n    if (jsonMatch) {\n      jsonText = jsonMatch[0];\n    }\n\n    console.log('Extracted JSON text:', jsonText);\n\n    // Try to parse JSON\n    try {\n      const eventDetails = JSON.parse(jsonText);\n      console.log('Successfully parsed event details:', eventDetails);\n\n      // Validate required fields\n      if (!eventDetails.subject) {\n        throw new Error('Event title not found.');\n      }\n\n      if (!eventDetails.start?.dateTime) {\n        throw new Error('Event start time not found.');\n      }\n\n      if (!eventDetails.end?.dateTime) {\n        throw new Error('Event end time not found.');\n      }\n\n      // Validate date format\n      const dateRegex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}$/;\n      if (!dateRegex.test(eventDetails.start.dateTime)) {\n        throw new Error('Invalid start time format. (Should be YYYY-MM-DDTHH:mm:ss format)');\n      }\n\n      if (!dateRegex.test(eventDetails.end.dateTime)) {\n        throw new Error('Invalid end time format. (Should be YYYY-MM-DDTHH:mm:ss format)');\n      }\n\n      return eventDetails;\n    } catch (parseError) {\n      console.error('JSON parsing error:', parseError);\n      console.error('Original response:', result);\n      throw new Error('Failed to extract event information: ' + parseError.message);\n    }\n  } catch (error) {\n    console.error('Error extracting event information:', error);\n    throw error;\n  }\n}\n\n// Create calendar event using Outlook Add-in API\nasync function createCalendarEvent(eventDetails) {\n  try {\n    // Validate required fields\n    if (!eventDetails.subject || !eventDetails.start?.dateTime || !eventDetails.end?.dateTime) {\n      throw new Error('Required event information is missing.');\n    }\n\n    // Convert to Outlook Add-in API format\n    // Create Date objects from ISO 8601 strings\n    const startDate = new Date(eventDetails.start.dateTime);\n    const endDate = new Date(eventDetails.end.dateTime);\n\n    // Convert attendee list to string arrays\n    const requiredAttendees = [];\n    const optionalAttendees = [];\n\n    if (eventDetails.attendees && eventDetails.attendees.length > 0) {\n      eventDetails.attendees.forEach(attendee => {\n        if (attendee.emailAddress && attendee.emailAddress.address) {\n          if (attendee.type === 'optional') {\n            optionalAttendees.push(attendee.emailAddress.address);\n          } else {\n            requiredAttendees.push(attendee.emailAddress.address);\n          }\n        }\n      });\n    }\n\n    // Create appointment format - according to Outlook API\n    const appointmentData = {\n      requiredAttendees: requiredAttendees,\n      optionalAttendees: optionalAttendees,\n      start: startDate,\n      end: endDate,\n      location: eventDetails.location?.displayName || '',\n      body: eventDetails.body?.content || '',\n      subject: eventDetails.subject\n    };\n\n    console.log('Creating appointment with data:', JSON.stringify(appointmentData));\n\n    // Display appointment form - using new appointment creation method\n    Office.context.mailbox.displayNewAppointmentForm({\n      requiredAttendees: requiredAttendees,\n      optionalAttendees: optionalAttendees,\n      start: startDate,\n      end: endDate,\n      location: eventDetails.location?.displayName || '',\n      body: eventDetails.body?.content || '',\n      subject: eventDetails.subject\n    });\n\n    showNotification(`Event '${eventDetails.subject}' has been created.`, 'info');\n    return true;\n  } catch (error) {\n    showNotification(`Failed to create event: ${error.message}`, 'error');\n    console.error('Error creating calendar event:', error);\n    throw error;\n  }\n}\n\n// Check if email content is a calendar event\nasync function checkIfCalendarEvent(emailContent) {\n  try {\n    const apiKey = getApiKey();\n    if (!apiKey) {\n      console.error('API key not found');\n      return false;\n    }\n\n    const prompt = `Check if the following email content is a calendar event (meeting, appointment, schedule, etc.).\n    Return true if the email content includes one or more of the following:\n    - Date and time information\n    - Meeting-related keywords (meeting, conference, appointment, schedule, calendar, etc.)\n    - Attendee information\n    - Location information\n    - Schedule-related actions (attendance confirmation, add to calendar, etc.)\n\n    Email content:\n    ${emailContent}\n\n    Your response must only contain \"true\" or \"false\".`;\n\n    const result = await generateContent(prompt, apiKey, null, true);\n    return result.toLowerCase().trim() === 'true';\n  } catch (error) {\n    console.error('Error checking if calendar event:', error);\n    return false;\n  }\n}\n\n// Handle calendar event button click\nasync function handleCalendarEvent() {\n  const apiKey = getApiKey();\n\n  if (!apiKey) {\n    showNotification(\"Please add your API key in settings\", 'error');\n    toggleSettingsDropdown();\n    return;\n  }\n\n  showLoading(\"Creating calendar event...\");\n\n  try {\n    const emailContent = await getEmailContent();\n\n    // Display result section\n    document.getElementById(\"landing-screen\").style.display = \"none\";\n    document.getElementById(\"result-section\").style.display = \"block\";\n\n    // Display email content and prepare copy button\n    document.getElementById(\"tldr-content\").innerHTML = `\n      <div class=\"email-content-header\">\n        <h3>Email Content</h3>\n        <button id=\"copy-email-content\" class=\"ms-Button ms-Button--primary\">\n          <span class=\"ms-Button-label\">Copy to Clipboard</span>\n        </button>\n      </div>\n      <div class=\"email-content-body\">\n        <pre style=\"white-space: pre-wrap; word-break: break-word;\">${emailContent}</pre>\n      </div>\n    `;\n\n    // Add event listener to clipboard copy button\n    document.getElementById(\"copy-email-content\").addEventListener(\"click\", function() {\n      navigator.clipboard.writeText(emailContent)\n        .then(() => {\n          showNotification(\"Email content copied to clipboard\", 'info');\n        })\n        .catch(err => {\n          console.error('Error copying to clipboard:', err);\n          showNotification(\"Failed to copy to clipboard\", 'error');\n        });\n    });\n\n    try {\n      // Parse event details with Gemini API\n      const eventDetails = await parseEventDetailsWithGemini(emailContent);\n\n      // Display extracted event details\n      document.getElementById(\"result-content\").innerHTML = `\n        <div class=\"event-details-header\">\n          <h3>Extracted Event Details</h3>\n        </div>\n        <div class=\"event-details-body\">\n          <p><strong>Subject:</strong> ${eventDetails.subject || 'Not found'}</p>\n          <p><strong>Start:</strong> ${eventDetails.start?.dateTime || 'Not found'}</p>\n          <p><strong>End:</strong> ${eventDetails.end?.dateTime || 'Not found'}</p>\n          <p><strong>Location:</strong> ${eventDetails.location?.displayName || 'Not found'}</p>\n        </div>\n      `;\n\n      // Create calendar event\n      await createCalendarEvent(eventDetails);\n\n    } catch (extractionError) {\n      console.error('Event extraction error:', extractionError);\n      // Clean up error message by removing the prefix if present\n      const errorMessage = extractionError.message;\n      const cleanedMessage = errorMessage.includes('Failed to extract event information:')\n        ? errorMessage.split('Failed to extract event information:')[1].trim()\n        : errorMessage;\n\n      document.getElementById(\"result-content\").innerHTML = `\n        <div class=\"event-details-header\">\n          <h3>Event Extraction Failed</h3>\n        </div>\n        <div class=\"event-details-body\">\n          <p class=\"error-message\">${cleanedMessage}</p>\n        </div>\n      `;\n\n      showNotification(`Event extraction failed: ${cleanedMessage}`, 'error');\n    }\n  } catch (error) {\n    console.error('Calendar event handling error:', error);\n    showNotification(`Error: ${error.message}`, 'error');\n  } finally {\n    // Hide loading and update button state\n    hideLoading();\n    updateCalendarButtonState();\n\n    // Enable show full content button\n    const expandButton = document.getElementById(\"expand-content\");\n    if (expandButton) {\n      expandButton.disabled = false;\n      expandButton.classList.remove(\"ms-Button--disabled\");\n      expandButton.innerHTML = '<span class=\"ms-Button-label\">Show Full Content</span>';\n      expandButton.classList.add('ms-Button--primary');\n\n      // Show full content container\n      document.getElementById(\"full-content-container\").style.display = \"block\";\n    }\n  }\n}\n\n// Update calendar button state based on email content\nasync function updateCalendarButtonState() {\n  try {\n    const emailContent = await getEmailContent();\n    const isCalendarEvent = await checkIfCalendarEvent(emailContent);\n\n    const calendarBtn = document.getElementById('calendar-event');\n    if (calendarBtn) {\n      if (isCalendarEvent) {\n        calendarBtn.disabled = false;\n        calendarBtn.classList.remove('action-button--disabled');\n        calendarBtn.classList.add('action-button--primary');\n        console.log('Calendar event detected, button enabled');\n      } else {\n        calendarBtn.disabled = true;\n        calendarBtn.classList.add('action-button--disabled');\n        calendarBtn.classList.remove('action-button--primary');\n        console.log('Not a calendar event, button disabled');\n      }\n    }\n  } catch (error) {\n    console.error('Error updating calendar button state:', error);\n  }\n}\n\n/**\n * Export current templates as markdown file\n */\nfunction exportTemplatesAsMarkdown() {\n    try {\n        // Get current settings\n        const savedSettings = localStorage.getItem('michael_settings');\n        const settings = savedSettings ? JSON.parse(savedSettings) : {};\n        const apiKey = localStorage.getItem('michael_api_key') || 'Not Set'; // Get API key\n\n        // Get current date for filename\n        const now = new Date();\n        const dateStr = now.toISOString().slice(0, 10); // YYYY-MM-DD format\n\n        // Get current user information if available\n        let userInfo = '';\n        try {\n            if (Office.context.mailbox && Office.context.mailbox.userProfile) {\n                const user = Office.context.mailbox.userProfile;\n                userInfo = `\\n\\n*Exported by: ${user.displayName} (${user.emailAddress})*`;\n            }\n        } catch (err) {\n            console.log('User profile not available');\n        }\n\n        // Create markdown content\n        let markdownContent = `# Michael Prompt Templates\\n\\n`;\n        markdownContent += `*Exported on: ${now.toLocaleString()}*${userInfo}\\n\\n`;\n\n        // Add model information\n        markdownContent += `## General Settings\\n\\n`;\n        markdownContent += `- **Model**: ${settings.model || 'gemini-1.5-flash'}\\n`;\n        markdownContent += `- **Reply Model**: ${settings.replyModel || 'gemini-2.0-flash-lite'}\\n`; // Add reply model\n        markdownContent += `- **Default Language**: ${settings.defaultLanguage || 'ko'}\\n`;\n        markdownContent += `- **Event Title Language**: ${settings.eventTitleLanguage || 'en'}\\n\\n`;\n\n        // Add prompts\n        markdownContent += `## Prompt Templates\\n\\n`;\n\n        // Summarize template\n        markdownContent += `### Summarize Template\\n\\n\\`\\`\\`\\n${\n            settings.templates && settings.templates.summarize ?\n            settings.templates.summarize :\n            DEFAULT_TEMPLATES.summarize\n        }\\n\\`\\`\\`\\n\\n`;\n\n        // Translate template\n        markdownContent += `### Translate Template\\n\\n\\`\\`\\`\\n${\n            settings.templates && settings.templates.translate ?\n            settings.templates.translate :\n            DEFAULT_TEMPLATES.translate\n        }\\n\\`\\`\\`\\n\\n`;\n\n        // Translate & Summarize template\n        markdownContent += `### Translate & Summarize Template\\n\\n\\`\\`\\`\\n${\n            settings.templates && settings.templates.translateSummarize ?\n            settings.templates.translateSummarize :\n            DEFAULT_TEMPLATES.translateSummarize\n        }\\n\\`\\`\\`\\n\\n`;\n\n        // Reply template\n        markdownContent += `### Reply Template\\n\\n\\`\\`\\`\\n${\n            settings.templates && settings.templates.reply ?\n            settings.templates.reply :\n            DEFAULT_TEMPLATES.reply\n        }\\n\\`\\`\\`\\n\\n`;\n\n        // Create download link\n        const blob = new Blob([markdownContent], { type: 'text/markdown' });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `michael-templates-${dateStr}.md`;\n\n        // Append to body, click, and remove\n        document.body.appendChild(a);\n        a.click();\n\n        // Clean up\n        setTimeout(function() {\n            document.body.removeChild(a);\n            URL.revokeObjectURL(url);\n        }, 100);\n\n        showNotification('Templates exported successfully', 'success');\n    } catch (error) {\n        console.error('Error exporting templates:', error);\n        showNotification('Failed to export templates', 'error');\n    }\n}\n"],"names":["__webpack_require__","g","globalThis","this","Function","e","window","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","_defaults","async","breaks","extensions","gfm","hooks","pedantic","renderer","silent","tokenizer","walkTokens","changeDefaults","newDefaults","noopTest","exec","edit","regex","opt","source","obj","name","val","valSource","other","caret","getRegex","RegExp","codeRemoveIndent","outputLinkReplace","indentCodeCompensation","beginningSpace","endingHash","startingSpaceChar","endingSpaceChar","nonSpaceChar","newLineCharGlobal","tabCharGlobal","multipleSpaceGlobal","blankLine","doubleBlankLine","blockquoteStart","blockquoteSetextReplace","blockquoteSetextReplace2","listReplaceTabs","listReplaceNesting","listIsTask","listReplaceTask","anyLine","hrefBrackets","tableDelimiter","tableAlignChars","tableRowBlankLine","tableAlignRight","tableAlignCenter","tableAlignLeft","startATag","endATag","startPreScriptTag","endPreScriptTag","startAngleBracket","endAngleBracket","pedanticHrefTitle","unicodeAlphaNumeric","escapeTest","escapeReplace","escapeTestNoEncode","escapeReplaceNoEncode","unescapeTest","percentDecode","findPipe","splitPipe","slashPipe","carriageReturn","spaceLine","notSpaceStart","endingNewline","listItemRegex","bull","nextBulletRegex","indent","Math","min","hrRegex","fencesBeginRegex","headingBeginRegex","htmlBeginRegex","hr","bullet","lheadingCore","lheading","lheadingGfm","_paragraph","_blockLabel","def","list","_tag","_comment","html","paragraph","blockNormal","blockquote","code","fences","heading","newline","table","text","gfmTable","blockGfm","blockPedantic","br","_punctuation","_punctuationOrSpace","_notPunctuationOrSpace","punctuation","_punctuationGfmStrongEm","emStrongLDelimCore","emStrongLDelim","emStrongLDelimGfm","emStrongRDelimAstCore","emStrongRDelimAst","emStrongRDelimAstGfm","emStrongRDelimUnd","anyPunctuation","autolink","_inlineComment","tag","_inlineLabel","reflink","nolink","inlineNormal","_backpedal","blockSkip","del","escape","link","reflinkSearch","url","inlinePedantic","inlineGfm","inlineBreaks","block","normal","inline","escapeReplacements","getEscapeReplacement","ch","encode","cleanUrl","href","encodeURI","splitCells","tableRow","count","cells","match","offset","str","escaped","curr","split","trim","shift","at","pop","splice","push","rtrim","c","invert","l","suffLen","charAt","slice","outputLink","cap","raw","lexer","rules","title","state","inLink","token","type","tokens","inlineTokens","_Tokenizer","options","constructor","space","codeBlockStyle","matchIndentToCode","indentToCode","map","node","matchIndentInNode","indentInNode","join","lang","trimmed","depth","lines","inBlockquote","currentLines","currentRaw","currentText","top","blockTokens","lastToken","oldToken","newText","newToken","substring","isordered","ordered","start","loose","items","itemRegex","endsWithBlankLine","endEarly","itemContents","line","t","repeat","nextLine","trimStart","search","rawLine","nextLineWithoutTabs","ischecked","istask","task","checked","lastItem","trimEnd","spacers","filter","hasMultipleLineBreaks","some","pre","toLowerCase","headers","aligns","rows","item","header","align","row","cell","inRawBlock","trimmedUrl","rtrimSlash","lastParenIndex","b","indexOf","level","findClosingBracket","linkLen","links","emStrong","maskedSrc","prevChar","lLength","rDelim","rLength","delimTotal","midDelimTotal","endReg","lastIndex","lastCharLength","index","codespan","hasNonSpaceChars","hasSpaceCharsOnBothEnds","prevCapZero","inlineText","_Lexer","inlineQueue","Object","create","lex","lexInline","next","lastParagraphClipped","extTokenizer","call","undefined","cutSrc","startBlock","startIndex","Infinity","tempSrc","tempStart","forEach","getStartIndex","errMsg","charCodeAt","console","error","keys","includes","lastIndexOf","keepPrevChar","startInline","_Renderer","parser","langString","parse","parseInline","body","j","listitem","itemBody","checkbox","unshift","tablecell","tablerow","k","content","strong","em","cleanHref","out","image","_TextRenderer","_Parser","textRenderer","anyToken","renderers","genericToken","ret","textToken","_Hooks","static","Set","preprocess","markdown","postprocess","processAllTokens","provideLexer","provideParser","markedInstance","defaults","setOptions","parseMarkdown","Parser","Renderer","TextRenderer","Lexer","Tokenizer","Hooks","args","use","callback","values","concat","tableToken","listToken","childTokens","flat","pack","opts","ext","prevRenderer","apply","extLevel","prop","rendererProp","rendererFunc","tokenizerProp","tokenizerFunc","prevTokenizer","hooksProp","hooksFunc","prevHook","passThroughHooks","has","arg","Promise","resolve","then","packWalktokens","blockType","origOpt","throwError","onError","prototype","toString","all","catch","message","msg","reject","marked","getDefaults","_regeneratorRuntime","r","n","hasOwnProperty","o","defineProperty","value","Symbol","a","iterator","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","Context","makeInvokeMethod","tryCatch","h","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","d","getPrototypeOf","v","defineIteratorMethods","_invoke","AsyncIterator","invoke","_typeof","__await","callInvokeWithMethodAndArg","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","mark","setPrototypeOf","__proto__","awrap","reverse","prev","stop","rval","handle","complete","finish","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","_next","_throw","safetySettings","category","threshold","DEFAULT_TEMPLATES","summarize","translate","translateSummarize","reply","tldrPrompt","toggleSettingsDropdown","dropdown","getElementById","isVisible","style","display","applyCurrentTheme","savedTheme","localStorage","getItem","setAttribute","classList","remove","add","Office","context","officeTheme","bodyBackgroundColor","color","parseInt","substr","isDarkTheme","sideloadLogo","landingLogo","brandLogo","meetMichaelSrc","contains","meetMichaelWhiteLogo","meetMichaelBlackLogo","michaelSrc","michaelWhiteLogo","michaelBlackLogo","onSettingsChanged","eventArgs","showNotification","existingNotification","notification","createElement","id","className","textContent","appendChild","offsetHeight","animation","setTimeout","saveDropdownSettings","settings","savedSettings","JSON","apiKey","model","language","eventTitleLanguage","theme","fontSize","tldrMode","showReply","replyTemplate","autorun","autorunOption","devMode","devServer","summarizeTemplate","translateTemplate","translateSummarizeTemplate","defaultLanguage","replyModel","templates","setItem","stringify","removeItem","applyFontSize","updateReplyButtonVisibility","updateDevBadges","resetTemplates","currentSettingsText","currentSettings","size","documentElement","getEmailContent","_getEmailContent","_callee","_context","mailbox","getAsync","result","status","AsyncResultStatus","Succeeded","generateContent","_x","_x2","_generateContent","_callee2","prompt","modelOverride","isTldr","apiUrl","response","data","_data$error","generatedText","_args2","_context2","fetch","contents","parts","generationConfig","temperature","topK","topP","maxOutputTokens","json","ok","candidates","t0","generateTldrContent","_x3","_x4","_generateTldrContent","_callee3","subject","emailContent","_args3","_context3","getLanguageText","languageCode","getApiKey","getLanguage","summarizeEmail","_summarizeEmail","_callee4","template","_savedSettings4","_settings4","tldrContent","_context4","showLoading","hideLoading","showResults","updateResults","updateExpandButton","translateEmail","_translateEmail","_callee5","_savedSettings5","_settings5","_context5","isFullContentVisible","expandButton","disabled","toggle","innerHTML","copyResult","resultContent","innerText","fullContent","headingMatch","navigator","clipboard","writeText","copyStatus","err","translateAndSummarizeEmail","_translateAndSummarizeEmail","_callee6","_savedSettings6","_settings6","_context6","loadingSection","copyReplyButton","copyResultButton","generateReplyButton","scrollTop","loadingContainer","show","replyButton","expandContent","fullContentContainer","formatReplyOutput","replyText","subjectMatch","generateReply","_generateReply","_callee7","replyModelOverride","_savedSettings7","_settings7","formattedReply","_context7","_initializeApp","_callee8","settingsSection","resultSection","tldrSection","_context8","loadSettings","root","matchMedia","matches","setProperty","getFontSizeValue","key","element","resetAllSettings","devBadge","footerDevBadge","getEventTitleLanguage","parseEventDetailsWithGemini","_x5","_parseEventDetailsWithGemini","_callee9","titleLanguage","langInstructions","jsonText","jsonMatch","_eventDetails$start","_eventDetails$end","eventDetails","dateRegex","_context9","log","dateTime","end","t1","createCalendarEvent","_x6","_createCalendarEvent","_callee10","_eventDetails$start2","_eventDetails$end2","_eventDetails$locatio","_eventDetails$body","_eventDetails$locatio2","_eventDetails$body2","startDate","endDate","requiredAttendees","optionalAttendees","appointmentData","_context10","Date","attendees","attendee","emailAddress","address","displayNewAppointmentForm","checkIfCalendarEvent","_x7","_checkIfCalendarEvent","_callee11","_context11","handleCalendarEvent","_handleCalendarEvent","_callee12","_eventDetails$start3","_eventDetails$end3","_eventDetails$locatio3","errorMessage","cleanedMessage","_context12","addEventListener","updateCalendarButtonState","_updateCalendarButtonState","_callee13","isCalendarEvent","calendarBtn","_context13","exportTemplatesAsMarkdown","now","dateStr","toISOString","userInfo","userProfile","user","markdownContent","toLocaleString","blob","Blob","URL","createObjectURL","download","click","removeChild","revokeObjectURL","onReady","info","host","HostType","Outlook","initializeApp","autorunEnabled","selectedOption","event","querySelectorAll","select","devServerGroup","loadDropdownSettings","addHandlerAsync","EventType","SettingsChanged","ItemChanged","register"],"sourceRoot":""}